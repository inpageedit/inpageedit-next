import{U as P,A as a,q as F,l as S}from"./mockInPageEdit.dGXzNdjP.js";import{M as j}from"./index-Bh70Udzi.Dbb3Yksk.js";import{h as u}from"./CheckBox-D3rHnX7I.1sNjju7J.js";import{b as E}from"./InputBox-BV4m05Xs.CAsaNFkw.js";import"./framework.DeVdP8gD.js";var T=Object.create,v=Object.defineProperty,O=Object.getOwnPropertyDescriptor,k=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),w=t=>{throw TypeError(t)},z=(t,e,o)=>e in t?v(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,C=(t,e)=>v(t,"name",{value:e,configurable:!0}),D=t=>[,,,T(t?.[k("metadata")]??null)],Q=["class","method","getter","setter","accessor","field","value","get","set"],M=t=>t!==void 0&&typeof t!="function"?w("Function expected"):t,B=(t,e,o,i,r)=>({kind:Q[t],name:e,metadata:i,addInitializer:n=>o._?w("Already initialized"):r.push(M(n||null))}),N=(t,e)=>z(e,k("metadata"),t[3]),I=(t,e,o,i)=>{for(var r=0,n=t[e>>1],l=n&&n.length;r<l;r++)n[r].call(o);return i},_=(t,e,o,i,r,n)=>{var l,s,p,c=e&7,f=!1,b=0,q=t[b]||(t[b]=[]),d=c&&(r=r.prototype,c<5&&(c>3||!f)&&O(r,o));C(r,o);for(var m=i.length-1;m>=0;m--)p=B(c,o,s={},t[3],q),l=(0,i[m])(r,p),s._=1,M(l)&&(r=l);return N(t,r),d&&v(r,o,d),f?c^4?n:d:r},x,g,y;x=[S(["modal","wiki"])];class h extends(y=P){constructor(e){super(e,{},"quick-move"),this.ctx=e,e.set("quickMove",this.quickMove.bind(this)),e.set("movePage",this.movePage.bind(this))}start(){this.ctx.inject(["toolbox"],e=>{this.injectToolbox(e)})}injectToolbox(e){const o=window.mw?.config.get("wgPageName")||"",i=window.mw?.config.get("wgIsProbablyEditable");e.toolbox.addButton({id:"quick-move",icon:a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"icon icon-tabler icons-tabler-outline icon-tabler-forms",children:[a("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),a("path",{d:"M12 3a3 3 0 0 0 -3 3v12a3 3 0 0 0 3 3"}),a("path",{d:"M6 3a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3"}),a("path",{d:"M13 7h7a1 1 0 0 1 1 1v8a1 1 0 0 1 -1 1h-7"}),a("path",{d:"M5 7h-1a1 1 0 0 0 -1 1v8a1 1 0 0 0 1 1h1"}),a("path",{d:"M17 12h.01"}),a("path",{d:"M13 12h.01"})]}),tooltip:"Quick Move",group:"group1",index:1,onClick:()=>{this.quickMove(i?{lockFromField:!0,from:o}:{})}})}quickMove(e){const o=this.ctx.modal.createObject({title:"Quick Move",content:a(F,{}),className:"quick-move compact-buttons",sizeClass:"smallToMedium",center:!0}).init();let i=null;return o.setContent(a("form",{ref:r=>i=r,style:{display:"flex",flexDirection:"column",gap:"1rem"},onSubmit:r=>{if(r.preventDefault(),i?.checkValidity(),!i?.reportValidity())return;const n=new FormData(i),l={from:n.get("from")?.toString().trim(),to:n.get("to")?.toString().trim(),reason:n.get("reason")||"",movetalk:n.get("movetalk")==="on",movesubpages:n.get("movesubpages")==="on",noredirect:n.get("noredirect")==="on"};if(!l.from||!l.to){this.ctx.modal.notify("error",{title:"Failed to move",content:"From and to are required."});return}o.setLoadingState(!0),this.movePage(l).then(()=>{location.reload()}).catch(s=>{o.setLoadingState(!1),this.ctx.modal.notify("error",{title:"Failed to move",content:s instanceof Error?s.message:String(s)})})},children:[a(j,{inputs:[{label:"Move from",name:"from",value:e?.from,required:!0},{label:"Move to",name:"to",value:e?.to,required:!0}]}),a("div",{children:a(u,{name:"movetalk",id:"movetalk",checked:e?.movetalk,children:"Move talk page"})}),a("div",{children:a(u,{name:"movesubpages",id:"movesubpages",checked:e?.movesubpages,children:"Move subpage(s) (up to 100)"})}),this.ctx.wiki.hasRight("suppressredirect")&&a("div",{children:a(u,{name:"noredirect",id:"noredirect",checked:e?.noredirect,children:"Move without leaving a redirect"})}),a(E,{label:"Reason",id:"reason",name:"reason",value:e?.reason})]})),o.setButtons([{label:"Move",className:"is-primary is-ghost",method:()=>{i?.dispatchEvent(new Event("submit"))}}]),o.show()}async movePage(e){const{from:o,to:i,reason:r="",...n}=e;if(!o||!i)throw new Error("From and to titles are required.");if(o===i)throw new Error("From and to titles cannot be the same.");return(await this.ctx.wikiPage.newFromTitle(o)).moveTo(i,r,n)}}g=D(y);h=_(g,0,"PluginQuickMove",x,h);I(g,1,h);export{h as PluginQuickMove};
