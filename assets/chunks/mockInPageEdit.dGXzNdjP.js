const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunks/index-2mNdeL-V.CZDMalPt.js","assets/chunks/Preferences-DS4-CFWe.DlUhv_7c.js","assets/chunks/IconQuickEdit-CAL1HXIb.BDcsjDQ3.js","assets/chunks/framework.DeVdP8gD.js","assets/chunks/index-DqJUIV2e.DCscgUMz.js","assets/chunks/index-ByJfEsN8.DoN5JK2h.js","assets/chunks/makeCallable-LDU0xZMJ.BgixzwPG.js","assets/chunks/index-lZkYoUca.CM9QqBzU.js","assets/chunks/InputBox-BV4m05Xs.CAsaNFkw.js","assets/chunks/CheckBox-D3rHnX7I.1sNjju7J.js","assets/chunks/noop-ClDc6zv4.BarqedVQ.js","assets/chunks/index-ByzgI28q.BSGWYbOs.js","assets/chunks/index-CAiGct8U.C6RwRzpC.js","assets/chunks/index-Bh70Udzi.Dbb3Yksk.js","assets/chunks/index-BnAhw94L.DqWQjsd7.js","assets/chunks/index-eOIVMf9E.CuB-Fn_B.js","assets/chunks/index-Cx-YiN1j.BDhhNH6R.js","assets/chunks/index-BR6gK_ki.BPYyoMk-.js"])))=>i.map(i=>d[i]);
var Yi=Object.defineProperty;var bs=s=>{throw TypeError(s)};var Qi=(s,e,t)=>e in s?Yi(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var U=(s,e,t)=>Qi(s,typeof e!="symbol"?e+"":e,t),At=(s,e,t)=>e.has(s)||bs("Cannot "+t);var P=(s,e,t)=>(At(s,e,"read from private field"),t?t.call(s):e.get(s)),Ue=(s,e,t)=>e.has(s)?bs("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),q=(s,e,t,i)=>(At(s,e,"write to private field"),i?i.call(s,t):e.set(s,t),t),De=(s,e,t)=>(At(s,e,"access private method"),t);import{W as ue}from"./framework.DeVdP8gD.js";const _t=Object.keys;function Xi(s){return typeof s=="boolean"}function Ji(s){return s&&typeof s.nodeType=="number"}function Et(s){return typeof s=="string"}function Bs(s){return typeof s=="number"}function be(s){return typeof s=="object"?s!==null:Qe(s)}function Qe(s){return typeof s=="function"}function Zi(s){return!!(s&&s.isComponent)}function ea(s){return be(s)&&typeof s.length=="number"&&typeof s.nodeType!="number"}function It(s,e){if(s)for(const t of _t(s))e(s[t],t)}function ta(s){return be(s)&&"current"in s}const Mt={animationIterationCount:0,borderImageOutset:0,borderImageSlice:0,borderImageWidth:0,boxFlex:0,boxFlexGroup:0,boxOrdinalGroup:0,columnCount:0,columns:0,flex:0,flexGrow:0,flexPositive:0,flexShrink:0,flexNegative:0,flexOrder:0,gridArea:0,gridRow:0,gridRowEnd:0,gridRowSpan:0,gridRowStart:0,gridColumn:0,gridColumnEnd:0,gridColumnSpan:0,gridColumnStart:0,fontWeight:0,lineClamp:0,lineHeight:0,opacity:0,order:0,orphans:0,tabSize:0,widows:0,zIndex:0,zoom:0,fillOpacity:0,floodOpacity:0,stopOpacity:0,strokeDasharray:0,strokeDashoffset:0,strokeMiterlimit:0,strokeOpacity:0,strokeWidth:0};function sa(s,e){return s+e.charAt(0).toUpperCase()+e.substring(1)}const ia=["Webkit","ms","Moz","O"];_t(Mt).forEach(s=>{ia.forEach(e=>{Mt[sa(e,s)]=0})});const aa=Symbol.for("jsx-dom:type");var Fs=function(s){return s.ShadowRoot="ShadowRoot",s}(Fs||{});function na(s){return s!=null&&s[aa]===Fs.ShadowRoot}const ra="http://www.w3.org/2000/svg",oa="http://www.w3.org/1999/xlink",la="http://www.w3.org/XML/1998/namespace";function Hs(s){return!Xi(s)&&s!=null}function Nt(s){return Array.isArray(s)?s.map(Nt).filter(Boolean).join(" "):be(s)?Symbol.iterator in s?Nt(Array.from(s)):_t(s).filter(e=>s[e]).join(" "):Hs(s)?""+s:""}const ca={animate:0,circle:0,clipPath:0,defs:0,desc:0,ellipse:0,feBlend:0,feColorMatrix:0,feComponentTransfer:0,feComposite:0,feConvolveMatrix:0,feDiffuseLighting:0,feDisplacementMap:0,feDistantLight:0,feFlood:0,feFuncA:0,feFuncB:0,feFuncG:0,feFuncR:0,feGaussianBlur:0,feImage:0,feMerge:0,feMergeNode:0,feMorphology:0,feOffset:0,fePointLight:0,feSpecularLighting:0,feSpotLight:0,feTile:0,feTurbulence:0,filter:0,foreignObject:0,g:0,image:0,line:0,linearGradient:0,marker:0,mask:0,metadata:0,path:0,pattern:0,polygon:0,polyline:0,radialGradient:0,rect:0,stop:0,svg:0,switch:0,symbol:0,text:0,textPath:0,tspan:0,use:0,view:0},ua=/^(a(ll|t|u)|base[FP]|c(al|lipPathU|on)|di|ed|ex|filter[RU]|g(lyphR|r)|ke|l(en|im)|ma(rker[HUW]|s)|n|pat|pr|point[^e]|re[^n]|s[puy]|st[^or]|ta|textL|vi|xC|y|z)/;function ko(s){const e=document.createDocumentFragment();return kt(s.children,e),e}function ha(s,e,t){e={...e,children:t};const i=new s(e),a=i.render();return"ref"in e&&Jt(e.ref,i),a}function W(s,e){let{children:t,...i}=e;!i.namespaceURI&&ca[s]===0&&(i={...i,namespaceURI:ra});let a;if(Et(s)){if(a=i.namespaceURI?document.createElementNS(i.namespaceURI,s):document.createElement(s),pa(i,a),kt(t,a),a instanceof window.HTMLSelectElement&&i.value!=null)if(i.multiple===!0&&Array.isArray(i.value)){const n=i.value.map(r=>String(r));a.querySelectorAll("option").forEach(r=>r.selected=n.includes(r.value))}else a.value=i.value;Jt(i.ref,a)}else if(Qe(s))be(s.defaultProps)&&(i={...s.defaultProps,...i}),a=Zi(s)?ha(s,i,t):s({...i,children:t});else throw new TypeError(`Invalid JSX element type: ${s}`);return a}function xo(s,e){for(var t=arguments.length,i=new Array(t>2?t-2:0),a=2;a<t;a++)i[a-2]=arguments[a];return(Et(e)||Array.isArray(e))&&(i.unshift(e),e={}),e=e||{},e.children!=null&&!i.length&&({children:i,...e}=e),W(s,{...e,children:i},e.key)}function Jt(s,e){ta(s)?s.current=e:Qe(s)&&s(e)}function kt(s,e){if(ea(s))da(s,e);else if(Et(s)||Bs(s))Pt(document.createTextNode(s),e);else if(s===null)Pt(document.createComment(""),e);else if(Ji(s))Pt(s,e);else if(na(s)){const t=e.attachShadow(s.attr);kt(s.children,t),Jt(s.ref,t)}}function da(s,e){for(const t of[...s])kt(t,e);return e}function Pt(s,e){e instanceof window.HTMLTemplateElement?e.content.appendChild(s):e.appendChild(s)}function at(s,e){return s.replace(/[A-Z]/g,t=>e+t.toLowerCase())}function Ws(s,e){e==null||e===!1||(Array.isArray(e)?e.forEach(t=>Ws(s,t)):Et(e)?s.setAttribute("style",e):be(e)&&It(e,(t,i)=>{i.indexOf("-")===0?s.style.setProperty(i,t):Bs(t)&&Mt[i]!==0?s.style[i]=t+"px":s.style[i]=t}))}function fa(s,e,t){switch(s){case"xlinkActuate":case"xlinkArcrole":case"xlinkHref":case"xlinkRole":case"xlinkShow":case"xlinkTitle":case"xlinkType":vs(t,oa,at(s,":"),e);return;case"xmlnsXlink":ke(t,at(s,":"),e);return;case"xmlBase":case"xmlLang":case"xmlSpace":vs(t,la,at(s,":"),e);return}switch(s){case"htmlFor":ke(t,"for",e);return;case"dataset":It(e,(i,a)=>{i!=null&&(t.dataset[a]=i)});return;case"innerHTML":case"innerText":case"textContent":Hs(e)&&(t[s]=e);return;case"dangerouslySetInnerHTML":be(e)&&(t.innerHTML=e.__html);return;case"value":if(e==null||t instanceof window.HTMLSelectElement)return;if(t instanceof window.HTMLTextAreaElement){t.value=e;return}break;case"spellCheck":t.spellcheck=e;return;case"class":case"className":Qe(e)?e(t):ke(t,"class",Nt(e));return;case"ref":case"namespaceURI":return;case"style":Ws(t,e);return;case"on":case"onCapture":It(e,(i,a)=>{t.addEventListener(a,i,s==="onCapture")});return}if(Qe(e)){if(s[0]==="o"&&s[1]==="n"){let i=s.toLowerCase();const a=i.endsWith("capture");if(i==="ondoubleclick"?i="ondblclick":a&&i==="ondoubleclickcapture"&&(i="ondblclickcapture"),!a&&t[i]===null)t[i]=e;else if(a)t.addEventListener(i.substring(2,i.length-7),e,!0);else{let n;i in window?n=i.substring(2):n=i[2]+s.slice(3),t.addEventListener(n,e)}}}else be(e)?t[s]=e:e===!0?ke(t,s,""):e!==!1&&e!=null&&(t instanceof SVGElement&&!ua.test(s)?ke(t,at(s,"-"),e):ke(t,s,e))}function ke(s,e,t){s.setAttribute(e,t)}function vs(s,e,t,i){s.setAttributeNS(e,t,i)}function pa(s,e){for(const t of _t(s))fa(t,s[t],e);return e}const ma="_ipe_progress_so6hn_1",ga={ipe_progress:ma},ya=s=>{const e=s.indeterminate??!0,t=W("div",{class:`${ga.ipe_progress}`,"data-indeterminate":`${e}`,style:{width:"100%","--progress":s.progress?`${s.progress}%`:"0%"},...s});return t.setProgress=i=>{typeof i=="number"?(t.dataset.indeterminate="false",t.style.setProperty("--progress",`${i}%`)):(t.dataset.indeterminate="true",t.style.setProperty("--progress","0%"))},t},Zt=()=>{let s,e;return{promise:new Promise((t,i)=>{s=t,e=i}),resolve:s,reject:e}};Promise.withResolvers||(Promise.withResolvers=Zt);var wa=Object.defineProperty,S=(s,e)=>wa(s,"name",{value:e,configurable:!0});function ba(){}S(ba,"noop");function M(s){return s==null}S(M,"isNullable");function va(s){return!M(s)}S(va,"isNonNullable");function ct(s){return s&&typeof s=="object"&&!Array.isArray(s)}S(ct,"isPlainObject");function zs(s,e){return Object.fromEntries(Object.entries(s).filter(([t,i])=>e(t,i)))}S(zs,"filterKeys");function de(s,e){return Object.fromEntries(Object.entries(s).map(([t,i])=>[t,e(i,t)]))}S(de,"mapValues");function qs(s,e,t){if(!e)return{...s};const i={};for(const a of e)(t||s[a]!==void 0)&&(i[a]=s[a]);return i}S(qs,"pick");function _a(s,e){if(!e)return{...s};const t={...s};for(const i of e)Reflect.deleteProperty(t,i);return t}S(_a,"omit");function F(s,e,t){return Object.defineProperty(s,e,{writable:!0,value:t,enumerable:!1})}S(F,"defineProperty");function Ea(s,e){return e.every(t=>s.includes(t))}S(Ea,"contain");function ka(s,e){return s.filter(t=>e.includes(t))}S(ka,"intersection");function xa(s,e){return s.filter(t=>!e.includes(t))}S(xa,"difference");function Sa(s,e){return Array.from(new Set([...s,...e]))}S(Sa,"union");function Ra(s){return[...new Set(s)]}S(Ra,"deduplicate");function fe(s,e){const t=s?.indexOf(e);return t>=0?(s.splice(t,1),!0):!1}S(fe,"remove");function Aa(s){return Array.isArray(s)?s:M(s)?[]:[s]}S(Aa,"makeArray");function pe(s,e){return arguments.length===1?t=>pe(s,t):s in globalThis&&e instanceof globalThis[s]||Object.prototype.toString.call(e).slice(8,-1)===s}S(pe,"is");function et(s){return pe("ArrayBuffer",s)||pe("SharedArrayBuffer",s)}S(et,"isArrayBufferLike");function Gs(s){return et(s)||ArrayBuffer.isView(s)}S(Gs,"isArrayBufferSource");var re;(s=>{s.is=et,s.isSource=Gs;function e(r){return ArrayBuffer.isView(r)?r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength):r}s.fromSource=e,S(e,"fromSource");function t(r){if(typeof Buffer<"u")return Buffer.from(r).toString("base64");let o="";const c=new Uint8Array(r);for(let l=0;l<c.byteLength;l++)o+=String.fromCharCode(c[l]);return btoa(o)}s.toBase64=t,S(t,"toBase64");function i(r){return typeof Buffer<"u"?e(Buffer.from(r,"base64")):Uint8Array.from(atob(r),o=>o.charCodeAt(0))}s.fromBase64=i,S(i,"fromBase64");function a(r){return typeof Buffer<"u"?Buffer.from(r).toString("hex"):Array.from(new Uint8Array(r),o=>o.toString(16).padStart(2,"0")).join("")}s.toHex=a,S(a,"toHex");function n(r){if(typeof Buffer<"u")return e(Buffer.from(r,"hex"));const o=r.length%2===0?r:r.slice(0,r.length-1),c=[];for(let l=0;l<o.length;l+=2)c.push(parseInt(`${o[l]}${o[l+1]}`,16));return Uint8Array.from(c).buffer}s.fromHex=n,S(n,"fromHex")})(re||(re={}));re.fromBase64;re.toBase64;re.fromHex;re.toHex;function ut(s,e=new Map){if(!s||typeof s!="object")return s;if(pe("Date",s))return new Date(s.valueOf());if(pe("RegExp",s))return new RegExp(s.source,s.flags);if(et(s))return s.slice(0);if(ArrayBuffer.isView(s))return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength);const t=e.get(s);if(t)return t;if(Array.isArray(s)){const a=[];return e.set(s,a),s.forEach((n,r)=>{a[r]=Reflect.apply(ut,null,[n,e])}),a}const i=Object.create(Object.getPrototypeOf(s));e.set(s,i);for(const a of Reflect.ownKeys(s)){const n={...Reflect.getOwnPropertyDescriptor(s,a)};"value"in n&&(n.value=Reflect.apply(ut,null,[n.value,e])),Reflect.defineProperty(i,a,n)}return i}S(ut,"clone");function ye(s,e,t){if(s===e||!t&&M(s)&&M(e))return!0;if(typeof s!=typeof e||typeof s!="object"||!s||!e)return!1;function i(a,n){return a(s)?a(e)?n(s,e):!1:a(e)?!1:void 0}return S(i,"check"),i(Array.isArray,(a,n)=>a.length===n.length&&a.every((r,o)=>ye(r,n[o])))??i(pe("Date"),(a,n)=>a.valueOf()===n.valueOf())??i(pe("RegExp"),(a,n)=>a.source===n.source&&a.flags===n.flags)??i(et,(a,n)=>{if(a.byteLength!==n.byteLength)return!1;const r=new Uint8Array(a),o=new Uint8Array(n);for(let c=0;c<r.length;c++)if(r[c]!==o[c])return!1;return!0})??Object.keys({...s,...e}).every(a=>ye(s[a],e[a],t))}S(ye,"deepEqual");function Pa(s){return s.charAt(0).toUpperCase()+s.slice(1)}S(Pa,"capitalize");function Ta(s){return s.charAt(0).toLowerCase()+s.slice(1)}S(Ta,"uncapitalize");function Oa(s){return s.replace(/[_-][a-z]/g,e=>e.slice(1).toUpperCase())}S(Oa,"camelCase");function es(s,e,t){const i=[];let a=0;for(let n=0;n<s.length;n++){const r=s.charCodeAt(n);if(r>=65&&r<=90){if(a===1){const o=s.charCodeAt(n+1);o>=97&&o<=122&&i.push(t),i.push(r+32)}else a!==0&&i.push(t),i.push(r+32);a=1}else r>=97&&r<=122?(i.push(r),a=2):e.includes(r)?(a!==0&&i.push(t),a=0):i.push(r)}return String.fromCharCode(...i)}S(es,"tokenize");function Ca(s){return es(s,[45,95],45)}S(Ca,"paramCase");function La(s){return es(s,[45,95],95)}S(La,"snakeCase");function Ia(s){return typeof s!="string"?`[${s.toString()}]`:/^[a-z_$][\w$]*$/i.test(s)?`.${s}`:`[${JSON.stringify(s)}]`}S(Ia,"formatProperty");function Ks(s){return s.replace(/\/$/,"")}S(Ks,"trimSlash");function Ma(s){return s.startsWith("/")||(s="/"+s),Ks(s)}S(Ma,"sanitize");var _s;(s=>{s.millisecond=1,s.second=1e3,s.minute=s.second*60,s.hour=s.minute*60,s.day=s.hour*24,s.week=s.day*7;let e=new Date().getTimezoneOffset();function t(y){e=y}s.setTimezoneOffset=t,S(t,"setTimezoneOffset");function i(){return e}s.getTimezoneOffset=i,S(i,"getTimezoneOffset");function a(y=new Date,b){return typeof y=="number"&&(y=new Date(y)),b===void 0&&(b=e),Math.floor((y.valueOf()/s.minute-b)/1440)}s.getDateNumber=a,S(a,"getDateNumber");function n(y,b){const k=new Date(y*s.day);return b===void 0&&(b=e),new Date(+k+b*s.minute)}s.fromDateNumber=n,S(n,"fromDateNumber");const r=/\d+(?:\.\d+)?/.source,o=new RegExp(`^${["w(?:eek(?:s)?)?","d(?:ay(?:s)?)?","h(?:our(?:s)?)?","m(?:in(?:ute)?(?:s)?)?","s(?:ec(?:ond)?(?:s)?)?"].map(y=>`(${r}${y})?`).join("")}$`);function c(y){const b=o.exec(y);return b?(parseFloat(b[1])*s.week||0)+(parseFloat(b[2])*s.day||0)+(parseFloat(b[3])*s.hour||0)+(parseFloat(b[4])*s.minute||0)+(parseFloat(b[5])*s.second||0):0}s.parseTime=c,S(c,"parseTime");function l(y){const b=c(y);return b?y=Date.now()+b:/^\d{1,2}(:\d{1,2}){1,2}$/.test(y)?y=`${new Date().toLocaleDateString()}-${y}`:/^\d{1,2}-\d{1,2}-\d{1,2}(:\d{1,2}){1,2}$/.test(y)&&(y=`${new Date().getFullYear()}-${y}`),y?new Date(y):new Date}s.parseDate=l,S(l,"parseDate");function d(y){const b=Math.abs(y);return b>=s.day-s.hour/2?Math.round(y/s.day)+"d":b>=s.hour-s.minute/2?Math.round(y/s.hour)+"h":b>=s.minute-s.second/2?Math.round(y/s.minute)+"m":b>=s.second?Math.round(y/s.second)+"s":y+"ms"}s.format=d,S(d,"format");function p(y,b=2){return y.toString().padStart(b,"0")}s.toDigits=p,S(p,"toDigits");function g(y,b=new Date){return y.replace("yyyy",b.getFullYear().toString()).replace("yy",b.getFullYear().toString().slice(2)).replace("MM",p(b.getMonth()+1)).replace("dd",p(b.getDate())).replace("hh",p(b.getHours())).replace("mm",p(b.getMinutes())).replace("ss",p(b.getSeconds())).replace("SSS",p(b.getMilliseconds(),3))}s.template=g,S(g,"template")})(_s||(_s={}));var Na=Object.defineProperty,x=(s,e)=>Na(s,"name",{value:e,configurable:!0}),_={shadow:Symbol.for("cordis.shadow"),receiver:Symbol.for("cordis.receiver"),original:Symbol.for("cordis.original"),store:Symbol.for("cordis.store"),events:Symbol.for("cordis.events"),static:Symbol.for("cordis.static"),filter:Symbol.for("cordis.filter"),expose:Symbol.for("cordis.expose"),isolate:Symbol.for("cordis.isolate"),internal:Symbol.for("cordis.internal"),intercept:Symbol.for("cordis.intercept"),setup:Symbol.for("cordis.setup"),invoke:Symbol.for("cordis.invoke"),extend:Symbol.for("cordis.extend"),tracker:Symbol.for("cordis.tracker"),provide:Symbol.for("cordis.provide"),immediate:Symbol.for("cordis.immediate")},$a=(function*(){}).constructor,Es=(async function*(){}).constructor;function ts(s){return!(!s.prototype||s instanceof $a||Es!==Function&&s instanceof Es)}x(ts,"isConstructor");function tt(s,e){const t=s.Config||s.schema;return t&&s.schema!==!1&&(e=t(e)),e??{}}x(tt,"resolveConfig");function Vs(s){return[Map,Set,Date,Promise].some(e=>s instanceof e)}x(Vs,"isUnproxyable");function ss(s,e){if(s===Object.prototype)return e;const t=Object.create(ss(Object.getPrototypeOf(s),e));for(const i of Reflect.ownKeys(s))Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(s,i));return t}x(ss,"joinPrototype");function is(s){return s&&(typeof s=="object"||typeof s=="function")}x(is,"isObject");function oe(s,e,t){if(!is(e))return e;if(Object.hasOwn(e,_.shadow))return Object.getPrototypeOf(e);const i=e[_.tracker];return i?xt(s,e,i,t):e}x(oe,"getTraceable");function Xe(s,e){return e?new Proxy(s,{get:x((t,i,a)=>i in e&&i!=="constructor"?Reflect.get(e,i,a):Reflect.get(t,i,a),"get"),set:x((t,i,a,n)=>i in e&&i!=="constructor"?Reflect.set(e,i,a,n):Reflect.set(t,i,a,n),"set")}):s}x(Xe,"withProps");function ht(s,e,t){return Xe(s,Object.defineProperty(Object.create(null),e,{value:t,writable:!1}))}x(ht,"withProp");function $t(s,e,t,i){if(!t)return i;const a=Reflect.getOwnPropertyDescriptor(e,t)?.value;return a?ht(i,t,s.extend({[_.shadow]:a})):i}x($t,"createShadow");function Ys(s,e,t,i){return new Proxy(e,{apply:x((a,n,r)=>(n===t&&(n=i),r=r.map(o=>typeof o!="function"||o[_.original]?o:new Proxy(o,{get:x((c,l,d)=>{if(l===_.original)return c;const p=Reflect.get(c,l,d);return l==="toString"&&p===Function.prototype.toString?function(...g){return Reflect.apply(p,this===d?c:this,g)}:p},"get"),apply:x((c,l,d)=>Reflect.apply(c,oe(s,l),d.map(p=>oe(s,p))),"apply"),construct:x((c,l,d)=>Reflect.construct(c,l.map(p=>oe(s,p)),d),"construct")})),oe(s,Reflect.apply(a,n,r))),"apply")})}x(Ys,"createShadowMethod");function xt(s,e,t,i){s[_.shadow]&&(s=Object.getPrototypeOf(s));const a=new Proxy(e,{get:x((n,r,o)=>{if(r===_.original)return n;if(r===t.property)return s;if(typeof r=="symbol")return Reflect.get(n,r,o);if(t.associate&&s[_.internal][`${t.associate}.${r}`])return Reflect.get(s,`${t.associate}.${r}`,ht(s,_.receiver,o));const c=$t(s,n,t.property,o),l=Reflect.get(n,r,c),d=l?.[_.tracker];return d?xt(s,l,d):!i&&typeof l=="function"?Ys(s,l,o,c):l},"get"),set:x((n,r,o,c)=>{if(r===_.original||r===t.property)return!1;if(typeof r=="symbol")return Reflect.set(n,r,o,c);if(t.associate&&s[_.internal][`${t.associate}.${r}`])return Reflect.set(s,`${t.associate}.${r}`,o,ht(s,_.receiver,c));const l=$t(s,n,t.property,c);return Reflect.set(n,r,o,l)},"set"),apply:x((n,r,o)=>as(a,n,r,o),"apply")});return a}x(xt,"createTraceable");function as(s,e,t,i){return e[_.invoke]?e[_.invoke].apply(s,i):Reflect.apply(e,t,i)}x(as,"applyTraceable");function Ut(s,e,t){const i=x(function(...a){const n=xt(i.ctx,i,t);return as(n,i,this,a)},"self");return F(i,"name",s),Object.setPrototypeOf(i,e)}x(Ut,"createCallable");var se,Ua=(se=class{constructor(e){this.ctx=e,F(this,_.tracker,{associate:"reflect",property:"ctx"}),this._mixin("reflect",["get","set","provide","accessor","mixin","alias"]),this._mixin("scope",["config","runtime","effect","collect","accept","decline"]),this._mixin("registry",["using","inject","plugin"]),this._mixin("lifecycle",["on","once","parallel","emit","serial","bail","start","stop"])}static resolveInject(e,t){let i=e[_.internal][t];for(;i?.type==="alias";)t=i.name,i=e[_.internal][t];return[t,i]}static checkInject(e,t,i){if(e=e[_.shadow]??e,["prototype","then","registry","lifecycle"].includes(t)||t[0]==="$"||t[0]==="_"||!e.runtime.plugin||e.bail(e,"internal/inject",t))return;const a=i.stack.split(`
`);a.splice(1,1),i.stack=a.join(`
`),e.emit(e,"internal/warning",i)}get(e){if(this.ctx[_.internal][e]?.type!=="service")return;const t=this.ctx[_.isolate][e],i=this.ctx[_.store][t]?.value;return oe(this.ctx,i)}set(e,t){this.provide(e);const i=this.ctx[_.isolate][e],a=this.ctx[_.store][i]?.value;t??=void 0;let n=x(()=>{},"dispose");if(a===t)return n;if(!M(t)&&!M(a))throw new Error(`service ${e} has been registered`);const r=this.ctx;M(t)||(n=r.effect(()=>()=>{r.set(e,void 0)})),Vs(t)&&r.emit(r,"internal/warning",new Error(`service ${e} is an unproxyable object, which may lead to unexpected behavior`));const o=Object.create(r);return o[_.filter]=c=>r[_.isolate][e]===c[_.isolate][e],r.emit(o,"internal/before-service",e,t),r[_.store][i]={value:t,source:r},r.emit(o,"internal/service",e,a),n}provide(e,t,i){const a=this.ctx.root[_.internal];if(e in a)return;const n=Symbol(e);a[e]={type:"service",builtin:i},this.ctx.root[_.isolate][e]=n,is(t)&&(this.ctx[_.store][n]={value:t,source:null},F(t,_.tracker,{associate:e,property:"ctx"}))}_accessor(e,t){const i=this.ctx.root[_.internal];return e in i?()=>{}:(i[e]={type:"accessor",...t},()=>delete this.ctx.root[_.isolate][e])}accessor(e,t){this.ctx.scope.effect(()=>this._accessor(e,t))}alias(e,t){const i=this.ctx.root[_.internal];if(!(e in i))for(const a of t)i[a]||={type:"alias",name:e}}_mixin(e,t){const i=Array.isArray(t)?t.map(r=>[r,r]):Object.entries(t),a=typeof e=="string"?r=>r[e]:()=>e,n=i.map(([r,o])=>this._accessor(o,{get(c){const l=a(this);if(M(l))return l;const d=c?Xe(c,l):l,p=Reflect.get(l,r,d);return typeof p!="function"?p:p.bind(d??l)},set(c,l){const d=a(this),p=l?Xe(l,d):d;return Reflect.set(d,r,c,p)}}));return()=>n.forEach(r=>r())}mixin(e,t){this.ctx.scope.effect(()=>this._mixin(e,t))}trace(e){return oe(this.ctx,e)}bind(e){return new Proxy(e,{apply:x((t,i,a)=>t.apply(this.trace(i),a.map(n=>this.trace(n))),"apply")})}},x(se,"ReflectService"),U(se,"handler",{get:x((e,t,i)=>{if(typeof t!="string")return Reflect.get(e,t,i);if(Reflect.has(e,t))return oe(i,Reflect.get(e,t,i),!0);const[a,n]=se.resolveInject(e,t),r=new Error(`property ${a} is not registered, declare it as \`inject\` to suppress this warning`);return n?n.type==="accessor"?n.get.call(i,i[_.receiver]):(n.builtin||se.checkInject(i,a,r),i.reflect.get(a)):(se.checkInject(i,a,r),Reflect.get(e,a,i))},"get"),set:x((e,t,i,a)=>{if(typeof t!="string")return Reflect.set(e,t,i,a);const[n,r]=se.resolveInject(e,t);return r?r.type==="accessor"?r.set?r.set.call(a,i,a[_.receiver]):!1:(a.reflect.set(n,i),!0):Reflect.set(e,n,i,a)},"set"),has:x((e,t)=>{if(typeof t!="string")return Reflect.has(e,t);if(Reflect.has(e,t))return!0;const[,i]=se.resolveInject(e,t);return!!i},"has")}),se),Dt=Ua;function jt(s){return s!==null&&s!==!1&&s!==void 0}x(jt,"isBailed");var Ce,Da=(Ce=class{constructor(e){this.ctx=e,F(this,_.tracker,{associate:"lifecycle",property:"ctx"}),F(this.on("internal/listener",function(i,a,n){const r=n.prepend?"unshift":"push";if(i==="ready")return this.lifecycle.isActive?(this.scope.ensure(async()=>a()),()=>!1):void 0;if(i==="dispose")return this.scope.disposables[r](a),F(a,"name","event <dispose>"),()=>fe(this.scope.disposables,a);if(i==="fork")return this.scope.runtime.forkables[r](a),this.scope.collect("event <fork>",()=>fe(this.scope.runtime.forkables,a))}),Y.static,e.scope);for(const i of["info","error","warning"])F(this.on(`internal/${i}`,(a,...n)=>{this._hooks[`internal/${i}`].length>1}),Y.static,e.scope);F(this.on("internal/before-service",function(i){for(const a of this.registry.values()){if(!a.inject[i]?.required)continue;const n=a.isReusable?a.children:[a];for(const r of n)this[_.filter](r.ctx)&&(r.updateStatus(),r.reset())}},{global:!0}),Y.static,e.scope),F(this.on("internal/service",function(i){for(const a of this.registry.values()){if(!a.inject[i]?.required)continue;const n=a.isReusable?a.children:[a];for(const r of n)this[_.filter](r.ctx)&&r.start()}},{global:!0}),Y.static,e.scope);const t=x((i,a)=>{if(!i.runtime.plugin)return!1;for(const n in i.runtime.inject)if(a===Dt.resolveInject(i.ctx,n)[0])return!0;return t(i.parent.scope,a)},"checkInject");F(this.on("internal/inject",function(i){return t(this.scope,i)},{global:!0}),Y.static,e.scope)}isActive=!1;_tasks=new Set;_hooks={};async flush(){for(;this._tasks.size;)await Promise.all(Array.from(this._tasks))}filterHooks(e,t){return t=oe(this.ctx,t),e.slice().filter(i=>{const a=t?.[Y.filter];return i.global||!a||a.call(t,i.ctx)})}*dispatch(e,t){const i=typeof t[0]=="object"||typeof t[0]=="function"?t.shift():null,a=t.shift();a!=="internal/event"&&this.emit("internal/event",e,a,t,i);for(const n of this.filterHooks(this._hooks[a]||[],i))yield n.callback.apply(i,t)}async parallel(...e){await Promise.all(this.dispatch("emit",e))}emit(...e){Array.from(this.dispatch("emit",e))}async serial(...e){for await(const t of this.dispatch("serial",e))if(jt(t))return t}bail(...e){for(const t of this.dispatch("bail",e))if(jt(t))return t}register(e,t,i,a){const n=a.prepend?"unshift":"push";return t[n]({ctx:this.ctx,callback:i,...a}),this.ctx.state.collect(e,()=>this.unregister(t,i))}unregister(e,t){const i=e.findIndex(a=>a.callback===t);if(i>=0)return e.splice(i,1),!0}on(e,t,i){typeof i!="object"&&(i={prepend:i}),this.ctx.scope.assertActive(),t=this.ctx.reflect.bind(t);const a=this.bail(this.ctx,"internal/listener",e,t,i);if(a)return a;const n=this._hooks[e]||=[],r=typeof e=="string"?`event <${e}>`:"event (Symbol)";return this.register(r,n,t,i)}once(e,t,i){const a=this.on(e,function(...n){return a(),t.apply(this,n)},i);return a}async start(){this.isActive=!0;const e=this._hooks.ready||[];for(;e.length;){const{ctx:t,callback:i}=e.shift();t.scope.ensure(async()=>i())}await this.flush()}async stop(){this.isActive=!1,this.ctx.scope.reset()}},x(Ce,"Lifecycle"),Ce),ja=Da,we,Bt=(we=class extends Error{constructor(e,t){super(t??we.Code[e]),this.code=e}},x(we,"CordisError"),we);(s=>{s.Code={INACTIVE_EFFECT:"cannot create effect on inactive context"}})(Bt||(Bt={}));var Le,Qs=(Le=class{constructor(e,t){this.parent=e,this.config=t,this.uid=e.registry?e.registry.counter:0,this.ctx=this.context=e.extend({scope:this}),this.proxy=new Proxy({},{get:x((i,a)=>Reflect.get(this.config,a),"get")})}uid;ctx;disposables=[];error;status=0;isActive=!1;context;proxy;acceptors=[];tasks=new Set;hasError=!1;get _config(){return this.runtime.isReactive?this.proxy:this.config}assertActive(){if(!(this.uid!==null||this.isActive))throw new Bt("INACTIVE_EFFECT")}effect(e,t){this.assertActive();const i=ts(e)?new e(this.ctx,t):e(this.ctx,t);let a=!1;const n=typeof i=="function"?i:i.dispose.bind(i),r=x((...o)=>{if(!a)return a=!0,fe(this.disposables,r),n(...o)},"wrapped");return this.disposables.push(r),typeof i=="function"?r:(i.dispose=r,i)}collect(e,t){const i=F(()=>(fe(this.disposables,i),t()),"name",e);return this.disposables.push(i),i}restart(){this.reset(),this.error=null,this.hasError=!1,this.status=0,this.start()}_getStatus(){return this.uid===null?4:this.hasError?3:this.tasks.size?1:this.ready?2:0}updateStatus(e){const t=this.status;e?.(),this.status=this._getStatus(),t!==this.status&&this.context.emit("internal/status",this,t)}ensure(e){const t=e().catch(i=>{this.context.emit(this.ctx,"internal/error",i),this.cancel(i)}).finally(()=>{this.updateStatus(()=>this.tasks.delete(t)),this.context.events._tasks.delete(t)});this.updateStatus(()=>this.tasks.add(t)),this.context.events._tasks.add(t)}cancel(e){this.error=e,this.updateStatus(()=>this.hasError=!0),this.reset()}get ready(){return Object.entries(this.runtime.inject).every(([e,t])=>!t.required||!M(this.ctx.get(e)))}reset(){this.isActive=!1,this.disposables=this.disposables.splice(0).filter(e=>{if(this.uid!==null&&e[Y.static]===this)return!0;(async()=>e())().catch(t=>{this.context.emit(this.ctx,"internal/error",t)})})}init(e){this.config?this.start():this.cancel(e)}start(){if(!this.ready||this.isActive||this.uid===null)return!0;this.isActive=!0,this.updateStatus(()=>this.hasError=!1)}accept(...e){const t={keys:Array.isArray(e[0])?e.shift():null,callback:e[0],...e[1]};return this.effect(()=>(this.acceptors.push(t),t.immediate&&t.callback?.(this.config),()=>fe(this.acceptors,t)))}decline(e){return this.accept(e,()=>!0)}checkUpdate(e,t){if(t||!this.config)return[!0,!0];if(t===!1)return[!1,!1];const i=Object.create(null),a=x(l=>{const d=i[l]??=!ye(this.config[l],e[l]);return r||=d,d},"checkPropertyUpdate"),n=new Set;let r=!1,o=!1,c=this.runtime.isReactive||null;for(const{keys:l,callback:d,passive:p}of this.acceptors){if(!l)c||=!p;else if(p)l?.forEach(g=>n.add(g));else{let g=!1;for(const y of l)g||=a(y);if(!g)continue}d?.(e)&&(o=!0)}for(const l in{...this.config,...e})if(c!==!1&&!(l in i)&&!n.has(l)){const d=a(l);c===null&&(o||=d)}return[r,o]}},x(Le,"EffectScope"),Le),Ie,Ba=(Ie=class extends Qs{constructor(e,t,i,a){super(e,i),this.runtime=t,this.dispose=F(e.scope.collect(`fork <${e.runtime.name}>`,()=>{this.uid=null,this.reset(),this.context.emit("internal/fork",this);const n=fe(t.disposables,this.dispose);return fe(t.children,this)&&!t.children.length&&e.registry.delete(t.plugin),n}),Y.static,t),t.children.push(this),t.disposables.push(this.dispose),this.context.emit("internal/fork",this),this.init(a)}dispose;start(){if(super.start())return!0;for(const e of this.runtime.forkables)this.ensure(async()=>e(this.context,this._config))}update(e,t){const i=this.config,a=this.runtime.isForkable?this:this.runtime;if(a.config!==i)return;let n;try{n=tt(this.runtime.plugin,e)}catch(c){return this.context.emit("internal/error",c),this.cancel(c)}const[r,o]=a.checkUpdate(n,t);this.context.emit("internal/before-update",this,e),this.config=n,a.config=n,r&&this.context.emit("internal/update",this,i),o&&a.restart()}},x(Ie,"ForkScope"),Ie),Me,ks=(Me=class extends Qs{constructor(e,t,i,a){super(e,i),this.plugin=t,t?(this.setup(),this.init(a)):(this.name="root",this.isActive=!0)}value;runtime=this;schema;name;inject=Object.create(null);forkables=[];children=[];isReusable=!1;isReactive=!1;get isForkable(){return this.forkables.length>0}fork(e,t,i){return new Ba(e,this,t,i)}dispose(){return this.uid=null,this.reset(),this.context.emit("internal/runtime",this),!0}setup(){const{name:e}=this.plugin;e&&e!=="apply"&&(this.name=e),this.schema=this.plugin.Config||this.plugin.schema,this.inject=ve.resolve(this.plugin.using||this.plugin.inject),this.isReusable=this.plugin.reusable,this.isReactive=this.plugin.reactive,this.context.emit("internal/runtime",this),this.isReusable&&this.forkables.push(this.apply)}apply=x((e,t)=>{if(typeof this.plugin!="function")return this.plugin.apply(e,t);if(ts(this.plugin)){const i=new this.plugin(e,t),a=i[Y.expose];return a&&e.set(a,i),i.fork&&this.forkables.push(i.fork.bind(i)),i}else return this.plugin(e,t)},"apply");reset(){super.reset();for(const e of this.children)e.reset()}start(){if(super.start())return!0;!this.isReusable&&this.plugin&&this.ensure(async()=>this.value=this.apply(this.ctx,this._config));for(const e of this.children)e.start()}update(e,t){if(this.isForkable){const c=new Error(`attempting to update forkable plugin "${this.plugin.name}", which may lead to unexpected behavior`);this.context.emit(this.ctx,"internal/warning",c)}const i=this.config;let a;try{a=tt(this.runtime.plugin||this.context.constructor,e)}catch(c){return this.context.emit("internal/error",c),this.cancel(c)}const[n,r]=this.checkUpdate(a,t),o=this.children.find(c=>c.config===i);this.config=a,o&&(this.context.emit("internal/before-update",o,e),o.config=a,n&&this.context.emit("internal/update",o,i)),r&&this.restart()}},x(Me,"MainScope"),Me);function Xs(s){return s&&typeof s=="object"&&typeof s.apply=="function"}x(Xs,"isApplicable");function ve(s){return function(e,t){if(t.kind==="class")e.inject=s;else if(t.kind==="method")t.addInitializer(function(){const i=this[_.tracker]?.property;if(!i)throw new Error("missing context tracker");this[i].inject(s,a=>{e.call(Xe(this,{[i]:a}))})});else throw new Error("@Inject can only be used on class or class methods")}}x(ve,"Inject");(s=>{function e(t){if(!t)return{};if(Array.isArray(t))return Object.fromEntries(t.map(r=>[r,{required:!0}]));const{required:i,optional:a,...n}=t;return Array.isArray(i)&&Object.assign(n,Object.fromEntries(i.map(r=>[r,{required:!0}]))),Array.isArray(a)&&Object.assign(n,Object.fromEntries(a.map(r=>[r,{required:!1}]))),n}s.resolve=e,x(e,"resolve")})(ve||(ve={}));var Ne,Fa=(Ne=class{constructor(e,t){this.ctx=e,F(this,_.tracker,{associate:"registry",property:"ctx"}),this.context=e;const i=new ks(e,null,t);e.scope=i,i.ctx=e,this.set(null,i)}_counter=0;_internal=new Map;context;get counter(){return++this._counter}get size(){return this._internal.size}resolve(e,t=!1){if(e===null||typeof e=="function")return e;if(Xs(e))return e.apply;if(t)throw new Error('invalid plugin, expect function or object with an "apply" method, received '+typeof e)}get(e){const t=this.resolve(e);return t&&this._internal.get(t)}has(e){const t=this.resolve(e);return!!t&&this._internal.has(t)}set(e,t){const i=this.resolve(e);this._internal.set(i,t)}delete(e){const t=this.resolve(e),i=t&&this._internal.get(t);if(i)return this._internal.delete(t),i.dispose(),i}keys(){return this._internal.keys()}values(){return this._internal.values()}entries(){return this._internal.entries()}forEach(e){return this._internal.forEach(e)}using(e,t){return this.inject(e,t)}inject(e,t){return this.plugin({inject:e,apply:t,name:t.name})}plugin(e,t,i){if(this.resolve(e,!0),this.ctx.scope.assertActive(),!i)try{t=tt(e,t)}catch(n){this.context.emit(this.ctx,"internal/error",n),i=n,t=null}let a=this.get(e);return a?(a.isForkable||this.context.emit(this.ctx,"internal/warning",new Error(`duplicate plugin detected: ${e.name}`)),a.fork(this.ctx,t,i)):(a=new ks(this.ctx,e,t,i),this.set(e,a),a.fork(this.ctx,t,i))}},x(Ne,"Registry"),Ne),Ha=Fa,N,Y=(N=class{static is(e){return!!e?.[N.is]}static associate(e,t){return e}constructor(e){e=tt(this.constructor,e),this[_.store]=Object.create(null),this[_.isolate]=Object.create(null),this[_.internal]=Object.create(null),this[_.intercept]=Object.create(null);const t=new Proxy(this,Dt.handler);t.root=t,t.reflect=new Dt(t),t.registry=new Ha(t,e),t.lifecycle=new ja(t);const i=x(a=>{if(a){i(Object.getPrototypeOf(a));for(const n of Object.getOwnPropertyNames(a)){const r=a[n].prototype?.constructor;r&&(t[a[n].key]=new r(t,e),F(t[a[n].key],"ctx",t))}}},"attach");return i(this[_.internal]),t}[Symbol.for("nodejs.util.inspect.custom")](){return`Context <${this.name}>`}get name(){let e=this.runtime;for(;e&&!e.name;)e=e.parent.runtime;return e?.name}get events(){return this.lifecycle}get state(){return this.scope}extend(e={}){const t=Reflect.getOwnPropertyDescriptor(this,_.shadow)?.value,i=Object.assign(Object.create(oe(this,this)),e);return t?Object.assign(Object.create(i),{[_.shadow]:t}):i}isolate(e,t){const i=Object.create(this[_.isolate]);return i[e]=t??Symbol(e),this.extend({[_.isolate]:i})}intercept(e,t){const i=Object.create(this[_.intercept]);return i[e]=t,this.extend({[_.intercept]:i})}},x(N,"Context"),U(N,"store",_.store),U(N,"events",_.events),U(N,"static",_.static),U(N,"filter",_.filter),U(N,"expose",_.expose),U(N,"isolate",_.isolate),U(N,"internal",_.internal),U(N,"intercept",_.intercept),U(N,"origin","ctx"),U(N,"current","ctx"),N.is[Symbol.toPrimitive]=()=>Symbol.for("cordis.is"),N.prototype[N.is]=!0,N);Y.prototype[Y.internal]=Object.create(null);var Z,Ee=(Z=class{start(){}stop(){}ctx;name;config;constructor(...e){let t,i,a,n;Y.is(e[0])?(t=e[0],typeof e[1]=="string"?(i=e[1],a=e[2]):n=e[1]):n=e[0],i??=this.constructor[_.provide],a??=this.constructor[_.immediate];let r=this;const o={associate:i,property:"ctx"};return r[_.invoke]&&(r=Ut(i,ss(Object.getPrototypeOf(this),Function.prototype),o)),t?r.ctx=t:r[_.setup](),r.name=i,r.config=n,F(r,_.tracker,o),r.ctx.provide(i),r.ctx.runtime.name=i,a&&(t?r[_.expose]=i:r.ctx.set(i,r)),r.ctx.on("ready",async()=>{await Promise.resolve(),await r.start(),a||r.ctx.set(i,r)}),r.ctx.on("dispose",()=>r.stop()),r}[_.filter](e){return e[_.isolate][this.name]===this.ctx[_.isolate][this.name]}[_.setup](){this.ctx=new Y}[_.extend](e){let t;return this[Z.invoke]?t=Ut(this.name,this,this[_.tracker]):t=Object.create(this),Object.assign(t,e)}static[Symbol.hasInstance](e){let t=e.constructor;for(;t;){if(t=t.prototype?.constructor,t===this)return!0;t=Object.getPrototypeOf(t)}return!1}},x(Z,"Service"),U(Z,"setup",_.setup),U(Z,"invoke",_.invoke),U(Z,"extend",_.extend),U(Z,"tracker",_.tracker),U(Z,"provide",_.provide),U(Z,"immediate",_.immediate),Z),Wa=Object.defineProperty,za=Object.getOwnPropertyNames,T=(s,e)=>Wa(s,"name",{value:e,configurable:!0}),qa=(s,e)=>function(){return e||(0,s[za(s)[0]])((e={exports:{}}).exports,e),e.exports},Ga=qa({"src/index.ts"(s,e){var z;var t=Symbol.for("schemastery"),i=Symbol.for("ValidationError");globalThis.__schemastery_index__??=0;var a=(z=class extends TypeError{constructor(u,f){let m="$";for(const w of f.path||[])typeof w=="string"?m+="."+w:typeof w=="number"?m+="["+w+"]":typeof w=="symbol"&&(m+=`[Symbol(${w.toString()})]`);m.startsWith(".")&&(m=m.slice(1)),super((m==="$"?"":`${m} `)+u),this.options=f}name="ValidationError";static is(u){return!!u?.[i]}},T(z,"ValidationError"),z);Object.defineProperty(a.prototype,i,{value:!0});var n=T(function(h){const u=T(function(f,m={}){return n.resolve(f,u,m)[0]},"schema");if(h.refs){const f=de(h.refs,w=>new n(w)),m=T(w=>f[w],"getRef");for(const w in f){const v=f[w];v.sKey=m(v.sKey),v.inner=m(v.inner),v.list=v.list&&v.list.map(m),v.dict=v.dict&&de(v.dict,m)}return f[h.uid]}if(Object.assign(u,h),typeof u.callback=="string")try{u.callback=new Function("return "+u.callback)()}catch{}return Object.defineProperty(u,"uid",{value:globalThis.__schemastery_index__++}),Object.setPrototypeOf(u,n.prototype),u.meta||={},u.toString=u.toString.bind(u),u},"Schema");n.prototype=Object.create(Function.prototype),n.prototype[t]=!0,n.ValidationError=a;var r;n.prototype.toJSON=T(function(){if(r)return r[this.uid]??=JSON.parse(JSON.stringify({...this})),this.uid;r={[this.uid]:{...this}},r[this.uid]=JSON.parse(JSON.stringify({...this}));const h={uid:this.uid,refs:r};return r=void 0,h},"toJSON"),n.prototype.set=T(function(h,u){return this.dict[h]=u,this},"set"),n.prototype.push=T(function(h){return this.list.push(h),this},"push");function o(h,u){const f=typeof h=="string"?{"":h}:{...h};for(const m in u){const w=u[m];w?.$description||w?.$desc?f[m]=w.$description||w.$desc:typeof w=="string"&&(f[m]=w)}return f}T(o,"mergeDesc");function c(h){return h?.$value??h?.$inner}T(c,"getInner");function l(h){return zs(h??{},u=>!u.startsWith("$"))}T(l,"extractKeys"),n.prototype.i18n=T(function(h){const u=n(this),f=o(u.meta.description,h);return Object.keys(f).length&&(u.meta.description=f),u.dict&&(u.dict=de(u.dict,(m,w)=>m.i18n(de(h,v=>c(v)?.[w]??v?.[w])))),u.list&&(u.list=u.list.map((m,w)=>m.i18n(de(h,(v={})=>Array.isArray(c(v))?c(v)[w]:Array.isArray(v)?v[w]:l(v))))),u.inner&&(u.inner=u.inner.i18n(de(h,m=>c(m)?c(m):l(m)))),u.sKey&&(u.sKey=u.sKey.i18n(de(h,m=>m?.$key))),u},"i18n"),n.prototype.extra=T(function(h,u){const f=n(this);return f.meta={...f.meta,[h]:u},f},"extra");for(const h of["required","disabled","collapse","hidden","loose"])Object.assign(n.prototype,{[h](u=!0){const f=n(this);return f.meta={...f.meta,[h]:u},f}});n.prototype.deprecated=T(function(){const h=n(this);return h.meta.badges||=[],h.meta.badges.push({text:"deprecated",type:"danger"}),h},"deprecated"),n.prototype.experimental=T(function(){const h=n(this);return h.meta.badges||=[],h.meta.badges.push({text:"experimental",type:"warning"}),h},"experimental"),n.prototype.pattern=T(function(h){const u=n(this),f=qs(h,["source","flags"]);return u.meta={...u.meta,pattern:f},u},"pattern"),n.prototype.simplify=T(function(h){if(ye(h,this.meta.default,this.type==="dict"))return null;if(M(h))return h;if(this.type==="object"||this.type==="dict"){const u={};for(const f in h){const m=(this.type==="object"?this.dict[f]:this.inner)?.simplify(h[f]);(this.type==="dict"||!M(m))&&(u[f]=m)}return ye(u,this.meta.default,this.type==="dict")?null:u}else if(this.type==="array"||this.type==="tuple"){const u=[];return h.forEach((f,m)=>{const w=this.type==="array"?this.inner:this.list[m],v=w?w.simplify(f):f;u.push(v)}),u}else if(this.type==="intersect"){const u={};for(const f of this.list)Object.assign(u,f.simplify(h));return u}else if(this.type==="union")for(const u of this.list)try{return n.resolve(h,u,{}),u.simplify(h)}catch{}return h},"simplify"),n.prototype.toString=T(function(h){return O[this.type]?.(this,h)??`Schema<${this.type}>`},"toString"),n.prototype.role=T(function(h,u){const f=n(this);return f.meta={...f.meta,role:h,extra:u},f},"role");for(const h of["default","link","comment","description","max","min","step"])Object.assign(n.prototype,{[h](u){const f=n(this);return f.meta={...f.meta,[h]:u},f}});var d={};n.extend=T(function(h,u){d[h]=u},"extend"),n.resolve=T(function(h,u,f={},m=!1){if(!u)return[h];if(f.ignore?.(h,u))return[h];if(M(h)&&u.type!=="lazy"){if(u.meta.required)throw new a("missing required value",f);let v=u,E=u.meta.default;for(;v?.type==="intersect"&&M(E);)v=v.list[0],E=v?.meta.default;if(M(E))return[h];h=ut(E)}const w=d[u.type];if(!w)throw new a(`unsupported type "${u.type}"`,f);try{return w(h,u,f,m)}catch(v){if(!u.meta.loose)throw v;return[u.meta.default]}},"resolve"),n.from=T(function(h){if(M(h))return n.any();if(["string","number","boolean"].includes(typeof h))return n.const(h).required();if(h[t])return h;if(typeof h=="function")switch(h){case String:return n.string().required();case Number:return n.number().required();case Boolean:return n.boolean().required();case Function:return n.function().required();default:return n.is(h).required()}else throw new TypeError(`cannot infer schema from ${h}`)},"from"),n.lazy=T(function(h){const u=T(()=>(f.inner[t]||(f.inner=f.builder(),f.inner.meta={...f.meta,...f.inner.meta}),f.inner.toJSON()),"toJSON"),f=new n({type:"lazy",builder:h,inner:{toJSON:u}});return f},"lazy"),n.natural=T(function(){return n.number().step(1).min(0)},"natural"),n.percent=T(function(){return n.number().step(.01).min(0).max(1).role("slider")},"percent"),n.date=T(function(){return n.union([n.is(Date),n.transform(n.string().role("datetime"),(h,u)=>{const f=new Date(h);if(isNaN(+f))throw new a(`invalid date "${h}"`,u);return f},!0)])},"date"),n.regExp=T(function(h=""){return n.union([n.is(RegExp),n.transform(n.string().role("regexp",{flag:h}),(u,f)=>{try{return new RegExp(u,h)}catch(m){throw new a(m.message,f)}},!0)])},"regExp"),n.arrayBuffer=T(function(h){return n.union([n.is(ArrayBuffer),n.is(SharedArrayBuffer),n.transform(n.any(),(u,f)=>{if(re.isSource(u))return re.fromSource(u);throw new a(`expected ArrayBufferSource but got ${u}`,f)},!0),...h?[n.transform(n.string(),(u,f)=>{try{return h==="base64"?re.fromBase64(u):re.fromHex(u)}catch(m){throw new a(m.message,f)}},!0)]:[]])},"arrayBuffer"),n.extend("lazy",(h,u,f,m)=>(u.inner[t]||(u.inner=u.builder(),u.inner.meta={...u.meta,...u.inner.meta}),n.resolve(h,u.inner,f,m))),n.extend("any",h=>[h]),n.extend("never",(h,u,f)=>{throw new a(`expected nullable but got ${h}`,f)}),n.extend("const",(h,{value:u},f)=>{if(ye(h,u))return[u];throw new a(`expected ${u} but got ${h}`,f)});function p(h,u,f,m,w=!1){const{max:v=1/0,min:E=-1/0}=u;if(h>v)throw new a(`expected ${f} <= ${v} but got ${h}`,m);if(h<E&&!w)throw new a(`expected ${f} >= ${E} but got ${h}`,m)}T(p,"checkWithinRange"),n.extend("string",(h,{meta:u},f)=>{if(typeof h!="string")throw new a(`expected string but got ${h}`,f);if(u.pattern){const m=new RegExp(u.pattern.source,u.pattern.flags);if(!m.test(h))throw new a(`expect string to match regexp ${m}`,f)}return p(h.length,u,"string length",f),[h]});function g(h,u){const f=h.toString();if(f.includes("e"))return h*Math.pow(10,u);const m=f.indexOf(".");if(m===-1)return h*Math.pow(10,u);const w=f.slice(m+1),v=f.slice(0,m);return w.length<=u?+(v+w.padEnd(u,"0")):+(v+w.slice(0,u)+"."+w.slice(u))}T(g,"decimalShift");function y(h,u,f){if(f=Math.abs(f),!/^\d+\.\d+$/.test(f.toString()))return(h-u)%f===0;const m=f.toString().indexOf("."),w=f.toString().slice(m+1).length;return Math.abs(g(h,w)-g(u,w))%g(f,w)===0}T(y,"isMultipleOf"),n.extend("number",(h,{meta:u},f)=>{if(typeof h!="number")throw new a(`expected number but got ${h}`,f);p(h,u,"number",f);const{step:m}=u;if(m&&!y(h,u.min??0,m))throw new a(`expected number multiple of ${m} but got ${h}`,f);return[h]}),n.extend("boolean",(h,u,f)=>{if(typeof h=="boolean")return[h];throw new a(`expected boolean but got ${h}`,f)}),n.extend("bitset",(h,{bits:u,meta:f},m)=>{let w=0,v=[];if(typeof h=="number"){w=h;for(const E in u)h&u[E]&&v.push(E)}else if(Array.isArray(h)){v=h;for(const E of v){if(typeof E!="string")throw new a(`expected string but got ${E}`,m);E in u&&(w|=u[E])}}else throw new a(`expected number or array but got ${h}`,m);return w===f.default?[w]:[w,v]}),n.extend("function",(h,u,f)=>{if(typeof h=="function")return[h];throw new a(`expected function but got ${h}`,f)}),n.extend("is",(h,{constructor:u},f)=>{if(typeof u=="function"){if(h instanceof u)return[h];throw new a(`expected ${u.name} but got ${h}`,f)}else{if(M(h))throw new a(`expected ${u} but got ${h}`,f);let m=Object.getPrototypeOf(h);for(;m;){if(m.constructor?.name===u)return[h];m=Object.getPrototypeOf(m)}throw new a(`expected ${u} but got ${h}`,f)}});function b(h,u,f,m){try{const[w,v]=n.resolve(h[u],f,{...m,path:[...m.path||[],u]});return v!==void 0&&(h[u]=v),w}catch(w){if(!m?.autofix)throw w;return delete h[u],f.meta.default}}T(b,"property"),n.extend("array",(h,{inner:u,meta:f},m)=>{if(!Array.isArray(h))throw new a(`expected array but got ${h}`,m);return p(h.length,f,"array length",m,!M(u.meta.default)),[h.map((w,v)=>b(h,v,u,m))]}),n.extend("dict",(h,{inner:u,sKey:f},m,w)=>{if(!ct(h))throw new a(`expected object but got ${h}`,m);const v={};for(const E in h){let R;try{R=n.resolve(E,f,m)[0]}catch(ee){if(w)continue;throw ee}v[R]=b(h,E,u,m),h[R]=h[E],E!==R&&delete h[E]}return[v]}),n.extend("tuple",(h,{list:u},f,m)=>{if(!Array.isArray(h))throw new a(`expected array but got ${h}`,f);const w=u.map((v,E)=>b(h,E,v,f));return m?[w]:(w.push(...h.slice(u.length)),[w])});function k(h,u){for(const f in u)f in h||(h[f]=u[f])}T(k,"merge"),n.extend("object",(h,{dict:u},f,m)=>{if(!ct(h))throw new a(`expected object but got ${h}`,f);const w={};for(const v in u){const E=b(h,v,u[v],f);(!M(E)||v in h)&&(w[v]=E)}return m||k(w,h),[w]}),n.extend("union",(h,{list:u,toString:f},m,w)=>{for(const v of u)try{return n.resolve(h,v,m,w)}catch{}throw new a(`expected ${f()} but got ${JSON.stringify(h)}`,m)}),n.extend("intersect",(h,{list:u,toString:f},m,w)=>{if(!u.length)return[h];let v;for(const E of u){const R=n.resolve(h,E,m,!0)[0];if(!M(R))if(M(v))v=R;else{if(typeof v!=typeof R)throw new a(`expected ${f()} but got ${JSON.stringify(h)}`,m);if(typeof R=="object")k(v??={},R);else if(v!==R)throw new a(`expected ${f()} but got ${JSON.stringify(h)}`,m)}}return!w&&ct(h)&&k(v,h),[v]}),n.extend("transform",(h,{inner:u,callback:f,preserve:m},w)=>{const[v,E=h]=n.resolve(h,u,w,!0);return m?[f(v)]:[f(v),f(E)]});var O={};function A(h,u,f){O[h]=f,Object.assign(n,{[h](...m){const w=new n({type:h});return u.forEach((v,E)=>{switch(v){case"sKey":w.sKey=m[E]??n.string();break;case"inner":w.inner=n.from(m[E]);break;case"list":w.list=m[E].map(n.from);break;case"dict":w.dict=de(m[E],n.from);break;case"bits":{w.bits={};for(const R in m[E])typeof m[E][R]=="number"&&(w.bits[R]=m[E][R]);break}case"callback":{const R=w.callback=m[E];R.toJSON||=()=>R.toString();break}case"constructor":{const R=w.constructor=m[E];typeof R=="function"&&(R.toJSON||=()=>R.name);break}default:w[v]=m[E]}}),h==="object"||h==="dict"?w.meta.default={}:h==="array"||h==="tuple"?w.meta.default=[]:h==="bitset"&&(w.meta.default=0),w}})}T(A,"defineMethod"),A("is",["constructor"],({constructor:h})=>typeof h=="function"?h.name:h),A("any",[],()=>"any"),A("never",[],()=>"never"),A("const",["value"],({value:h})=>typeof h=="string"?JSON.stringify(h):h),A("string",[],()=>"string"),A("number",[],()=>"number"),A("boolean",[],()=>"boolean"),A("bitset",["bits"],()=>"bitset"),A("function",[],()=>"function"),A("array",["inner"],({inner:h})=>`${h.toString(!0)}[]`),A("dict",["inner","sKey"],({inner:h,sKey:u})=>`{ [key: ${u.toString()}]: ${h.toString()} }`),A("tuple",["list"],({list:h})=>`[${h.map(u=>u.toString()).join(", ")}]`),A("object",["dict"],({dict:h})=>Object.keys(h).length===0?"{}":`{ ${Object.entries(h).map(([u,f])=>`${u}${f.meta.required?"":"?"}: ${f.toString()}`).join(", ")} }`),A("union",["list"],({list:h},u)=>{const f=h.map(({toString:m})=>m()).join(" | ");return u?`(${f})`:f}),A("intersect",["list"],({list:h})=>`${h.map(u=>u.toString(!0)).join(" & ")}`),A("transform",["inner","callback","preserve"],({inner:h},u)=>h.toString(u)),e.exports=n}});const Ft=Ga();/**
 * @inpageedit/logger
 *
 * Flexible, Extensible Console Logger with Colored Labels and Hierarchical Loggers
 *
 * @author dragon-fish <dragon-fish@qq.com>
 * @license MIT
 */var Js=(s=>(s[s.debug=-1]="debug",s[s.log=0]="log",s[s.info=1]="info",s[s.warn=2]="warn",s[s.error=3]="error",s[s.silent=4]="silent",s))(Js||{});const Ht=globalThis||window,Wt=Symbol.for("__IPE_LOGGER_COLOR_MAP__");Ht[Wt]||(Ht[Wt]=new Map);const Tt=Ht[Wt];function nt(s){let e=2166136261;for(let t=0;t<s.length;t++)e^=s.charCodeAt(t),e=(e>>>0)*16777619;return e>>>0}const xs=[[350,360],[0,15],[15,30],[200,230],[230,250],[250,280],[280,310],[310,330],[140,160],[160,180]];function Ka(s,e){const t=xs.length,i=nt(s)%t,[a,n]=xs[i],r=n-a,o=nt(s+":"+e),c=a+o%(r||1),l=nt(s+":s"),d=nt(s+":l");let p,g;if(e==="name")p=62+l%18,g=30+d%12;else{const y=c>=0&&c<50||c>330&&c<360,b=c>=200&&c<=300;p=55+l%20,b?g=55+d%8:y?g=48+d%6:g=50+d%8,p<60&&(p+=5)}return`hsl(${c}, ${p}%, ${g}%)`}function rt(s,e){if(e)return Tt.set(s,e),e;const t=Tt.get(s);if(t)return t;const i=s.startsWith("name:")?"name":"group",a=Ka(s,i);return Tt.set(s,a),a}/**
 * @inpageedit/logger
 * Flexible, Extensible Console Logger with Colored Labels and Hierarchical Loggers
 *
 * @author dragon-fish <dragon-fish@qq.com>
 * @license MIT
 *
 * @example
 * ```ts
 * const logger = new Logger({ name: 'MyApp', level: LoggerLevel.debug })
 * // normal usage
 * logger.info('Application started')
 * // create sub-logger group
 * const apiLogger = logger.group('API', { color: '#f59e0b' })
 * apiLogger.warn('Deprecated API endpoint used')
 * // define custom level
 * logger.defineLevel('success', { level: LoggerLevel.info, label: '✅', method: 'info' })
 * logger.success('User created successfully')
 * ```
 */let Va=class Zs{constructor(e={}){this._custom=t=>{if(!this._enabled(t.level))return Ss;const[i,a]=this._prefix(t.label);return this._consoleMethod(t.method).bind(console,i,...a)},this._name=e.name,this._nameColor=e.color,this._groupPath=e._groupPath?[...e._groupPath]:[],this._dynamicLevels={...e._dynamicLevels},this._levelRef=e._levelRef??{value:e.level??1},this._name&&rt(`name:${this._name}`,this._nameColor),this._installBuiltinLevels();for(const t of Object.keys(this._dynamicLevels))this._installLevelGetter(t,this._dynamicLevels[t]);return Qa(this)}get level(){return this._levelRef.value}set level(e){this._levelRef.value=e}group(e,t){return e&&rt(`group:${e}`,t?.color),new Zs({name:this._name,color:this._nameColor,_groupPath:[...this._groupPath,e],_dynamicLevels:this._dynamicLevels,_levelRef:this._levelRef})}defineLevel(e,t){this._dynamicLevels[e]={...t},this._installLevelGetter(e,t)}get debug(){return this._method("debug")}get log(){return this._method("log")}get info(){return this._method("info")}get warn(){return this._method("warn")}get error(){return this._method("error")}_installBuiltinLevels(){}_installLevelGetter(e,t){Object.defineProperty(this,e,{configurable:!0,enumerable:!1,get:()=>this._custom(t)})}_method(e){const t=Ya[e];if(!this._enabled(t.level))return Ss;const[i,a]=this._prefix(t.label);return this._consoleMethod(e).bind(console,i,...a)}_consoleMethod(e){return(console[e]||console.log).bind(console)}_enabled(e){return e>=this._levelRef.value&&this._levelRef.value!==4}_prefix(e){const t=[];let i="";if(this._name){const a=rt(`name:${this._name}`,this._nameColor);i+=`%c${this._name}%c`,t.push(`background:${a}; color:#fff; padding:1px 4px; border-radius:2px; font-weight:700;`,Rs)}if(e&&(i+=` ${e}`),this._groupPath.length){const a=this._groupPath.join("/"),n=rt(`group:${a}`);i+=` %c${a}%c`,t.push(`color:${n}; text-decoration: underline;`,Rs)}return[i,t]}};const Ss=()=>{},Rs="color:inherit; background:transparent; text-decoration:none;",Ya={debug:{level:-1,label:"",method:"debug"},log:{level:0,label:"",method:"log"},info:{level:1,label:"[I]",method:"info"},warn:{level:2,label:"[W]",method:"warn"},error:{level:3,label:"[E]",method:"error"}};function Qa(s){const e=function(t,i){return s.group(t,i)};return new Proxy(e,{get(t,i,a){return s[i]},set(t,i,a){return s[i]=a,!0},apply(t,i,a){return s.group(a[0],a[1])},has(t,i){return i in s}})}function Xa(s){return new Va(s)}var J=(s=>(s.BODY_USED="BODY_USED",s.NO_BODY_READER="NO_BODY_READER",s.TIMEOUT="TIMEOUT",s.NETWORK_ERROR="NETWORK_ERROR",s.BODY_NOT_ALLOWED="BODY_NOT_ALLOWED",s.HOOK_CONTEXT_CHANGED="HOOK_CONTEXT_CHANGED",s.ABORTED_BY_HOOK="ABORTED_BY_HOOK",s.INVALID_HOOK_CALLBACK="INVALID_HOOK_CALLBACK",s.UNEXPECTED_HOOK_RETURN="UNEXPECTED_HOOK_RETURN",s))(J||{});let K=class ei extends Error{constructor(e,t,i,a){super(t,a),this.code=e,this.context=i}name="FexiosError";static is(e){return e?.constructor===ei}};class ns extends K{constructor(e,t,i){super(t.statusText,e,void 0,i),this.response=t}name="FexiosResponseError";static is(e){return e?.constructor===ns}}function Ja(s,e=2048){if(!(s instanceof Uint8Array))throw new TypeError("Input must be a Uint8Array");if(s.length===0)return!0;const t=Math.min(Math.max(s.length,256),e),i=s.slice(0,t);if(Za(i))return!1;const a=en(i);if(a.nullByteRatio>.05||a.highByteRatio>.95)return!1;const n=["utf-8","utf-16le","utf-16be","iso-8859-1"];let r=-1,o=!1;for(const c of n)try{const l=new TextDecoder(c,{fatal:!0}).decode(i),d=tn(l);d>r&&(r=d,o=d>.7)}catch{continue}return o}function Za(s){if(s.length<4)return!1;const e=[[137,80,78,71],[255,216,255],[71,73,70],[37,80,68,70],[80,75,3,4],[80,75,5,6],[80,75,7,8],[127,69,76,70],[77,90],[202,254,186,190],[0,0,1,0],[82,73,70,70]];for(const t of e)if(s.length>=t.length){let i=!0;for(let a=0;a<t.length;a++)if(s[a]!==t[a]){i=!1;break}if(i)return!0}return!1}function en(s){let e=0,t=0,i=0;for(const a of s)a===0&&e++,a>127&&t++,(a<32&&a!==9&&a!==10&&a!==13||a===127)&&i++;return{nullByteRatio:e/s.length,highByteRatio:t/s.length,controlCharRatio:i/s.length}}function tn(s){if(s.length===0)return 1;let e=1,t=0;for(let a=0;a<s.length;a++){const n=s[a].charCodeAt(0);n>=32&&n<=126||n===9||n===10||n===13||n===32?t++:n>127&&n<65534?!sn(n)&&!an(n)&&t++:e-=.1}const i=t/s.length;return e*=i,nn(s)&&(e*=1.1),Math.max(0,Math.min(1,e))}function sn(s){return s>=0&&s<=31||s>=127&&s<=159}function an(s){return s>=57344&&s<=63743||s>=983040&&s<=1048573||s>=1048576&&s<=1114109}function nn(s){return[/\b\w+\b/,/[.!?]+\s/,/\s+/,/[a-zA-Z]{3,}/,/[\u4e00-\u9fa5]+/,/\d+/].some(e=>e.test(s))}function ae(s){if(typeof s!="object"||s===null||Object.prototype.toString.call(s)!=="[object Object]")return!1;const e=Object.getPrototypeOf(s);return e===Object.prototype||e===null}const We=(s,...e)=>{const t=a=>{if(Array.isArray(a))return a.slice();if(ae(a)){const n={};for(const r of Reflect.ownKeys(a))n[r]=t(a[r]);return n}return a},i=t(s);for(const a of e)if(a!=null)for(const n of Reflect.ownKeys(a)){const r=a[n];if(typeof r>"u")continue;const o=i[n];ae(o)&&ae(r)?i[n]=We(o,r):i[n]=t(r)}return i};let Fe=class{constructor(s,e,t){this.rawResponse=s,this.data=e,this.ok=s.ok,this.status=s.status,this.statusText=s.statusText,this.headers=s.headers,Object.entries(t||{}).forEach(([i,a])=>{this[i]=a})}ok;status;statusText;headers};async function As(s,e,t){if(s.bodyUsed)throw new K(J.BODY_USED,"Response body has already been used or locked");const i=s.headers.get("content-type")||"",a=Number(s.headers.get("content-length"))||0,n=(o,c)=>c==="json"||o.startsWith("application/json"),r=(o,c,l)=>l==="blob"||o.startsWith("image/")&&!o.startsWith("image/svg")||o.startsWith("video/")||o.startsWith("audio/")||!Ja(c);if((s.status===101||s.status===426||s.headers.get("upgrade"))&&typeof globalThis.WebSocket<"u"){const o=new WebSocket(s.url);return await new Promise((c,l)=>{o.onopen=c,o.onerror=l}),new Fe(s,o,{ok:!0,status:101,statusText:"Switching Protocols"})}else if(i.startsWith("text/event-stream")&&!["text","json"].includes(e||"")&&typeof globalThis.EventSource<"u"){const o=new EventSource(s.url);return await new Promise((c,l)=>{o.onopen=c,o.onerror=l}),new Fe(s,o)}else{if(e==="stream")return new Fe(s,s.body);{const o=s.clone().body?.getReader();if(!o)throw new K(J.NO_BODY_READER,"Failed to get ReadableStream from response body");let c=new Uint8Array;for(;;){const{done:d,value:p}=await o.read();if(d)break;if(p&&(c=new Uint8Array([...c,...p]),t&&a>0)){const g=Math.min(c.length/a,1);t(g,c)}}const l=new Fe(s,void 0);if(e==="arrayBuffer")return l.data=c.buffer,l;if(n(i,e))try{const d=new TextDecoder().decode(c);l.data=JSON.parse(d)}catch{}if(typeof l.data!="string"&&r(i,c,e)?l.data=new Blob([c],{type:s.headers.get("content-type")||void 0}):l.data=new TextDecoder().decode(c),typeof l.data=="string"&&e!=="text"){const d=l.data.trim(),p=d[0],g=d[d.length-1];if(p==="{"&&g==="}"||p==="["&&g==="]")try{l.data=JSON.parse(l.data)}catch{}}if(typeof l.data>"u"&&(l.data=c.length>0?c:void 0),l.ok)return l;throw new ns(`Request failed with status code ${s.status}`,l)}}}var dt;(s=>{s.makeSearchParams=a=>{if(!a)return new URLSearchParams;if(a instanceof URLSearchParams)return a;if(typeof a!="object"||a?.constructor!==Object)throw new TypeError("only plain object is supported");const n=new URLSearchParams,r=(l,d)=>{d!=null&&n.append(l,d)},o=(l,d)=>{d!=null&&n.set(l,d)},c=(l,d)=>{if(d!=null){if(Array.isArray(d)){for(const p of d)r(l,p?.toString());return}if(typeof d=="object"&&d.constructor===Object){for(const[p,g]of Object.entries(d)){if(g==null)continue;const y=p.endsWith("[]"),b=y?p.slice(0,-2):p,k=`${l}[${b}]`;if(y){const O=`${k}[]`;if(Array.isArray(g))for(const A of g)r(O,A?.toString());else typeof g=="object"&&g!==null&&g.constructor===Object?c(`${k}[]`,g):r(O,g?.toString())}else if(Array.isArray(g))for(const O of g)r(k,O?.toString());else typeof g=="object"&&g!==null&&g.constructor===Object?c(k,g):o(k,g?.toString())}return}o(l,d?.toString())}};for(const[l,d]of Object.entries(a))c(l,d);return n},s.makeQueryString=a=>(0,s.makeSearchParams)(a).toString(),s.makeURL=(a,n,r,o)=>{const c=typeof window<"u"&&window.location?.origin||"http://localhost",l=typeof a=="string"?new URL(a,o??c):new URL(a),d=(0,s.toQueryRecord)(l.searchParams),p=(0,s.mergeQueries)(d,n||{}),g=(0,s.makeSearchParams)(p);return l.search=g.toString(),l.hash=r||"",l},s.toQueryRecord=a=>{typeof a=="string"&&(a=(0,s.fromString)(a));const n={},r=c=>{if(!c.includes("["))return{path:[c],forceArray:!1};const l=[c.slice(0,c.indexOf("["))],d=/\[([^\]]*)\]/g;let p,g=!1,y=!1;for(;p=d.exec(c);)p[1]===""?(g=!0,y=!0):(l.push(p[1]),y=!1);return g&&y&&(l[l.length-1]=l[l.length-1]+"[]"),{path:l,forceArray:g}},o=(c,l,d,p)=>{let g=c;for(let y=0;y<l.length;y++){const b=l[y];y===l.length-1?p?g[b]===void 0?g[b]=[d]:Array.isArray(g[b])?g[b].push(d):g[b]=[g[b],d]:g[b]===void 0?g[b]=d:Array.isArray(g[b])?g[b].push(d):g[b]=[g[b],d]:((g[b]===void 0||typeof g[b]!="object"||Array.isArray(g[b]))&&(g[b]={}),g=g[b])}};for(const[c,l]of a.entries()){const{path:d,forceArray:p}=r(String(c));o(n,d,l?.toString(),p)}return n},s.fromString=a=>{const n=a.trim();if(!n)return new URLSearchParams;if(n.startsWith("?"))return new URLSearchParams(n.slice(1));const r=n.indexOf("?");if(r>=0){const o=n.indexOf("#",r+1),c=n.slice(r+1,o>=0?o:void 0);return new URLSearchParams(c)}return new URLSearchParams(n)},s.mergeQueries=(a,...n)=>{const r=e(t(a));for(const o of n)o!=null&&i(r,t(o));return r};function e(a){if(Array.isArray(a))return a.map(e);if(ae(a)){const n={};for(const[r,o]of Object.entries(a))n[r]=e(o);return n}if(a instanceof Map){const n={};for(const[r,o]of a.entries())n[r]=e(o);return n}return a}function t(a){if(!a)return{};if(a instanceof URLSearchParams||a instanceof FormData||a instanceof Map)return(0,s.toQueryRecord)(a);if(typeof a=="string")return(0,s.toQueryRecord)((0,s.fromString)(a));if(ae(a))return a;throw new TypeError(`unsupported type transformation, got: ${Object.prototype.toString.call(a)}`)}function i(a,n){for(const[r,o]of Object.entries(n)){if(o===void 0)continue;if(o===null){delete a[r];continue}const c=a[r];ae(c)&&ae(o)?i(c,o):a[r]=e(o)}}})(dt||(dt={}));const ti=function(s){const e=this.constructor.prototype,t=Reflect.get(e,s,e);function i(...a){return Reflect.apply(t,i,a)}Reflect.setPrototypeOf(i,e);for(const a of Reflect.ownKeys(t)){const n=Reflect.getOwnPropertyDescriptor(t,a);n&&Reflect.defineProperty(i,a,n)}return i};ti.prototype=Object.create(Function.prototype);var ze;(s=>{s.makeHeaders=e=>{if(!e)return new Headers;if(e instanceof Headers)return new Headers(e);const t=new Headers;if(e instanceof Map){for(const[i,a]of e.entries())if(a!=null)if(Array.isArray(a))for(const n of a)n!=null&&t.append(i,String(n));else t.append(i,String(a));return t}if(ae(e)){for(const[i,a]of Object.entries(e))if(a!=null)if(Array.isArray(a))for(const n of a)n!=null&&t.append(i,String(n));else t.append(i,String(a));return t}throw new TypeError("only plain object, Map/ReadonlyMap, or Headers is supported")},s.toHeaderRecord=e=>{if(e instanceof Headers){const t={};return e.forEach((i,a)=>{t[a]=t[a]?[...t[a],i]:[i]}),t}if(e instanceof Map){const t={};for(const[i,a]of e.entries())if(a!=null)if(Array.isArray(a)){const n=a.filter(r=>r!=null).map(r=>String(r));n.length&&(t[i]=(t[i]??[]).concat(n))}else{const n=String(a);t[i]=t[i]?[...t[i],n]:[n]}return t}throw new TypeError(`unsupported type transformation, got: ${Object.prototype.toString.call(e)}`)},s.mergeHeaders=(e,...t)=>{const i=e instanceof Headers?new Headers(e):(0,s.makeHeaders)(e),a=n=>{for(const[r,o]of Object.entries(n))if(o!==void 0){if(o===null){i.delete(r);continue}if(Array.isArray(o)){i.delete(r);for(const c of o)c!=null&&i.append(r,String(c))}else i.set(r,String(o))}};for(const n of t){if(n==null)continue;if(n instanceof Headers){n.forEach((o,c)=>{i.set(c,o)});continue}if(ae(n)){a(n);continue}const r=(0,s.toHeaderRecord)(n);for(const[o,c]of Object.entries(r)){i.delete(o);for(const l of c)i.append(o,l)}}return i}})(ze||(ze={}));let zt=class B extends ti{static FINAL_SYMBOL=Symbol("FEXIOS_FINAL_CONTEXT");static NORMALIZED_SYMBOL=Symbol("FEXIOS_NORMALIZED_QUERY");baseConfigs;static DEFAULT_CONFIGS={baseURL:"",timeout:60*1e3,credentials:"same-origin",headers:{},query:{},responseType:void 0,fetch:globalThis.fetch};hooks=[];static ALL_METHODS=["get","post","put","patch","delete","head","options","trace"];static METHODS_WITHOUT_BODY=["get","head","options","trace"];constructor(e={}){super("request"),this.baseConfigs=We(B.DEFAULT_CONFIGS,e),B.ALL_METHODS.forEach(t=>this.createMethodShortcut(t.toLowerCase()))}async request(e,t){let i=t=t||{};if(typeof e=="string"||e instanceof URL?i.url=e.toString():typeof e=="object"&&(i=We(e,i)),i=await this.emit("beforeInit",i,{shouldAdjustRequestParams:!0,shouldHandleShortCircuitResponse:!0}),i[B.FINAL_SYMBOL])return i;if(B.METHODS_WITHOUT_BODY.includes(i.method?.toLocaleLowerCase())&&i.body)throw new K(J.BODY_NOT_ALLOWED,`Request method "${i.method}" does not allow body`);if(i=await this.emit("beforeRequest",i,{shouldAdjustRequestParams:!0,shouldHandleShortCircuitResponse:!0,preAdjust:!0,requestOptionsOverridesURLSearchParams:!0,preRequestOptionsOverridesURLSearchParams:!0,postRequestOptionsOverridesURLSearchParams:!0}),i[B.FINAL_SYMBOL])return i;let a;const n={};if(typeof i.body<"u"&&i.body!==null&&(i.body instanceof Blob||i.body instanceof FormData||i.body instanceof URLSearchParams?a=i.body:typeof i.body=="object"&&i.body!==null?(a=JSON.stringify(i.body),i.headers=this.mergeHeaders(i.headers,{"Content-Type":"application/json"})):a=i.body),!ze.makeHeaders(t.headers||{}).get("content-type")&&a&&(a instanceof FormData||a instanceof URLSearchParams?n["content-type"]=null:typeof a=="string"&&typeof i.body=="object"?n["content-type"]="application/json":a instanceof Blob&&(n["content-type"]=a.type||"application/octet-stream")),i.body=a,i=await this.emit("afterBodyTransformed",i,{shouldAdjustRequestParams:!0,shouldHandleShortCircuitResponse:!0,preAdjust:!0,postRequestOptionsOverridesURLSearchParams:!0}),i[B.FINAL_SYMBOL])return i;const r=i.abortController||globalThis.AbortController?new AbortController:void 0,o=i.baseURL||this.baseConfigs.baseURL||globalThis.location?.href||"http://localhost",c=new URL(i.url.toString(),o),l=dt.makeURL(c,i.query,c.hash).toString(),d=new Request(l,{method:i.method||"GET",credentials:i.credentials,cache:i.cache,mode:i.mode,headers:ze.mergeHeaders(this.baseConfigs.headers,i.headers||{},n),body:i.body,signal:r?.signal});if(i.rawRequest=d,i=await this.emit("beforeActualFetch",i,{shouldHandleShortCircuitResponse:!0}),i[B.FINAL_SYMBOL])return i;const p=i.timeout||this.baseConfigs.timeout||60*1e3;if(i.url.startsWith("ws"))try{const y=new WebSocket(i.url);return await new Promise((b,k)=>{const O=setTimeout(()=>{k(new K(J.TIMEOUT,`WebSocket connection timed out after ${p}ms`,i))},p);y.onopen=()=>{clearTimeout(O),b()},y.onerror=A=>{clearTimeout(O),k(new K(J.NETWORK_ERROR,"WebSocket connection failed",i))},y.onclose=A=>{A.code!==1e3&&(clearTimeout(O),k(new K(J.NETWORK_ERROR,`WebSocket closed with code ${A.code}`,i)))}}),i.rawResponse=new Response,i.response=new Fe(i.rawResponse,y,{ok:!0,status:101,statusText:"Switching Protocols"}),i.data=y,i.headers=new Headers,this.emit("afterResponse",i)}catch(y){throw y instanceof K?y:new K(J.NETWORK_ERROR,`WebSocket creation failed: ${y}`,i)}let g;try{r&&(g=setTimeout(()=>{r.abort()},p));const y=await(t.fetch||this.baseConfigs.fetch||globalThis.fetch)(i.rawRequest).catch(b=>{throw g&&clearTimeout(g),r?.signal.aborted?new K(J.TIMEOUT,`Request timed out after ${p}ms`,i):new K(J.NETWORK_ERROR,b.message,i)});return g&&clearTimeout(g),i.rawResponse=y,i.response=await As(y,i.responseType,(b,k)=>{t?.onProgress?.(b,k)}),i.data=i.response.data,i.headers=i.response.headers,this.emit("afterResponse",i)}catch(y){throw g&&clearTimeout(g),y}}mergeQueries=dt.mergeQueries;mergeHeaders=ze.mergeHeaders;normalizeContext(e,t={}){const i=e,a=i.baseURL||this.baseConfigs.baseURL||globalThis.location?.href||"http://localhost",n=new URL(a,globalThis.location?.href||"http://localhost"),r=new URL(i.url.toString(),n),o=!!i[B.NORMALIZED_SYMBOL];i.baseURL=n?n.origin:r.origin;let c;o?c=t.requestOptionsOverridesURLSearchParams?this.mergeQueries({},r.search,i.query):this.mergeQueries({},i.query,r.search):(c=t.requestOptionsOverridesURLSearchParams?this.mergeQueries(n?.search||"",this.baseConfigs.query,r.search,i.query):this.mergeQueries(n?.search||"",this.baseConfigs.query,i.query,r.search),i[B.NORMALIZED_SYMBOL]=!0),i.query=c;const l=new URL(r);return l.search="",i.url=l.toString(),i}async emit(e,t,i={}){const a=this.hooks.filter(n=>n.event===e);if(i?.shouldAdjustRequestParams&&i?.preAdjust)try{t=this.normalizeContext(t,{requestOptionsOverridesURLSearchParams:i.preRequestOptionsOverridesURLSearchParams})}catch{}try{let n=0;for(const r of a){const o=`${e}#${r.action.name||`anonymous#${n}`}`,c=Symbol("FEXIOS_HOOK_CONTEXT");t[c]=c;const l=t.url;let d="";try{const g=this.mergeQueries({},t.query||{});d=JSON.stringify(g)}catch{}let p=await r.action.call(this,t);if(p===void 0&&(p=t),p===!1)throw new K(J.ABORTED_BY_HOOK,`Request aborted by hook "${o}"`,t);if(p instanceof Response){const g=p,y={...t,rawResponse:g},b=await As(g,t.responseType,(k,O)=>{t.onProgress?.(k,O)});if(y.response=b,y.data=b.data,y.headers=b.headers,e!=="afterResponse"){const k=await this.emit("afterResponse",y);return k[B.FINAL_SYMBOL]=!0,k}else return y[B.FINAL_SYMBOL]=!0,y}else if(typeof p=="object"&&p[c]===c)t=p;else{const g=globalThis["".concat("console")];try{throw new K(J.HOOK_CONTEXT_CHANGED,`Hook "${o}" should return the original FexiosContext or return false to abort the request, but got "${p}".`)}catch(y){g.warn(y.stack||y)}}if(i?.shouldAdjustRequestParams)try{const g=t.baseURL||this.baseConfigs.baseURL||globalThis.location?.href||"http://localhost",y=new URL(t.url.toString(),g);let b={};if(d)try{b=JSON.parse(d)}catch{}const k=t.query||{},O=this.mergeQueries(b,y.search,k);t.query=O;const A=new URL(y);A.search="",t.url=A.toString()}catch{}delete t[c],n++}}catch(n){return Promise.reject(n)}return t}on(e,t,i=!1){if(typeof t!="function")throw new K(J.INVALID_HOOK_CALLBACK,`Hook should be a function, but got "${typeof t}"`);return this.hooks[i?"unshift":"push"]({event:e,action:t}),this}off(e,t){return e==="*"||!e?this.hooks=this.hooks.filter(i=>i.action!==t):this.hooks=this.hooks.filter(i=>i.event!==e||i.action!==t),this}createInterceptor(e){return{handlers:()=>this.hooks.filter(t=>t.event===e).map(t=>t.action),use:(t,i=!1)=>this.on(e,t,i),clear:()=>{this.hooks=this.hooks.filter(t=>t.event!==e)}}}interceptors={request:this.createInterceptor("beforeRequest"),response:this.createInterceptor("afterResponse")};createMethodShortcut(e){return Reflect.defineProperty(this,e,{get:()=>(t,i,a)=>(B.METHODS_WITHOUT_BODY.includes(e.toLocaleLowerCase())?a=i:(a=a||{},a.body=i),this.request(t,{...a,method:e}))}),this}extends(e){const t=new B(We(this.baseConfigs,e));return t.hooks=[...this.hooks],t._plugins=new Map(this._plugins),t._plugins.forEach(async i=>{await t.plugin(i)}),t}create=B.create;static create(e){return new B(e)}_plugins=new Map;async plugin(e){if(typeof e?.name=="string"&&typeof e?.install=="function"){if(this._plugins.has(e.name))return this;const t=await e.install(this);if(this._plugins.set(e.name,e),t instanceof B)return t}return this}checkIsPlainObject=ae;mergeQuery=this.mergeQueries};/**
 * Fexios
 * @desc Fetch based HTTP client with similar API to axios for browser and Node.js
 *
 * @license MIT
 * @author dragon-fish <dragon-fish@qq.com>
 */const rn=zt.create,Ps=rn();/* v8 ignore else -- @preserve */typeof globalThis<"u"?globalThis.fexios=Ps:typeof window<"u"&&(window.fexios=Ps);var ft;(s=>{function e(i){return Array.isArray(i)?i.join("|"):typeof i=="boolean"||i===null?i?"1":void 0:typeof i=="number"?""+i:i}s.normalizeParamValue=e;function t(i){const a=r=>r&&(r instanceof URLSearchParams||r instanceof FormData);if(i==null)return;const n=new FormData;if(a(i))return i.forEach((r,o)=>{const c=e(r);c!=null&&n.append(o,c)}),n;if(ae(i))return Object.entries(i).forEach(([r,o])=>{const c=e(o);c!=null&&n.append(r,c)}),n}s.normalizeBody=t})(ft||(ft={}));var qe=(s=>(s.HTTP_ERROR="HTTP_ERROR",s.LOGIN_FAILED="LOGIN_FAILED",s.LOGIN_RETRY_LIMIT_EXCEEDED="LOGIN_RETRY_LIMIT_EXCEEDED",s.TOKEN_RETRY_LIMIT_EXCEEDED="TOKEN_RETRY_LIMIT_EXCEEDED",s))(qe||{});class V extends Error{constructor(e,t="",i){super(),this.code=e,this.message=t,this.cause=i,this.name="WikiSaikouError"}static is(e,t){return e instanceof this&&(t===void 0||e.code===t)}}let Te=class si extends Error{constructor(e,t){super(),this.errors=e,this.cause=t,this.name="MediaWikiApiError",this.errors=si.normalizeErrors(e),this.message=e.map(i=>i.text).filter(Boolean).join(`
`),this.code=this.isBadTokenError()?"badtoken":this.errors[0]?.code||"Unknown Error"}get firstError(){return this.errors[0]}isBadTokenError(){return this.errors.some(e=>e.code==="badtoken")||["NeedToken","WrongToken"].includes(this.cause?.data?.login?.result)}toString(){return`[${this.name} ${this.code}]`}static is(e){return e instanceof this}static normalizeErrors(e){return Array.isArray(e)===!1?[]:e.filter(t=>typeof t=="object"&&!!t?.code).map(t=>t.text?t:t.info?{...t,text:t.info}:t["*"]?{...t,text:t["*"]}:{...t,text:""})}};(s=>{function e(n){if(n==null)return;if(n?.response?.data!==void 0)return n.response.data;if(n?.data!==void 0)return n.data;const r=n instanceof Error?n.cause:void 0;return r?.response?.data!==void 0?r.response.data:r?.data!==void 0?r.data:n||void 0}function t(n){return i(n).length>0}s.includesMediaWikiApiError=t,s.normalizeMwApiErrors=Te.normalizeErrors;function i(n){let r=e(n);if(typeof r!="object"||r===null)return[];const o=r?.error,c=r?.errors,l=[];return o&&l.push(o),Array.isArray(c)&&l.push(...c),(0,s.normalizeMwApiErrors)(l)}s.extractMediaWikiApiErrors=i;function a(n){if(Te.is(n))return n.isBadTokenError();{const r=i(n);return new Te(r).isBadTokenError()}}s.isBadTokenError=a})(V||(V={}));const Ts=Symbol.for("__FEXIOS_SAIKOU__");/**
 * FexiosSaikou
 *
 * A pre-configured Fexios instance with MediaWiki-friendly defaults:
 * - MediaWiki-specific request/response params normalization
 * - built-in token management
 * - error handling
 *
 * @author dragon-fish <dragon-fish@qq.com>
 * @license MIT
 *
 * @param {string|URL} payload create a new FexiosSaikou instance with the given baseURL
 * @param {Fexios} payload or make the given Fexios instance a FexiosSaikou instance
 */function ii(s){const e=s instanceof zt?s:new zt({baseURL:s instanceof URL?s.toString():String(s),responseType:"json"});return e[Ts]||(Reflect.defineProperty(e,Ts,{get:()=>!0,enumerable:!1,configurable:!1}),e._tokens=new Map,e.on("afterResponse",t=>{const{data:i,rawRequest:a}=t,n=a?.headers.get("x-mw-token-name");n&&V.isBadTokenError(i)&&e._tokens.delete(n);const r=i?.query?.tokens;r&&typeof r=="object"&&Object.entries(r).forEach(([c,l])=>{typeof l=="string"&&e._tokens.set(c.replace(/token$/i,"").toLowerCase(),l)});const o=i?.login?.token;return typeof o=="string"&&e._tokens.set("login",o),t}),e.on("beforeInit",t=>{if(t.method?.toLowerCase()!=="post")return t;if(t.body===void 0||t.body===null)return t.body=void 0,t;const i=t.body=ft.normalizeBody(t.body),a=new URLSearchParams(t.query);return i.has("format")&&a.delete("format"),i.has("formatversion")&&a.delete("formatversion"),i.has("action")&&a.delete("action"),i.has("origin")&&(a.set("origin",""+i.get("origin")),i.delete("origin")),t.query=Object.fromEntries(a.entries()),t}),e.on("beforeInit",t=>(t.query=ft.normalizeBody(t.query)||{},t)),e.on("beforeRequest",t=>{const i=new URL(t.url),a=i.searchParams;if(globalThis.location&&(!a.has("origin")&&location.origin!==i.origin?(a.set("origin",location.origin),e.baseConfigs.credentials="include",e.baseConfigs.mode="cors"):location.origin===i.origin&&(a.delete("origin"),e.baseConfigs.credentials=void 0,e.baseConfigs.mode=void 0)),i.searchParams.has("origin")){const n=encodeURIComponent(i.searchParams.get("origin")||"").replace(/\./g,"%2E");t.query={},i.searchParams.delete("origin"),t.url=`${i}${i.search?"&":"?"}origin=${n}`}return t})),e}const ge=(s,...e)=>{const t=n=>Object.prototype.toString.call(n)==="[object Object]",i=n=>{if(Array.isArray(n))return n.slice();if(t(n)){const r={};for(const o of Reflect.ownKeys(n))r[o]=i(n[o]);return r}return n},a=i(s);for(const n of e)if(n!=null)for(const r of Reflect.ownKeys(n)){const o=n[r];if(typeof o>"u")continue;const c=a[r];t(c)&&t(o)?a[r]=ge(c,o):a[r]=i(o)}return a},on=(s,e,t)=>{let i={...ai.DEFAULT_CONFIGS};if(typeof s=="string"?i=ge(i,{baseURL:s,fexiosConfigs:e||{},defaultParams:t||{}}):typeof s=="object"&&s!==null&&(i=ge(i,s)),!i.baseURL&&typeof window=="object"&&window.mediaWiki){const{wgServer:a,wgScriptPath:n}=window.mediaWiki?.config?.get(["wgServer","wgScriptPath"])||{};typeof a=="string"&&typeof n=="string"&&(i.baseURL=`${a}${n}/api.php`)}if(typeof i.baseURL!="string")throw new Error("baseURL is required");return i},ln=()=>{},cn=async(s,e)=>{let t=0;const{retry:i=3,onRetry:a=ln,shouldRetry:n=()=>!0}=e;let r;do try{return await s()}catch(o){if(r=o,n(o,t))a(o,t),t++;else throw o}while(t<i);throw r||new Error("Retry failed")};/**
 * WikiSaikou Core class
 * @internal You **SHOULD NOT** use this class directly, instead, use the `MediaWikiApi` class.
 * @author dragon-fish <dragon-fish@qq.com>
 * @license MIT
 */const He=class{constructor(s,e,t){this.version="7.1.2",this.token=this.getToken;const i=this.config=on(s,e,t);this.request=ii(i.baseURL)}setBaseURL(s){return this.config.baseURL=s,this.request.baseConfigs.baseURL=s,this}async get(s,e){return this.runRequestWithApiErrorMapping(()=>this.request.get("",ge({},this.config.fexiosConfigs,{query:ge(this.config.defaultParams,s)},e)))}async post(s,e){return this.runRequestWithApiErrorMapping(()=>this.request.post("",s,ge({},this.config.fexiosConfigs,{query:this.config.defaultParams},e)))}async runRequestWithApiErrorMapping(s){try{const e=await s();return this.handleApiResponse(e)}catch(e){throw this.config.throwOnApiError&&V.includesMediaWikiApiError(e)?new Te(V.extractMediaWikiApiErrors(e),e):e}}throwIfApiError(s){const e=V.extractMediaWikiApiErrors(s);if(e.length>0)throw new Te(e,s)}handleApiResponse(s){return this.config.throwOnApiError&&this.throwIfApiError(s.data),s}get tokens(){return this.request._tokens}async fetchTokens(s=["csrf"]){return this.config.fexiosConfigs.credentials="include",await this.get({action:"query",meta:"tokens",type:s}),this.tokens}async getToken(s="csrf",e=!1){return(!this.tokens.get(s)||e)&&(this.tokens.delete(s),await this.fetchTokens([s])),this.tokens.get(s)}badToken(s){return this.tokens.delete(s),this.tokens}async postWithToken(s,e,t){const{tokenName:i="token",retry:a=3,noCache:n=!1,fexiosOptions:r}=t||{};if(a<1)throw new V(qe.TOKEN_RETRY_LIMIT_EXCEEDED,"The limit of the number of times to automatically re-acquire the token has been exceeded");let o=0;return cn(async()=>{const c=await this.getToken(s,n||o>0);try{const l=await this.post({[i]:c,...e},ge(r||{},{headers:{"x-mw-token-name":s}}));if(V.isBadTokenError(l.data))throw l;return l}catch(l){throw V.isBadTokenError(l)||l?.ok===!1||Te.is(l)?l:new V(qe.HTTP_ERROR,"Network/transport or SDK-internal error (not a MediaWiki API error)",l)}},{retry:a,onRetry:(c,l)=>{o=l+1},shouldRetry:c=>V.isBadTokenError(c)||c?.ok===!1}).catch(c=>{throw V.isBadTokenError(c)||c?.ok===!1?new V(qe.TOKEN_RETRY_LIMIT_EXCEEDED,"Retry attempts for acquiring/using token exhausted",c):c})}postWithEditToken(s){return this.postWithToken("csrf",s)}get baseURL(){return this.config.baseURL}get defaultParams(){return this.config.defaultParams}get defaultOptions(){return this.config.fexiosConfigs}};He.INIT_DEFAULT_PARAMS={action:"query",errorformat:"plaintext",format:"json",formatversion:2},He.DEFAULT_CONFIGS={baseURL:void 0,fexiosConfigs:{responseType:"json"},defaultParams:He.INIT_DEFAULT_PARAMS,throwOnApiError:!1},He.createRequestHandler=ii;let ai=He;/**
 * WikiSaikou
 * @description Standalone MediaWiki API SDK with `mw.Api`-like API in any environments
 * @author Dragon-Fish <dragon-fish@qq.com>
 * @license MIT
 */let un=class extends ai{async clientLogin(s,e,t){t||={},!t.logincontinue&&!t.loginreturnurl&&(t.loginreturnurl=location?.origin);const i=await this.postWithToken("login",{action:"clientlogin",username:s,password:e,...t},{tokenName:"logintoken"});if(i?.data?.clientlogin?.status==="PASS")return i.data.clientlogin;throw new V(qe.LOGIN_FAILED,i.data.clientlogin.message,i)}};class hn{constructor(e,t={}){this.ctx=e,location?.href&&t?.baseURL?.toString()?.startsWith("/")&&(t.baseURL=new URL(t.baseURL,location.origin));const i=new un({baseURL:t.baseURL.toString(),fexiosConfigs:{headers:{"x-api-user-agent":`InPageEdit-NEXT ${e.version}`,...t.headers},...t},throwOnApiError:!0});e.set("api",i)}}var dn=Object.create,rs=Object.defineProperty,fn=Object.getOwnPropertyDescriptor,ni=(s,e)=>(e=Symbol[s])?e:Symbol.for("Symbol."+s),ri=s=>{throw TypeError(s)},pn=(s,e,t)=>e in s?rs(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,mn=(s,e)=>rs(s,"name",{value:e,configurable:!0}),gn=s=>[,,,dn(s?.[ni("metadata")]??null)],yn=["class","method","getter","setter","accessor","field","value","get","set"],oi=s=>s!==void 0&&typeof s!="function"?ri("Function expected"):s,wn=(s,e,t,i,a)=>({kind:yn[s],name:e,metadata:i,addInitializer:n=>t._?ri("Already initialized"):a.push(oi(n||null))}),bn=(s,e)=>pn(e,ni("metadata"),s[3]),vn=(s,e,t,i)=>{for(var a=0,n=s[e>>1],r=n&&n.length;a<r;a++)n[a].call(t);return i},_n=(s,e,t,i,a,n)=>{var r,o,c,l=e&7,d=!1,p=0,g=s[p]||(s[p]=[]),y=l&&(a=a.prototype,l<5&&(l>3||!d)&&fn(a,t));mn(a,t);for(var b=i.length-1;b>=0;b--)c=wn(l,t,o={},s[3],g),r=(0,i[b])(a,c),o._=1,oi(r)&&(a=r);return bn(s,a),y&&rs(a,t,y),d?l^4?n:y:a},li,os,ci;li=[ve(["wiki","wikiTitle"])];class pt extends(ci=Ee){constructor(e){super(e,"currentPage",!1),this.ctx=e,this.url=new URL(window.location.href),this.isMainPage=void 0,this.wikiTitle=void 0}get logger(){return this.ctx.logger("CURRENT_PAGE")}async start(){await this.#t(),this.#e(),window.addEventListener("popstate",this.#s.bind(this)),this.logger.info("initialized",this.wikiTitle)}stop(){window.removeEventListener("popstate",this.#s.bind(this))}async#t(){await this.#i(),await this.#n()}#e(){const e=Symbol.for("InPageEdit.CurrentPageService.UrlChangeListenerInstalled");if(window[e])return;const t=history.pushState,i=history.replaceState;history.pushState=function(a,n,r){t.apply(this,[a,n,r]),window.dispatchEvent(new PopStateEvent("popstate",{state:a}))},history.replaceState=function(a,n,r){i.apply(this,[a,n,r]),window.dispatchEvent(new PopStateEvent("popstate",{state:a}))},window[e]=!0}async#s(e){const t=this.url,i=new URL(window.location.href);this.url=i,(t.pathname!==i.pathname||t.searchParams.get("title")!==i.searchParams.get("title")||t.searchParams.get("curid")!==i.searchParams.get("curid"))&&(await this.#t(),this.logger.info("location changed",i,this.wikiTitle))}get params(){return this.url.searchParams}get canonicalUrl(){const e=document.querySelector('link[rel="canonical"]')?.href;let t=null;return e&&(t=new URL(e,location.origin)),Reflect.defineProperty(this,"canonicalUrl",{get:()=>t}),t}async#n(){const e=this.wikiTitle?.getMainDBKey()===this.ctx.wiki.mainPageName;return Reflect.defineProperty(this,"isMainPage",{get:()=>e}),e}async#i(){let e=null;return this.canonicalUrl?e=await this.ctx.wikiTitle.newTitleFromUrl(this.canonicalUrl):e=await this.ctx.wikiTitle.newTitleFromUrl(this.url),Object.freeze(e),Reflect.defineProperty(this,"wikiTitle",{get:()=>e}),e}get wikiAction(){return this.params.get("action")||"view"}}os=gn(ci);pt=_n(os,0,"CurrentPageService",li,pt);vn(os,1,pt);class En extends Ee{constructor(e){super(e,"resourceLoader",!0),this.ctx=e}stop(){}loadScript(e,t){if(!e)return Promise.resolve(null);const i=`script:${e}`,a=document.querySelector(`[data-ipe="${i}"]`);return a?Promise.resolve(a):new Promise((n,r)=>{const o=document.createElement("script");o.src=e,o.dataset.ipe=i,t&&Object.entries(t).forEach(([c,l])=>{typeof l>"u"||l===!1||l===null?o.removeAttribute(c):o.setAttribute(c,l)}),document.body.appendChild(o),o.onload=()=>n(o),o.onerror=c=>r(c)})}loadStyle(e,t){if(!e)return Promise.resolve(null);const i=`style:${e}`,a=document.querySelector(`[data-ipe="${i}"]`);return a?Promise.resolve(a):new Promise((n,r)=>{const o=document.createElement("link");o.rel="stylesheet",o.href=e,o.dataset.ipe=i,t&&Object.entries(t).forEach(([c,l])=>{typeof l>"u"||l===!1||l===null?o.removeAttribute(c):o.setAttribute(c,l)}),(document.querySelector('meta[name="ipe-styles"]')||(()=>{const c=document.createElement("meta");return c.id="ipe-styles",c.name="ipe-styles",document.head.insertAdjacentElement("afterbegin",c),c})()).before(o),o.onload=()=>n(o),o.onerror=c=>r(c)})}resolveImportPath(e){return e.startsWith("http")||e.startsWith("//")?e:import.meta.resolve(e)}}const St=Object.keys;function kn(s){return typeof s=="boolean"}function xn(s){return s&&typeof s.nodeType=="number"}function ls(s){return typeof s=="string"}function ui(s){return typeof s=="number"}function _e(s){return typeof s=="object"?s!==null:Je(s)}function Je(s){return typeof s=="function"}function Sn(s){return!!(s&&s.isComponent)}function Rn(s){return _e(s)&&typeof s.length=="number"&&typeof s.nodeType!="number"}function qt(s,e){if(s)for(const t of St(s))e(s[t],t)}function An(s){return _e(s)&&"current"in s}const Gt={animationIterationCount:0,borderImageOutset:0,borderImageSlice:0,borderImageWidth:0,boxFlex:0,boxFlexGroup:0,boxOrdinalGroup:0,columnCount:0,columns:0,flex:0,flexGrow:0,flexPositive:0,flexShrink:0,flexNegative:0,flexOrder:0,gridArea:0,gridRow:0,gridRowEnd:0,gridRowSpan:0,gridRowStart:0,gridColumn:0,gridColumnEnd:0,gridColumnSpan:0,gridColumnStart:0,fontWeight:0,lineClamp:0,lineHeight:0,opacity:0,order:0,orphans:0,tabSize:0,widows:0,zIndex:0,zoom:0,fillOpacity:0,floodOpacity:0,stopOpacity:0,strokeDasharray:0,strokeDashoffset:0,strokeMiterlimit:0,strokeOpacity:0,strokeWidth:0};function Pn(s,e){return s+e.charAt(0).toUpperCase()+e.substring(1)}const Tn=["Webkit","ms","Moz","O"];St(Gt).forEach(s=>{Tn.forEach(e=>{Gt[Pn(e,s)]=0})});const On=Symbol.for("jsx-dom:type");var hi=function(s){return s.ShadowRoot="ShadowRoot",s}(hi||{});function Cn(s){return s!=null&&s[On]===hi.ShadowRoot}const Ln="http://www.w3.org/2000/svg",In="http://www.w3.org/1999/xlink",Mn="http://www.w3.org/XML/1998/namespace";function di(s){return!kn(s)&&s!=null}function Kt(s){return Array.isArray(s)?s.map(Kt).filter(Boolean).join(" "):_e(s)?Symbol.iterator in s?Kt(Array.from(s)):St(s).filter(e=>s[e]).join(" "):di(s)?""+s:""}const Nn={animate:0,circle:0,clipPath:0,defs:0,desc:0,ellipse:0,feBlend:0,feColorMatrix:0,feComponentTransfer:0,feComposite:0,feConvolveMatrix:0,feDiffuseLighting:0,feDisplacementMap:0,feDistantLight:0,feFlood:0,feFuncA:0,feFuncB:0,feFuncG:0,feFuncR:0,feGaussianBlur:0,feImage:0,feMerge:0,feMergeNode:0,feMorphology:0,feOffset:0,fePointLight:0,feSpecularLighting:0,feSpotLight:0,feTile:0,feTurbulence:0,filter:0,foreignObject:0,g:0,image:0,line:0,linearGradient:0,marker:0,mask:0,metadata:0,path:0,pattern:0,polygon:0,polyline:0,radialGradient:0,rect:0,stop:0,svg:0,switch:0,symbol:0,text:0,textPath:0,tspan:0,use:0,view:0},$n=/^(a(ll|t|u)|base[FP]|c(al|lipPathU|on)|di|ed|ex|filter[RU]|g(lyphR|r)|ke|l(en|im)|ma(rker[HUW]|s)|n|pat|pr|point[^e]|re[^n]|s[puy]|st[^or]|ta|textL|vi|xC|y|z)/;function Un(s){const e=document.createDocumentFragment();return Rt(s.children,e),e}function Dn(s,e,t){e={...e,children:t};const i=new s(e),a=i.render();return"ref"in e&&cs(e.ref,i),a}function C(s,e){let{children:t,...i}=e;!i.namespaceURI&&Nn[s]===0&&(i={...i,namespaceURI:Ln});let a;if(ls(s)){if(a=i.namespaceURI?document.createElementNS(i.namespaceURI,s):document.createElement(s),Fn(i,a),Rt(t,a),a instanceof window.HTMLSelectElement&&i.value!=null)if(i.multiple===!0&&Array.isArray(i.value)){const n=i.value.map(r=>String(r));a.querySelectorAll("option").forEach(r=>r.selected=n.includes(r.value))}else a.value=i.value;cs(i.ref,a)}else if(Je(s))_e(s.defaultProps)&&(i={...s.defaultProps,...i}),a=Sn(s)?Dn(s,i,t):s({...i,children:t});else throw new TypeError(`Invalid JSX element type: ${s}`);return a}function cs(s,e){An(s)?s.current=e:Je(s)&&s(e)}function Rt(s,e){if(Rn(s))jn(s,e);else if(ls(s)||ui(s))Ot(document.createTextNode(s),e);else if(s===null)Ot(document.createComment(""),e);else if(xn(s))Ot(s,e);else if(Cn(s)){const t=e.attachShadow(s.attr);Rt(s.children,t),cs(s.ref,t)}}function jn(s,e){for(const t of[...s])Rt(t,e);return e}function Ot(s,e){e instanceof window.HTMLTemplateElement?e.content.appendChild(s):e.appendChild(s)}function ot(s,e){return s.replace(/[A-Z]/g,t=>e+t.toLowerCase())}function fi(s,e){e==null||e===!1||(Array.isArray(e)?e.forEach(t=>fi(s,t)):ls(e)?s.setAttribute("style",e):_e(e)&&qt(e,(t,i)=>{i.indexOf("-")===0?s.style.setProperty(i,t):ui(t)&&Gt[i]!==0?s.style[i]=t+"px":s.style[i]=t}))}function Bn(s,e,t){switch(s){case"xlinkActuate":case"xlinkArcrole":case"xlinkHref":case"xlinkRole":case"xlinkShow":case"xlinkTitle":case"xlinkType":Os(t,In,ot(s,":"),e);return;case"xmlnsXlink":xe(t,ot(s,":"),e);return;case"xmlBase":case"xmlLang":case"xmlSpace":Os(t,Mn,ot(s,":"),e);return}switch(s){case"htmlFor":xe(t,"for",e);return;case"dataset":qt(e,(i,a)=>{i!=null&&(t.dataset[a]=i)});return;case"innerHTML":case"innerText":case"textContent":di(e)&&(t[s]=e);return;case"dangerouslySetInnerHTML":_e(e)&&(t.innerHTML=e.__html);return;case"value":if(e==null||t instanceof window.HTMLSelectElement)return;if(t instanceof window.HTMLTextAreaElement){t.value=e;return}break;case"spellCheck":t.spellcheck=e;return;case"class":case"className":Je(e)?e(t):xe(t,"class",Kt(e));return;case"ref":case"namespaceURI":return;case"style":fi(t,e);return;case"on":case"onCapture":qt(e,(i,a)=>{t.addEventListener(a,i,s==="onCapture")});return}if(Je(e)){if(s[0]==="o"&&s[1]==="n"){let i=s.toLowerCase();const a=i.endsWith("capture");if(i==="ondoubleclick"?i="ondblclick":a&&i==="ondoubleclickcapture"&&(i="ondblclickcapture"),!a&&t[i]===null)t[i]=e;else if(a)t.addEventListener(i.substring(2,i.length-7),e,!0);else{let n;i in window?n=i.substring(2):n=i[2]+s.slice(3),t.addEventListener(n,e)}}}else _e(e)?t[s]=e:e===!0?xe(t,s,""):e!==!1&&e!=null&&(t instanceof SVGElement&&!$n.test(s)?xe(t,ot(s,"-"),e):xe(t,s,e))}function xe(s,e,t){s.setAttribute(e,t)}function Os(s,e,t,i){s.setAttributeNS(e,t,i)}function Fn(s,e){for(const t of St(s))Bn(t,s[t],e);return e}var us=(s=>(s.Init="modal.init",s.BeforeShow="modal.beforeShow",s.Show="modal.show",s.BeforeClose="modal.beforeClose",s.Close="modal.close",s.Destroy="modal.destroy",s.ToastShow="toast.show",s.ToastClose="toast.close",s))(us||{});let Hn=0;const Cs=s=>`${s}-${++Hn}`;function je(s){return s instanceof Node?s:document.createTextNode(String(s))}function he(s,e){if(!s)throw new Error(`${e??"Element"} not found`);return s}function Ls(s){const e=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(",");return Array.from(s.querySelectorAll(e)).filter(t=>!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length))}function H(s,e={}){const t=document.createElement(s);if(e.className&&(t.className=e.className),e.html!=null&&(t.innerHTML=e.html),e.text!=null&&(t.textContent=e.text),e.attrs)for(const[i,a]of Object.entries(e.attrs))t.setAttribute(i,a);return t}const Wn=typeof navigator<"u"&&/Mac|iPhone|iPad|iPod/i.test(navigator.platform),pi=["ctrl","alt","shift","meta"];function zn(s){if(!s)return null;const e=String(s).trim().toLowerCase().split(/[+\-\s]+/g).filter(Boolean),t=[];let i=null;const a=r=>{t.includes(r)||t.push(r)};for(const r of e){let o=r;if(o==="control"||o==="ctrl"){a("ctrl");continue}if(o==="alt"||o==="option"){a("alt");continue}if(o==="shift"){a("shift");continue}if(o==="meta"||o==="cmd"||o==="command"||o==="super"){a("meta");continue}if(o==="mod"){a(Wn?"meta":"ctrl");continue}o==="esc"&&(o="escape"),o==="return"&&(o="enter"),(o==="space"||o==="spacebar")&&(o="space"),i=o}const n=pi.filter(r=>t.includes(r));return!i||i===""?n.length?n.join("+"):null:n.length?`${n.join("+")}+${i}`:i}function qn(s){const e=[];s.ctrlKey&&e.push("ctrl"),s.altKey&&e.push("alt"),s.shiftKey&&e.push("shift"),s.metaKey&&e.push("meta");let t=s.key;t===" "&&(t="space");const i=(t.length,t.toLowerCase()),a=pi.filter(n=>e.includes(n));return a.length?`${a.join("+")}+${i}`:i}class Gn{constructor(){this.zBase=1e3,this.stack=[]}push(e){this.stack.push(e),this.syncZ()}remove(e){this.stack=this.stack.filter(t=>t!==e),this.syncZ()}top(){return this.stack[this.stack.length-1]}closeAll(e,t){const i=new Set((Array.isArray(t)?t:t?[t]:[]).map(String)),a=new Set((Array.isArray(e)?e:e?[e]:[]).map(String));[...this.stack].reverse().forEach(n=>{const r=n.modalId,o=a.size?a.has(n.pluginName):!0,c=i.has(r);o&&!c&&n.close()})}removeAll(){[...this.stack].forEach(e=>e.destroy()),this.stack=[]}syncZ(){this.stack.forEach((e,t)=>e.setZIndex(this.zBase+t*2))}lockBodyScroll(){document.body.classList.add("ipe-modal-no-scroll")}unlockBodyScroll(){document.body.classList.remove("ipe-modal-no-scroll")}}const G=new Gn;class hs{constructor(e={}){this.backdropId=Cs("ipe-modal-backdrop"),this.modalId=Cs("ipe-modal"),this.numberId=this.modalId.split("-")[1],this._isDestroyed=!1,this.pluginName="normalModal",this.buttonElsLeft=[],this.buttonElsRight=[],this.keyMap=new Map,this.isOpen=!1,this.isToast=!1,this.isDragging=!1,this.dragStartX=0,this.dragStartY=0,this.modalStartX=0,this.modalStartY=0,this.Event=us,this.DEFAULT_OPTIONS={className:"",sizeClass:"auto",center:!0,fitScreen:!1,closeIcon:!0,bodyScroll:!1,outSideClose:!0,backdrop:!0,animation:!1,animationSpeed:200},this._hooks=[],this.startCloseTimer=t=>{this.stopCloseTimer(),this.closeTimer=window.setTimeout(()=>this.close(),t)},this.stopCloseTimer=()=>{this.closeTimer&&window.clearTimeout(this.closeTimer),this.closeTimer=void 0},this.onDragMove=t=>{if(!this.isDragging)return;t.preventDefault();const i=t.clientX-this.dragStartX,a=t.clientY-this.dragStartY,n=this.get$modal(),r=this.modalStartX+i,o=this.modalStartY+a;n.style.left=`${r}px`,n.style.top=`${o}px`},this.onDragEnd=()=>{if(!this.isDragging)return;this.isDragging=!1,document.removeEventListener("pointermove",this.onDragMove),document.removeEventListener("pointerup",this.onDragEnd);const t=this.get$modal(),i=this.get$window();t.classList.remove("is-dragging"),i.style.animation="none",requestAnimationFrame(()=>{this.applyAnimation(!0)})},this.options={...this.DEFAULT_OPTIONS,...e},this.options.backdrop===!1&&e.bodyScroll===void 0&&(this.options.bodyScroll=!0)}get isDestroyed(){return this._isDestroyed}init(){if(this.$modal)return this;const e=this.options.backdrop!==!1;let t;e&&(t=H("div",{className:"ipe-modal-backdrop",attrs:{id:this.backdropId,"data-modal-id":this.modalId}}));const i=H("div",{className:"ipe-modal-modal",attrs:{id:this.modalId,role:"dialog","aria-modal":"true",tabindex:"-1"}});if(i.modal=this,!e){i.classList.add("no-backdrop");const y=window.pageYOffset||document.documentElement.scrollTop,b=window.pageXOffset||document.documentElement.scrollLeft,k=window.innerWidth;i.style.top=`${y+60}px`,this.once("modal.show",()=>{i.style.left=`${b+k/2-i.offsetWidth/2}px`})}const a=H("div",{className:`ipe-modal-modal__window size--${this.options.sizeClass||"auto"} plugin--${this.pluginName}`});a.modal=this;const n=H("div",{className:"ipe-modal-modal__header"}),r=`${this.modalId}-title`,o=H("h2",{className:"ipe-modal-modal__title",attrs:{id:r,role:"heading","aria-level":"2"}});i.setAttribute("aria-labelledby",r);const c=H("div",{className:"ipe-modal-modal__icons"});if(this.options.closeIcon){const y=H("button",{className:"ipe-modal-modal__close",attrs:{type:"button","aria-label":"Close"},html:"&times;"});y.addEventListener("click",()=>{let b=!0;typeof this.options.onClickClose=="function"?this.options.onClickClose(this)===!1&&(b=!1):this.options.onClickClose===!1&&(b=!1),b&&this.close()}),c.appendChild(y)}n.append(o,c),!e&&this.options.draggable&&(n.style.cursor="move",n.style.userSelect="none",n.addEventListener("pointerdown",this.onDragStart.bind(this)));const l=H("div",{className:"ipe-modal-modal__content"}),d=H("div",{className:"ipe-modal-modal__footer"}),p=H("div",{className:"ipe-modal-modal__buttons ipe-modal-modal__buttons--left"}),g=H("div",{className:"ipe-modal-modal__buttons ipe-modal-modal__buttons--right"});return d.append(p,g),a.append(n,l,d),i.appendChild(a),this.$backdrop=t,this.$modal=i,this.$window=a,this.$header=n,this.$title=o,this.$icons=c,this.$content=l,this.$footer=d,this.$buttonsLeft=p,this.$buttonsRight=g,this.options.title&&this.setTitle(this.options.title),this.options.content&&this.setContent(this.options.content),this.options.buttons?.length?this.setButtons(this.options.buttons):d.style.display="none",this.options.center&&this.$modal.classList.add("is-centered"),this.options.fitScreen&&this.$modal.classList.add("is-fullscreen"),this.options.iconButtons&&this.$header.classList.add("has-icon-buttons"),this.options.className&&this.$window.classList.add(...this.options.className.split(/[\s\.#+]+/g).filter(Boolean)),typeof this.options.fixedHeight=="number"?this.$window.style.height=`${Math.max(0,this.options.fixedHeight)}px`:this.options.fixedHeight===!0&&this.$window.classList.add("is-fixed-height"),t&&t.addEventListener("pointerdown",y=>{this.options.outSideClose&&y.target===t&&this.close()}),this.onKeyDown=this.onKeyDown.bind(this),this.emit("modal.init"),this}show(){if(this.$modal||this.init(),!this.$modal)throw new Error("Failed to initialize modal");if(this.isOpen)return this;{const i=this.emit("modal.beforeShow",!0),a=this.options.beforeShow?this.options.beforeShow(this)!==!1:!0;if(!i||!a)return this}this.lastFocused=document.activeElement??null,this.$backdrop&&document.body.appendChild(this.$backdrop),document.body.appendChild(this.$modal),this.shouldLockBodyOnOpen()&&G.lockBodyScroll(),requestAnimationFrame(()=>{this.$backdrop?.classList.add("is-open"),this.$modal.classList.add("is-open"),this.applyAnimation(!0),this.focusFirst()}),document.addEventListener("keydown",this.onKeyDown),G.push(this),this.isOpen=!0,this.options.onShow?.(this),this.emit("modal.show");const e=typeof this.options.closeAfter=="number"?this.options.closeAfter:this.options.closeAfter?.time,t=typeof this.options.closeAfter=="number"?!0:this.options.closeAfter?.resetOnHover;return e&&(this.startCloseTimer(e),t&&(this.$window?.addEventListener("mouseenter",this.stopCloseTimer),this.$window?.addEventListener("mouseleave",()=>this.startCloseTimer(e)))),this}close(){if(!this.isOpen)return this;{const n=this.emit("modal.beforeClose",!0),r=this.options.beforeClose?this.options.beforeClose(this)!==!1:!0;if(!n||!r)return this}if(this.isToast){this.applyAnimation(!1),this.emit("modal.close"),this.emit("toast.close");const n=this.isAnimationDisabled()?0:this.options.animationSpeed??200;let r=!1;const o=()=>{r||(r=!0,this.destroy(),this.options.onClose?.(this))},c=(l,d)=>{const p=()=>{l.removeEventListener(d,p),o()};l.addEventListener(d,p,{once:!0})};return n>0&&this.$window?(c(this.$window,"transitionend"),c(this.$window,"animationend"),window.setTimeout(o,n+20)):window.setTimeout(o,n),this}this.applyAnimation(!1),this.$backdrop?.classList.remove("is-open"),this.$modal?.classList.remove("is-open"),this.emit("modal.close");const e=this.isAnimationDisabled()?0:this.options.animationSpeed??200;let t=!1;const i=()=>{t||(t=!0,this.destroy(),this.options.onClose?.(this))},a=(n,r)=>{const o=()=>{n.removeEventListener(r,o),i()};n.addEventListener(r,o,{once:!0})};return e>0&&this.$window?(a(this.$window,"transitionend"),a(this.$window,"animationend"),window.setTimeout(i,e+20)):window.setTimeout(i,e),this}destroy(){if(this._isDestroyed)return this;if(this.stopCloseTimer(),document.removeEventListener("keydown",this.onKeyDown),this.isDragging&&this.onDragEnd(),this.$window?.removeEventListener("mouseenter",this.stopCloseTimer),this.isToast){this.$window?.parentElement&&this.$window.parentElement.removeChild(this.$window);const e=me.indexOf(this);e!==-1&&me.splice(e,1)}else this.$backdrop?.parentElement&&this.$backdrop.parentElement.removeChild(this.$backdrop),this.$modal?.parentElement&&this.$modal.parentElement.removeChild(this.$modal),G.remove(this),this.shouldUnlockBodyOnClose()&&G.unlockBodyScroll();return this.isOpen=!1,this.lastFocused?.focus?.(),this.emit("modal.destroy"),this._isDestroyed=!0,this}get$backdrop(){return this.$backdrop}get$modal(){return he(this.$modal,"modal")}get$window(){return he(this.$window,"window")}get$header(){return he(this.$header,"header")}get$title(){return he(this.$title,"title")}get$content(){return he(this.$content,"content")}get$icons(){return he(this.$icons,"icons")}get$buttons(e){return e==="leftButtons"?he(this.$buttonsLeft,"leftButtons"):e==="rightButtons"?he(this.$buttonsRight,"rightButtons"):he(this.$footer,"buttons")}setTitle(e){const t=this.get$title();return t.innerHTML="",t.append(je(e)),this}setContent(e,t="replace"){const i=this.get$content();return t==="replace"?(i.innerHTML="",i.append(je(e))):t==="append"?i.append(je(e)):i.prepend(je(e)),this}setIcons(e){const t=this.get$icons();t.innerHTML="";for(const i of e){const a=H("button",{className:`ipe-modal-modal__icon ${i.className}`,attrs:{type:"button"}});a.addEventListener("click",i.method),t.appendChild(a)}return this}setButtons(e,t){const i=this.$buttonsLeft,a=this.$buttonsRight;[i,a].forEach(r=>r.innerHTML=""),this.buttonElsLeft=[],this.buttonElsRight=[],this.keyMap.clear();const n=t??this.$footer;if(n===this.$footer)e.forEach(r=>this.addButton(r)),e.length===0&&(this.$footer.style.display="none");else{n.innerHTML="";for(const r of e){const o=this.generateButton(r);n.appendChild(o)}}return this}generateButton(e){const t=e.type??"button",i=t==="link"?H("a"):H("button",{attrs:{type:"button"}});e.id&&(i.id=e.id),i.className=`ipe-modal-btn ${e.className??""}`.trim();const a=je(e.label??"OK");if(i.append(a),t==="link"&&e.href&&(i.href=e.href),e.method&&i.addEventListener("click",n=>{if(i._ipe_tmpDisabled){n.preventDefault(),n.stopPropagation();return}e.method.call(i,n,this)}),typeof e.closeAfter=="number"&&e.closeAfter>=0&&i.addEventListener("click",()=>{window.setTimeout(()=>this.close(),e.closeAfter)}),typeof e.enableAfter=="number"&&e.enableAfter>0){t==="button"&&i.setAttribute("disabled","true"),i._ipe_tmpDisabled=!0,i.setAttribute("aria-disabled","true");const n=()=>{t==="button"&&i.removeAttribute("disabled"),delete i._ipe_tmpDisabled,i.removeAttribute("aria-disabled")};window.setTimeout(n,e.enableAfter)}if(e.keyPress){const n=String(e.keyPress).split(/[\,\|]+/g).map(r=>r.trim()).filter(Boolean);for(const r of n){const o=zn(r);o&&this.keyMap.set(o,i)}}return i}addButton(e,t){this.$footer&&(this.$footer.style.display="");const i=e.side??"right",a=i==="left"?this.$buttonsLeft:this.$buttonsRight,n=i==="left"?this.buttonElsLeft:this.buttonElsRight,r=this.generateButton(e),o=Math.max(0,Math.min(t??n.length,n.length));return o>=a.children.length?a.appendChild(r):a.insertBefore(r,a.children[o]),n.splice(o,0,r),this}removeButton(e){const t=this.buttonElsLeft,i=this.buttonElsRight,a=[...t,...i];let n=null;if(e==="*")return a.forEach(o=>{this.keyMap.delete(o.id),o.parentElement?.removeChild(o)}),this.$footer&&(this.$footer.style.display="none"),this;if(typeof e=="number"?n=a[e]??null:typeof e=="string"?n=a.find(o=>o.id===e)??null:e instanceof HTMLElement&&(n=a.find(o=>o===e)??null),!n)return this;for(const[o,c]of this.keyMap.entries())c===n&&this.keyMap.delete(o);let r=t.indexOf(n);return r!==-1?(t.splice(r,1),n.parentElement?.removeChild(n)):(r=i.indexOf(n),r!==-1&&(i.splice(r,1),n.parentElement?.removeChild(n))),t.length===0&&i.length===0&&this.$footer&&(this.$footer.style.display="none"),this}changePreviewState(){return this.get$modal().classList.toggle("is-fullscreen"),this}setModalHeight(e,t="height"){const i=this.get$window(),a=Math.max(0,window.innerHeight-e);return i.style[t]=`${a}px`,a}setOptions(e,t){return typeof e=="string"?this.options[e]=t:Object.assign(this.options,e),this}setPluginName(e){return this.$window&&(this.$window.className=this.$window.className.replace(`plugin--${this.pluginName}`,`plugin--${e}`)),this.pluginName=e,this}applyAnimation(e){const t=this.get$modal(),i=this.get$window(),a=this.$backdrop,n=this.options.modalAnimation??this.options.animation,r=typeof n=="string"?n:n&&(e?n.show:n.hide),o=this.options.backdropAnimation??this.options.animation,c=typeof o=="string"?o:o&&(e?o.show:o.hide);!r||r===!1?(t.style.transition="none",i.style.animation="none",i.style.removeProperty("--ipe-modal-anim")):(t.style.removeProperty("transition"),i.style.setProperty("--ipe-modal-anim",r)),a&&(!c||c===!1?a.style.transition="none":a.style.removeProperty("transition"))}on(e,t){return this._hooks.push({type:e,listener:t}),()=>this.off(e,t)}off(e,t){return this._hooks=this._hooks.filter(i=>i.type!==e&&(t?i.listener!==t:!0)),this}once(e,t){const i=this.on(e,a=>(i(),t(a)));return i}emit(e,t){const i=this._hooks.filter(o=>o.type===e);let a=!0;for(const o of i){const c=new CustomEvent(e,{detail:this,cancelable:t}),l=o.listener(c);if(c.defaultPrevented&&(a=!1),l===!1&&(a=!1),!a)break}const n=this.$modal??document.body,r=new CustomEvent(e,{detail:this,cancelable:t});return(!n.dispatchEvent(r)||r.defaultPrevented)&&(a=!1),a}focusFirst(){const e=this.get$modal(),t=Ls(e);t.length?t[0].focus():e.focus({preventScroll:!0})}onKeyDown(e){if(G.top()!==this)return;if(e.key==="Escape"){e.preventDefault(),this.close();return}const t=this.get$modal();if(!t.contains(document.activeElement))return;if(e.key==="Tab"){const o=Ls(t);if(!o.length)return;const c=o[0],l=o[o.length-1],d=document.activeElement;e.shiftKey&&d===c?(e.preventDefault(),l.focus()):!e.shiftKey&&d===l&&(e.preventDefault(),c.focus())}const i=e.ctrlKey||e.altKey||e.metaKey,a=e.target;if(!i&&(a&&["INPUT","TEXTAREA"].includes(a.tagName)||a.contentEditable==="true"))return;const n=qn(e),r=this.keyMap.get(n);if(r){e.preventDefault(),r.click();return}}setZIndex(e){this.$backdrop&&(this.$backdrop.style.zIndex=String(e)),this.$modal&&(this.$modal.style.zIndex=String(e+1))}bringToFront(){return G.remove(this),G.push(this),this}isAnimationDisabled(){const e=this.options.modalAnimation??this.options.animation;return e===!1||e==null}shouldLockBodyOnOpen(){return this.options.backdrop===!1||this.options.bodyScroll!==!1?!1:!G.stack.some(e=>e!==this&&e.options.backdrop!==!1&&e.options.bodyScroll===!1)}shouldUnlockBodyOnClose(){return this.options.backdrop===!1||this.options.bodyScroll!==!1?!1:!G.stack.some(e=>e!==this&&e.options.backdrop!==!1&&e.options.bodyScroll===!1)}onDragStart(e){if(this.options.backdrop!==!1||!this.options.draggable)return;e.preventDefault(),this.isDragging=!0,this.bringToFront(),this.dragStartX=e.clientX,this.dragStartY=e.clientY;const t=this.get$modal(),i=t.getBoundingClientRect();this.modalStartX=i.left+window.pageXOffset,this.modalStartY=i.top+window.pageYOffset,t.style.transform="none",t.style.left=`${this.modalStartX}px`,t.style.top=`${this.modalStartY}px`,document.addEventListener("pointermove",this.onDragMove),document.addEventListener("pointerup",this.onDragEnd),t.classList.add("is-dragging")}showToast(e){this.$window||this.init();const t=Kn(e.position??"top right"),i=this.get$window();this.isToast=!0,i.style.pointerEvents="auto",this.applyAnimation(!0),t.appendChild(i);const a=(typeof this.options.closeAfter=="number"?this.options.closeAfter:this.options.closeAfter?.time)??3e3,n=(typeof this.options.closeAfter=="number"?!0:this.options.closeAfter?.resetOnHover)??!0;return a>0&&(this.startCloseTimer(a),n&&(i.addEventListener("mouseenter",this.stopCloseTimer),i.addEventListener("mouseleave",()=>this.startCloseTimer(a)))),this.isOpen=!0,this.options.onShow?.(this),me.push(this),this.emit("toast.show"),this.emit("modal.show"),this}static show(e,t){return new this(e).init().show()}static createObject(e,t){return new this(e)}static close(e){if(!e){const n=G.top();return n?.close(),n}const t=typeof e=="string"?e:e.id,i=G.stack.find(n=>n.modalId===t);if(i)return i.close(),i;const a=me.find(n=>n.modalId===t);return a?.close(),a}static closeAll(e,t){const i=new Set((Array.isArray(t)?t:t?[t]:[]).map(String)),a=new Set((Array.isArray(e)?e:e?[e]:[]).map(String));return G.closeAll(e,t),[...me].forEach(n=>{const r=n.modalId,o=a.size?a.has(n.pluginName):!0,c=i.has(r);o&&!c&&n.close()}),G.top()??new hs}static removeAll(){G.removeAll(),[...me].forEach(e=>e.destroy())}static dialog(e,t){const i=new this({sizeClass:"dialog",buttons:[{label:"OK",className:"is-primary is-ghost",method:(a,n)=>{t?.(a,n),a.defaultPrevented||i.close()},keyPress:"Enter"}],...e});return i.init().show()}static confirm(e,t){e.title??="Confirm",e.content??="Are you sure you want to perform this action?";const i=e.okBtn??{label:"OK",className:"is-primary is-ghost"},a=e.cancelBtn??{label:"Cancel",className:"is-danger is-ghost"},n=new this({sizeClass:"dialog",...e,buttons:[{label:a.label,className:a.className,keyPress:"n",method:()=>n.close()},{label:i.label,className:i.className,keyPress:"y",method:r=>{t?.(r,n),r.defaultPrevented||n.close()}}]});return n.init().show()}static getDefaultNotifyIcon(e){switch(e){case"success":return C("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",class:"icon icon-tabler icons-tabler-filled icon-tabler-circle-check",children:[C("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),C("path",{d:"M17 3.34a10 10 0 1 1 -14.995 8.984l-.005 -.324l.005 -.324a10 10 0 0 1 14.995 -8.336zm-1.293 5.953a1 1 0 0 0 -1.32 -.083l-.094 .083l-3.293 3.292l-1.293 -1.292l-.094 -.083a1 1 0 0 0 -1.403 1.403l.083 .094l2 2l.094 .083a1 1 0 0 0 1.226 0l.094 -.083l4 -4l.083 -.094a1 1 0 0 0 -.083 -1.32z"})]});case"error":return C("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",class:"icon icon-tabler icons-tabler-filled icon-tabler-alert-triangle",children:[C("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),C("path",{d:"M12 1.67c.955 0 1.845 .467 2.39 1.247l.105 .16l8.114 13.548a2.914 2.914 0 0 1 -2.307 4.363l-.195 .008h-16.225a2.914 2.914 0 0 1 -2.582 -4.2l.099 -.185l8.11 -13.538a2.914 2.914 0 0 1 2.491 -1.403zm.01 13.33l-.127 .007a1 1 0 0 0 0 1.986l.117 .007l.127 -.007a1 1 0 0 0 0 -1.986l-.117 -.007zm-.01 -7a1 1 0 0 0 -.993 .883l-.007 .117v4l.007 .117a1 1 0 0 0 1.986 0l.007 -.117v-4l-.007 -.117a1 1 0 0 0 -.993 -.883z"})]});case"warning":return C("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",class:"icon icon-tabler icons-tabler-filled icon-tabler-alert-circle",children:[C("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),C("path",{d:"M12 2c5.523 0 10 4.477 10 10a10 10 0 0 1 -19.995 .324l-.005 -.324l.004 -.28c.148 -5.393 4.566 -9.72 9.996 -9.72zm.01 13l-.127 .007a1 1 0 0 0 0 1.986l.117 .007l.127 -.007a1 1 0 0 0 0 -1.986l-.117 -.007zm-.01 -8a1 1 0 0 0 -.993 .883l-.007 .117v4l.007 .117a1 1 0 0 0 1.986 0l.007 -.117v-4l-.007 -.117a1 1 0 0 0 -.993 -.883z"})]});case"info":return C("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",class:"icon icon-tabler icons-tabler-filled icon-tabler-info-circle",children:[C("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),C("path",{d:"M12 2c5.523 0 10 4.477 10 10a10 10 0 0 1 -19.995 .324l-.005 -.324l.004 -.28c.148 -5.393 4.566 -9.72 9.996 -9.72zm0 9h-1l-.117 .007a1 1 0 0 0 0 1.986l.117 .007v3l.007 .117a1 1 0 0 0 .876 .876l.117 .007h1l.117 -.007a1 1 0 0 0 .876 -.876l.007 -.117l-.007 -.117a1 1 0 0 0 -.764 -.857l-.112 -.02l-.117 -.006v-3l-.007 -.117a1 1 0 0 0 -.876 -.876l-.117 -.007zm.01 -3l-.127 .007a1 1 0 0 0 0 1.986l.117 .007l.127 -.007a1 1 0 0 0 0 -1.986l-.117 -.007z"})]});case"dialog":return C("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"icon icon-tabler icons-tabler-outline icon-tabler-message-dots",children:[C("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),C("path",{d:"M12 11v.01"}),C("path",{d:"M8 11v.01"}),C("path",{d:"M16 11v.01"}),C("path",{d:"M18 4a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-5l-5 3v-3h-2a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3z"})]});case"confirm":return C("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",class:"icon icon-tabler icons-tabler-filled icon-tabler-copy-check",children:[C("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),C("path",{d:"M18.333 6a3.667 3.667 0 0 1 3.667 3.667v8.666a3.667 3.667 0 0 1 -3.667 3.667h-8.666a3.667 3.667 0 0 1 -3.667 -3.667v-8.666a3.667 3.667 0 0 1 3.667 -3.667zm-3.333 -4c1.094 0 1.828 .533 2.374 1.514a1 1 0 1 1 -1.748 .972c-.221 -.398 -.342 -.486 -.626 -.486h-10c-.548 0 -1 .452 -1 1v9.998c0 .32 .154 .618 .407 .805l.1 .065a1 1 0 1 1 -.99 1.738a3 3 0 0 1 -1.517 -2.606v-10c0 -1.652 1.348 -3 3 -3zm1.293 9.293l-3.293 3.292l-1.293 -1.292a1 1 0 0 0 -1.414 1.414l2 2a1 1 0 0 0 1.414 0l4 -4a1 1 0 0 0 -1.414 -1.414"})]});default:return null}}static notify(e,t,i){if(t?.overrideOther&&[...me].forEach(o=>o.close()),typeof t.title>"u"){const o=e||"Notification";t.title=o[0].toUpperCase()+o.slice(1).toLowerCase()}const a=t.icon??this.getDefaultNotifyIcon(e);a&&(a instanceof Element&&a.classList.add("ipe-modal-notify-icon"),t.title=C(Un,{children:[a,t.title]})),t.okBtn&&(t.okBtn.label??="OK",t.okBtn.className??="is-primary is-ghost ok-btn",t.okBtn.method=()=>{i?.(!0),r.close()}),t.cancelBtn&&(t.cancelBtn.label??="Cancel",t.cancelBtn.className??="is-danger is-ghost cancel-btn",t.cancelBtn.method=()=>{i?.(!1),r.close()}),t.buttons=[t.cancelBtn,t.okBtn,...t.buttons??[]].filter(Boolean);const n=`is-notify type-${e||"default"} ${t.className??""}`,r=new this({...t,className:n,sizeClass:"auto",center:!1,fitScreen:!1,closeIcon:!0,outSideClose:!1,bodyScroll:!0,animation:t.animation??{show:"fadeIn",hide:"fadeOut"},buttons:t.buttons??[]});return r.setPluginName("toast"),r.showToast({position:t.position??"top right"})}}const me=[];function Kn(s="top right"){const e="ipe-modal-toast-container",t=`${e}-${s.replace(/[\s-\.|\/]+/g,"-")}`;let i=document.getElementById(t);return i||(i=H("div",{className:`${e} ${s}`,attrs:{id:t,"data-position":s}}),document.body.appendChild(i)),i}class D extends hs{constructor(e={}){e.className||="",e.className+=" theme-ipe",e.modalAnimation||={show:"ipe-modal-fade-in",hide:"ipe-modal-fade-out"},super(e)}setLoadingState(e){if(this.get$window().classList.toggle("loading",e),e){const t=this.get$window().querySelectorAll("input:not([disabled]),button:not([disabled])");this._tmpDisabledActiveInputs=t,t.forEach(i=>{i.disabled=!0}),this.get$content().append(W("div",{id:"ipe-modalLoadingWrapper",style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(255, 255, 255, 0.5)",zIndex:2e3},children:W(ya,{style:{width:"80%",maxWidth:"800px"}})}))}else{this.get$window().querySelector("#ipe-modalLoadingWrapper")?.remove();const t=this._tmpDisabledActiveInputs;t&&t.forEach(i=>{i.disabled=!1})}}}class Vn{constructor(e){this.ctx=e,this.IPEModal=D,this.IPEModalEvent=us,this.show=D.show.bind(D),this.createObject=D.createObject.bind(D),this.close=D.close.bind(D),this.closeAll=D.closeAll.bind(D),this.removeAll=D.removeAll.bind(D),this.dialog=D.dialog.bind(D),this.confirm=D.confirm.bind(D),this.notify=D.notify.bind(D),e.set("modal",this),e.on("dispose",()=>{D.closeAll()})}}const mi=s=>{if(!s)return new URLSearchParams;if(s instanceof URLSearchParams)return s;if(typeof s!="object"||s?.constructor!==Object)throw new TypeError("only plain object is supported");const e=new URLSearchParams;for(const[t,i]of Object.entries(s))if(i!=null){if(Array.isArray(i)){for(const a of i)e.append(t,a?.toString());continue}if(typeof i=="object"&&i!==null&&i.constructor===Object){for(const[a,n]of Object.entries(i))n!=null&&e.set(`${t}[${a}]`,n?.toString());continue}e.set(t,i?.toString())}return e},gi=(s,e,t)=>{const i=typeof s=="string"?new URL(s,window?.location?.origin):new URL(s),a=new URLSearchParams(i.search),n=mi(e);for(const[r,o]of n.entries())a.set(r,o);return i.search=a.toString(),i.hash="",i};var Yn=Object.create,ds=Object.defineProperty,Qn=Object.getOwnPropertyDescriptor,yi=(s,e)=>(e=Symbol[s])?e:Symbol.for("Symbol."+s),wi=s=>{throw TypeError(s)},Xn=(s,e,t)=>e in s?ds(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Jn=(s,e)=>ds(s,"name",{value:e,configurable:!0}),Zn=s=>[,,,Yn(s?.[yi("metadata")]??null)],er=["class","method","getter","setter","accessor","field","value","get","set"],bi=s=>s!==void 0&&typeof s!="function"?wi("Function expected"):s,tr=(s,e,t,i,a)=>({kind:er[s],name:e,metadata:i,addInitializer:n=>t._?wi("Already initialized"):a.push(bi(n||null))}),sr=(s,e)=>Xn(e,yi("metadata"),s[3]),ir=(s,e,t,i)=>{for(var a=0,n=s[e>>1],r=n&&n.length;a<r;a++)n[a].call(t);return i},ar=(s,e,t,i,a,n)=>{var r,o,c,l=e&7,d=!1,p=0,g=s[p]||(s[p]=[]),y=l&&(a=a.prototype,l<5&&(l>3||!d)&&Qn(a,t));Jn(a,t);for(var b=i.length-1;b>=0;b--)c=tr(l,t,o={},s[3],g),r=(0,i[b])(a,c),o._=1,bi(r)&&(a=r);return sr(s,a),y&&ds(a,t,y),d?l^4?n:y:a},vi,fs,_i;vi=[ve(["api","storage"])];class mt extends(_i=Ee){constructor(e){super(e,"wiki",!1),this.ctx=e,this._data=void 0,this.CACHE_TTL=1e3*60*60*24,this.VERSION=2,this.db=void 0,this.logger=void 0,this.queryData={meta:"siteinfo|userinfo",siprop:"general|specialpagealiases|namespacealiases|namespaces|magicwords",uiprop:"groups|rights|blockinfo|options"},this.mwConfig={get:(t,i)=>window?.mw?.config?.get?.(t,i)??i,has:t=>window?.mw?.config?.exists?.(t)??!1,get values(){return window?.mw?.config?.values||{}}},this.db=e.storage.createDatabse("wiki-metadata",this.CACHE_TTL,this.VERSION),this.logger=e.logger("WIKI_METADATA")}get api(){return this.ctx.api}async start(){const e=await this.fetchFromCache();if(e)this._data=e,this.logger.debug("Using cached");else{const t=await this.fetchFromApi();this.saveToCache(t),this._data=t,this.logger.debug("Fetched from API")}this.logger.info("loaded",this._data),this.ctx.set("getUrl",this.getUrl.bind(this)),this.ctx.set("getSciprtUrl",this.getSciprtUrl.bind(this)),this.ctx.set("getMainpageUrl",this.getMainpageUrl.bind(this)),this.ctx.inject(["preferences"],t=>{t.preferences.registerCustomConfig("WikiMetadataService",Ft.object({WikiMetadataService:Ft.const(W("div",{children:[W("h3",{children:"Wiki Informations"}),W("ul",{children:[W("li",{children:[W("strong",{children:"Site:"})," ",this.general.sitename," (",this.landingPageUrl,")"]}),W("li",{children:[W("strong",{children:"User"}),": ",this.userInfo.name," (ID: ",this.userInfo.id,")"]}),W("li",{children:[W("strong",{children:"Groups"}),": ",this.userGroups.join(", ")||"None"]})]}),W("p",{children:W("button",{onClick:i=>{i.preventDefault(),this.invalidateCache().then(()=>{window.location.reload()})},children:"Clear caches and reload page"})})]})).role("raw-html")}).description("WikiMetadataService"),"general")})}get metadataCacheId(){return this.ctx.api.config.baseURL}async fetchFromApi(){return this.api.get({action:"query",...this.queryData}).then(({data:e})=>{if(typeof e?.query?.general>"u")throw new Error("Invalid siteinfo");return e.query}).catch(e=>(this.logger.error("Failed to fetch metadata",e),Promise.reject(e)))}async fetchFromCache(){const e=this.metadataCacheId,t=this.mwConfig.get("wgUserId",0),i=await this.db.get(e);return i&&typeof i=="object"&&i.general&&i.userinfo.id===t?i:(this.logger.info(i?"Cache mis-match":"Missing cache"),this.invalidateCache(),null)}async saveToCache(e){const t=this.metadataCacheId;return this.db.set(t,e)}async invalidateCache(){const e=this.metadataCacheId;return this.db.delete(e)}get _raw(){return this._data}get general(){return this._data.general}get specialPageAliases(){return this._data.specialpagealiases}get namespaceAliases(){return this._data.namespacealiases}get namespaces(){return this._data.namespaces}get namespaceMap(){const e=Object.values(this.namespaces).map(t=>({id:t.id,canonical:t.canonical,aliases:this.namespaceAliases.filter(i=>i.id===t.id).map(i=>i.alias)})).sort((t,i)=>t.id-i.id);return Reflect.defineProperty(this,"namespaceMap",{get:()=>e}),e}get magicWords(){return this._data.magicwords}get userInfo(){return this._data.userinfo}get userOptions(){return this.userInfo.options}get isUserBlocked(){return this.userInfo.blockedbyid&&this.userInfo.blockexpiry&&new Date(this.userInfo.blockexpiry).getTime()>Date.now()}get userGroups(){return this.userInfo.groups}get userRights(){return this.userInfo.rights}get baseUrl(){const e=this.general.server;return e.startsWith("//")?`${window?.location?.protocol||"https:"}//${e.slice(2)}`:e}get landingPageUrl(){return this.general.base}get mainPageName(){return this.general.mainpage}get mainPageUrl(){return this.getUrl(this.mainPageName)}get articlePath(){return this.general.articlepath}get scriptPath(){return this.general.scriptpath}get articleBaseUrl(){return`${this.baseUrl}${this.articlePath}`}get scriptBaseUrl(){return`${this.baseUrl}${this.scriptPath}`}getSciprtUrl(e="index"){return`${this.scriptBaseUrl}/${e.replace(/\.php$/,"")}.php`}getMainpageUrl(e){return gi(this._data.general.base,e).toString()}getUrl(e,t){const i=mi(t);let a;return typeof e=="string"&&e!==""?a=new URL(`${this.articleBaseUrl.replace("$1",e)}`):typeof e=="number"?(i.set("curid",e.toString()),a=new URL(this.getSciprtUrl("index"))):a=new URL(this.getSciprtUrl("index")),a.search=i.toString(),a.toString()}hasRight(e){return this.userRights.includes(e)}hasAnyRight(...e){return e.some(t=>this.hasRight(t))}hasEveryRights(...e){return e.every(t=>this.hasRight(t))}inGroup(e){return this.userGroups.includes(e)}inAnyGroup(...e){return this.userGroups.some(t=>e.includes(t))}getBlockInfo(){return this.isUserBlocked?{blockid:this.userInfo.blockid,blockedby:this.userInfo.blockedbyid,blockedbyid:this.userInfo.blockedbyid,blockreason:this.userInfo.blockreason,blockedtimestamp:this.userInfo.blockedtimestamp,blockexpiry:this.userInfo.blockexpiry}:null}}fs=Zn(_i);mt=ar(fs,0,"WikiMetadataService",vi,mt);ir(fs,1,mt);var I;(s=>{function e(u){return new Promise((f,m)=>{u.onsuccess=()=>f(u.result),u.onerror=()=>m(u.error)})}s.promisifyRequest=e;const t=new Map,i=new Map;function a(u,f){const m=(i.get(u)??Promise.resolve()).then(f,f);return i.set(u,m.catch(()=>{})),m}function n(u){return new Promise(f=>setTimeout(f,u+Math.floor(Math.random()*8)))}function r(u){if(!(u instanceof DOMException))return!1;const f=u.name,m=String(u?.message??"");return f==="InvalidStateError"||f==="TransactionInactiveError"||f==="NotFoundError"||f==="AbortError"&&/versionchange|closing|internal/i.test(m)}function o(u){const f=t.get(u);if(f)return f;const m=new Promise((w,v)=>{const E=indexedDB.open(u);E.onupgradeneeded=()=>{},E.onsuccess=()=>{const R=E.result;R.onversionchange=()=>{try{R.close()}finally{t.delete(u)}},w(R)},E.onerror=()=>v(E.error),E.onblocked=()=>{}});return t.set(u,m),m}s.openDatabase=o;async function c(u){const f=t.get(u);if(f)try{(await f).close()}finally{t.delete(u)}}s.closeDatabase=c;async function l(){const u=Array.from(t.keys());await Promise.all(u.map(c))}s.closeAllDatabases=l;async function d(u){await c(u),await new Promise((f,m)=>{const w=indexedDB.deleteDatabase(u);w.onsuccess=()=>f(),w.onerror=()=>m(w.error),w.onblocked=()=>{}})}s.deleteDatabase=d;async function p(u,f,m={}){return a(u,async()=>{let w=await o(u);const v=!w.objectStoreNames.contains(f),E=!v&&m.indexes&&m.indexes.length>0;if(!v&&!E)return w;const R=w.version+1;w.close();const ee=new Promise((ce,Q)=>{const j=indexedDB.open(u,R);j.onupgradeneeded=()=>{const L=j.result;let te;if(L.objectStoreNames.contains(f)?te=j.transaction.objectStore(f):te=L.createObjectStore(f,{keyPath:m.keyPath??void 0,autoIncrement:!!m.autoIncrement}),m.indexes&&m.indexes.length>0)for(const{name:st,keyPath:X,options:it}of m.indexes)te.indexNames.contains(st)||te.createIndex(st,X,it)},j.onsuccess=()=>{const L=j.result;L.onversionchange=()=>{try{L.close()}finally{t.delete(u)}},ce(L)},j.onerror=()=>Q(j.error),j.onblocked=()=>{}});return t.set(u,ee),ee})}s.ensureStore=p;async function g(u,f,m={}){return await p(u,f,m),{dbName:u,storeName:f,getDb:()=>o(u)}}s.createStore=g;async function y(u,f,m,w={}){const{dbName:v,storeName:E}=u,R=w.attempts??2,ee=w.baseDelayMs??16;let ce;for(let Q=0;Q<=R;Q++)try{Q===0&&await p(v,E);const j=await o(v);let L;try{L=j.transaction(E,f)}catch(X){if(r(X)&&Q<R){await c(v),await n(ee*(1<<Q)),ce=X;continue}throw X}const te=L.objectStore(E),st=new Promise((X,it)=>{L.oncomplete=()=>X(),L.onerror=()=>it(L.error),L.onabort=()=>it(L.error)});try{const X=await m(te);return await st,X}catch(X){if(r(X)&&Q<R){try{L.abort()}catch{}await c(v),await n(ee*(1<<Q)),ce=X;continue}try{L.abort()}catch{}throw X}}catch(j){if(r(j)&&Q<R){await c(v),await n(ee*(1<<Q)),ce=j;continue}throw j}throw ce}s.withObjectStore=y;async function b(u,f){return y(u,"readonly",async m=>{const w=m.get(f);return e(w)})}s.get=b;async function k(u,f,m){return y(u,"readwrite",async w=>{const v=w.put(m,f);await e(v)})}s.set=k;async function O(u,f){return y(u,"readwrite",async m=>{const w=m.delete(f);await e(w)})}s.del=O;async function A(u){return y(u,"readwrite",async f=>{const m=f.clear();await e(m)})}s.clear=A;function z(u,f=100){return{[Symbol.asyncIterator](){let m=[],w=!1,v;const E=async()=>{w||(m=[],await y(u,"readonly",async R=>{const ee=v===void 0?void 0:IDBKeyRange.lowerBound(v,!0);await new Promise((ce,Q)=>{let j=0;const L=R.openCursor(ee,"next");L.onsuccess=()=>{const te=L.result;if(!te||j>=f){ce();return}m.push([te.key,te.value]),v=te.key,j++,te.continue()},L.onerror=()=>Q(L.error)}),m.length===0&&(w=!0)}))};return{async next(){return m.length===0&&!w&&await E(),m.length===0?{value:void 0,done:!0}:{value:m.shift(),done:!1}}}}}}s.entries=z;function h(u,f=200){const m=z(u,f);return{[Symbol.asyncIterator](){const w=m[Symbol.asyncIterator]();return{async next(){const v=await w.next();return v.done?{value:void 0,done:!0}:{value:v.value[0],done:!1}}}}}}s.keys=h})(I||(I={}));/**
 * IDB Plus
 *
 * 🗄️ Minimal Promise based IndexedDB Wrapper with Map-like API
 *
 * @author dragon-fish <dragon-fish@qq.com>
 * @license MIT
 */class nr{constructor(e,t,i={}){this.dbName=e,this.storeName=t,this.iterBatch=(i.iterBatch??100)|0,this.retry=i.retry,this.inlineKey=!!i.ensure?.keyPath,this.idbStoreHandle=I.createStore(e,t,i.ensure??{})}iterBatch;retry;inlineKey;idbStoreHandle;async get(e){const t=await this.idbStoreHandle;return I.get(t,e)}async set(e,t){const i=await this.idbStoreHandle;return this.inlineKey?I.withObjectStore(i,"readwrite",async a=>{const n=a.put(t);await I.promisifyRequest(n)},this.retry):I.set(i,e,t)}async delete(e){const t=await this.idbStoreHandle;return I.del(t,e)}async clear(){const e=await this.idbStoreHandle;return I.clear(e)}async has(e){const t=await this.idbStoreHandle;return I.withObjectStore(t,"readonly",async i=>{const a=i.count(e);return await I.promisifyRequest(a)>0},this.retry)}async count(){const e=await this.idbStoreHandle;return I.withObjectStore(e,"readonly",async t=>{const i=t.count();return I.promisifyRequest(i)},this.retry)}entries(){const e=this;return{[Symbol.asyncIterator](){let t=null;return{async next(){if(!t){const i=await e.idbStoreHandle;t=I.entries(i,e.iterBatch)[Symbol.asyncIterator]()}return await t.next()}}}}}keys(){const e=this;return{[Symbol.asyncIterator](){let t=null;return{async next(){if(!t){const i=await e.idbStoreHandle;t=I.keys(i,e.iterBatch)[Symbol.asyncIterator]()}return await t.next()}}}}}values(){const e=this;return{[Symbol.asyncIterator](){const t=e.entries()[Symbol.asyncIterator]();return{async next(){const i=await t.next();return i.done?{value:void 0,done:!0}:{value:i.value[1],done:!1}}}}}}[Symbol.asyncIterator](){return this.entries()[Symbol.asyncIterator]()}async forEach(e){for await(const[t,i]of this.entries())await e(i,t,this)}async setMany(e){const t=await this.idbStoreHandle;await I.withObjectStore(t,"readwrite",async i=>{for await(const[a,n]of Is(e)){const r=this.inlineKey?i.put(n):i.put(n,a);await I.promisifyRequest(r)}},this.retry)}async deleteMany(e){const t=await this.idbStoreHandle;await I.withObjectStore(t,"readwrite",async i=>{for await(const a of Is(e)){const n=i.delete(a);await I.promisifyRequest(n)}},this.retry)}async tx(e,t){const i=await this.idbStoreHandle;return I.withObjectStore(i,e,t,this.retry)}async close(){await I.closeDatabase(this.dbName)}}function Is(s){return s[Symbol.asyncIterator]?s:{async*[Symbol.asyncIterator](){for(const e of s)yield e}}}class rr{constructor(e,t,i=1/0,a){this.dbName=e,this.storeName=t,this.ttl=i,this.version=a,this.db=new nr(e,t),this.keys=this.db.keys.bind(this.db),this.values=this.db.values.bind(this.db),this.entries=this.db.entries.bind(this.db)}async get(e,t=this.ttl,i){const a=await this.loadFromDB(e),n=this.checkIfExpired(a,t);if(!a||n){if(typeof i=="function"){const r=await i();return await this.set(e,r),r}return null}return a.value}async set(e,t){if(t===null||typeof t>"u")return this.delete(e);const i={time:Date.now(),value:t,version:this.version};return await this.db.set(e,i),i}async has(e,t=this.ttl){const i=await this.loadFromDB(e),a=this.checkIfExpired(i,t);return i!==null&&!a}async delete(e){await this.db.delete(e)}async loadFromDB(e){const t=await this.db.get(e);if(t===void 0)return null;if(typeof t.time!="number"||typeof t.value>"u"){try{await this.delete(e)}catch{}return null}if(typeof this.version=="number"&&t.version!==this.version){try{await this.delete(e)}catch{}return null}return t}checkIfExpired(e,t=this.ttl){return e?Date.now()-e.time>t:!1}async clear(){return await this.db.clear(),this}}class or extends Ee{constructor(e){super(e,"storage",!1)}createDatabse(e,t,i){return new rr("InPageEdit",e,t,i)}}var Ei=(s=>(s.preferences="preferences",s.watch="watch",s.unwatch="unwatch",s.nochange="nochange",s))(Ei||{});function lr(s){const t=class t{constructor(a,n=!0){this._loaded=n,this.api=s,a.revisions?.forEach(r=>{typeof r?.slots?.main=="object"&&Object.assign(r,r.slots.main)}),this.pageInfo={...t.DEFAULT_PAGE_INFO,...a}}static async newFromApi(a){const{data:n}=await this.api.get({...t.DEFAULT_QUERY_PARAMS,...a}),r=n?.query?.pages?.[0];if(!r||!r.title)throw new Error("Invalid page info",{cause:n});return new t(r,!0)}static newBlankPage(a={}){return new t(a,!1)}async parse(a){return this.api.post({action:"parse",page:this.pageInfo.title,prop:"text|langlinks|categories|links|templates|images|externallinks|sections|revid|displaytitle|iwlinks|properties|parsewarnings",...a})}async preview(a,n){return this.parse({action:"parse",page:void 0,title:this.title,text:a,pst:1,preview:1,disableeditsection:1,disablelimitreport:1,...n})}async edit(a,n){const{text:r,prependtext:o,appendtext:c,summary:l="",watchlist:d=Ei.preferences,section:p}=a;return this.api.postWithEditToken({action:"edit",title:this.title,starttimestamp:this.pageInfo.touched,basetimestamp:this.revisions[0]?.timestamp,text:r,prependtext:o,appendtext:c,summary:l,watchlist:d,section:p,...n})}async createOnly(a,n){return this.edit(a,{createonly:1,...n})}async delete(a,n){return this.api.postWithEditToken({action:"delete",pageid:this.pageInfo.pageid,reason:a,...n})}async moveTo(a,n,r){return this.api.postWithEditToken({action:"move",from:this.pageInfo.title,to:a,reason:n,movetalk:1,movesubpages:1,...r})}userCan(a){return!!this.pageInfo?.actions?.[a]}userCanEdit(){return this.userCan("edit")}async reloadSelfInfo(){const a=await t.newFromApi({pageids:this.pageInfo.pageid,titles:this.pageInfo.title}),n=(this.pageInfo.revisions||[]).concat(a.revisions||[]).sort((r,o)=>r.revid-o.revid).reduce((r,o)=>(r.find(c=>c.revid===o.revid)||r.push(o),r),[]);return this.pageInfo=a.pageInfo,this.pageInfo.revisions=n,this._loaded=!0,this}get pageid(){return this.pageInfo.pageid}get title(){return this.pageInfo.title}get ns(){return this.pageInfo.ns}get contentmodel(){return this.pageInfo.contentmodel}get fullurl(){return this.pageInfo.fullurl}get canonicalurl(){return this.pageInfo.canonicalurl}get editurl(){return this.pageInfo.editurl}get revisions(){return this.pageInfo.revisions||[]}get lastrevid(){return this.pageInfo.lastrevid}get templates(){return this.pageInfo.templates||[]}get images(){return this.pageInfo.images||[]}};t.api=s,t.DEFAULT_QUERY_PARAMS={action:"query",prop:"info|templates|transcludedin|images|pageimages|revisions",inprop:"protection|url|varianttitles",intestactions:"edit|move|delete",tllimit:"max",tilimit:"max",imlimit:"max",piprop:"thumbnail|name|original",pithumbsize:"200",pilimit:"max",rvprop:"ids|timestamp|flags|comment|user|content",rvslots:"main"},t.DEFAULT_PAGE_INFO={pageid:0,ns:0,title:"",contentmodel:"wikitext",pagelanguage:"",pagelanguagehtmlcode:"",pagelanguagedir:"ltr",touched:new Date().toISOString(),lastrevid:0,length:0,protection:[],restrictiontypes:[],fullurl:"",canonicalurl:"",editurl:"",varianttitles:{},actions:{edit:!0,move:!1,delete:!1},revisions:[],templates:[],images:[]};let e=t;return e}const ws=class ws extends Ee{constructor(e){super(e,"wikiPage",!0),this.ctx=e,this.WikiPage=lr(this.ctx.api)}async createInstance(e,t=!1){return await this.WikiPage.newFromApi(e)}async newFromTitle(e,t=!1,i,a=!1){return this.createInstance({titles:e.toString(),converttitles:t,rvsection:i},a)}async newFromPageId(e,t,i=!1){return this.createInstance({pageids:e,rvsection:t},i)}async newFromRevision(e,t,i=!1){return await this.createInstance({revids:e,rvsection:t},i)}newBlankPage(e={}){return this.WikiPage.newBlankPage(e)}};ws.inject=["api"];let Vt=ws;const Ms=new WeakMap,ne={toDBKey:s=>s.replace(/ /g,"_"),toNormalText:s=>s.replace(/_/g," "),ensureCase:(s,e)=>e==="first-letter"?s.charAt(0).toUpperCase()+s.slice(1):s},Oe={normalizeSpecialPageName:s=>s.toLowerCase(),buildSpecialPageIndex:s=>{const e=new Map,t=new Map,i=new Map;for(const a of s.specialpagealiases){const n=a.realname;e.set(n,n);const r=Oe.normalizeSpecialPageName(n);i.set(r,n);for(const o of a.aliases){t.set(o,n);const c=Oe.normalizeSpecialPageName(o);i.set(c,n)}}return{byRealName:e,byAlias:t,byNormalized:i}},findSpecialPageRealName:(s,e)=>{const t=s.split("/")[0];let i=e.byRealName.get(t)??e.byAlias.get(t);if(i!==void 0)return i;const a=Oe.normalizeSpecialPageName(t);return e.byNormalized.get(a)??null}},ie={normalizeNamespaceText:s=>s.replace(/[_\s]+/g,"_").toLowerCase().replace(/^_+|_+$/g,""),buildIndex:s=>{const e=new Map,t=new Map,i=new Map,a=new Map;for(const[n,r]of Object.entries(s.namespaces)){const o=parseInt(n);e.set(r.name,o),t.set(r.canonical??"",o);const c=ie.normalizeNamespaceText(r.name),l=ie.normalizeNamespaceText(r.canonical??"");a.set(c,o),a.set(l,o)}for(const n of s.namespacealiases){i.set(n.alias,n.id);const r=ie.normalizeNamespaceText(n.alias);a.set(r,n.id)}return{byName:e,byCanonical:t,byAlias:i,byNormalized:a}},findNamespaceId:(s,e)=>{let t=e.byName.get(s)??e.byCanonical.get(s)??e.byAlias.get(s);if(t!==void 0)return t;const i=ie.normalizeNamespaceText(s);return e.byNormalized.get(i)??null},isTalkPage:s=>s%2===1&&s>0,getDefaultNamespaceInfo:s=>({id:s,name:"",canonical:"",case:"first-letter",content:!1,nonincludable:!1,subpages:!1})};function cr(s){var n,r;const e=Ms.get(s);if(e)return e;const t=ie.buildIndex(s),i=Oe.buildSpecialPageIndex(s),o=class o{constructor(l,d){Ue(this,n);Ue(this,r);if(this.newTitle=o.create.bind(o),this.toText=this.getPrefixedText.bind(this),this.toString=this.getPrefixedDBKey.bind(this),q(this,n,l||""),q(this,r,d??0),d===void 0?this.fixNSByTitle():this.stripNamespaceFromTitle(),this.getMainText()==="")throw new Error("Invalid title")}static create(l,d){return new o(l,d)}fixNSByTitle(){const l=P(this,n).indexOf(":");if(l===-1)return;if(l===0){q(this,n,P(this,n).substring(1));return}const d=P(this,n).substring(0,l),p=P(this,n).substring(l+1),g=ie.findNamespaceId(d,o._namespaceIndex);g!==null&&(q(this,n,p),q(this,r,g))}stripNamespaceFromTitle(){const l=P(this,n).indexOf(":");if(l===-1)return;if(l===0){q(this,n,P(this,n).substring(1));return}const d=P(this,n).substring(0,l),p=P(this,n).substring(l+1);ie.findNamespaceId(d,o._namespaceIndex)!==null&&q(this,n,p)}getNamespaceInfo(){return o._meta.namespaces[P(this,r)]??ie.getDefaultNamespaceInfo(P(this,r))}getMainDBKey(){const l=this.getNamespaceInfo();if(P(this,r)===-1){const d=Oe.findSpecialPageRealName(P(this,n),o._specialPageIndex);if(d){const p=P(this,n).includes("/")?P(this,n).substring(P(this,n).indexOf("/")):"",g=d+p;return ne.ensureCase(ne.toDBKey(g),l.case)}}return ne.ensureCase(ne.toDBKey(P(this,n)),l.case)}getMainText(){const l=this.getNamespaceInfo();if(P(this,r)===-1){const d=Oe.findSpecialPageRealName(P(this,n),o._specialPageIndex);if(d){const p=P(this,n).includes("/")?P(this,n).substring(P(this,n).indexOf("/")):"",g=d+p;return ne.ensureCase(ne.toNormalText(g),l.case)}}return ne.ensureCase(ne.toNormalText(P(this,n)),l.case)}getMainRootText(){return this.getMainText().split("/")[0]}getPrefixedDBKey(){return P(this,r)===0?this.getMainDBKey():`${this.getNamespaceDBKey()}:${this.getMainDBKey()}`}getPrefixedText(){return P(this,r)===0?this.getMainText():`${this.getNamespaceText()}:${this.getMainText()}`}getNamespaceId(){return P(this,r)}getNamespaceText(){return this.getNamespaceInfo().name??""}getNamespaceDBKey(){const l=this.getNamespaceInfo();return ne.ensureCase(ne.toDBKey(this.getNamespaceText()),l.case)}getSubjectPage(){if(ie.isTalkPage(P(this,r))){const l=P(this,r)-1;return new o(P(this,n),l)}return this}getTalkPage(){if(ie.isTalkPage(P(this,r)))return this;if(P(this,r)<0)return null;const l=P(this,r)+1;return o._meta.namespaces[l.toString()]?new o(P(this,n),l):null}getURL(l){const d=o._meta.general.articlepath,p=this.getPrefixedDBKey(),g=d.replace("$1",p),y=new URL(g,location.origin);return l&&(l instanceof URLSearchParams?l:new URLSearchParams(l)).forEach((b,k)=>{y.searchParams.set(k,b)}),y}setTitle(l){return q(this,n,l),q(this,r,0),this.fixNSByTitle(),this}setMainText(l){return q(this,n,l),this}setNamespaceText(l){const d=ie.findNamespaceId(l,o._namespaceIndex);return d!==null&&q(this,r,d),this}setNamespaceId(l){return q(this,r,l),this}equals(l){return typeof l=="string"&&(l=new o(l)),this.getPrefixedDBKey()===l.getPrefixedDBKey()}isSpecial(l){if(P(this,r)!==-1)return!1;const d=new o(l,-1);return this.getMainRootText()===d.getMainRootText()}toJSON(){return{ns:P(this,r),text:this.getMainText(),title:this.getPrefixedText(),url:this.getURL().toString(),isSpecial:P(this,r)<0}}};n=new WeakMap,r=new WeakMap,o._meta=s,o._namespaceIndex=t,o._specialPageIndex=i;let a=o;return Ms.set(s,a),a}const Ve=class Ve extends Ee{constructor(e){super(e,"wikiTitle",!0),this.ctx=e,this.logger=this.ctx.logger("WikiTitleService"),this._cachedTitles=new Map,this.wiki=this.ctx.wiki,this.wikiBaseUrl=this.wiki.baseUrl,this.wikiArticlePath=this.wiki.articlePath.replace("$1",""),this.wikiArticleBaseUrl=this.wiki.articleBaseUrl.replace("$1",""),this.wikiIndexPhpUrl=this.wiki.getSciprtUrl("index.php"),this.Title=cr(this.ctx.wiki._raw)}newTitle(e,t){return new this.Title(e,t)}newMainPageTitle(){return this.newTitle(this.ctx.wiki.mainPageName)}async newTitleFromUrl(e){const t=this.parseWikiLink(e);return t?.title?t.title:t?.pageId?this.newTitleFromPageId(t.pageId):null}async newTitleFromAnyId(e,t=!1){const{title:i,pageId:a,revId:n}=e??{};if(typeof i=="string")return this.newTitle(i);let r,o;if(n?(r=parseInt(n.toString(),10),o="revid"):a&&(r=parseInt(a.toString(),10),o="pageid"),!r||!o||isNaN(r)||r<=0)throw new Error("Invalid id or kind",{cause:e});if(!t&&this._cachedTitles.has(`${o}:${r}`))return await this._cachedTitles.get(`${o}:${r}`);const{promise:c,resolve:l,reject:d}=Zt();this._cachedTitles.set(`${o}:${r}`,c);try{const{wikiPage:p}=await this.ctx.useScope(["wikiPage"]);let g=null;if(o==="pageid")g=await p.newFromPageId(r);else if(o==="revid")g=await p.newFromRevision(r);else throw new Error(`Invalid kind: ${o}`);l(this.newTitle(g.title))}catch(p){this._cachedTitles.delete(`${o}:${r}`),d(p)}return c}async newTitleFromPageId(e){return this.newTitleFromAnyId({pageId:e})}async newTitleFromRevision(e){return this.newTitleFromAnyId({revId:e})}resolveSpecialPageTarget(e){const t=typeof e=="string"?this.newTitle(e):e;if(!t||t.getNamespaceId()!==-1)return null;let i,a,n="view";const r=t.getMainDBKey().split("/").slice(1).join("/")||"";if(t.isSpecial("edit")&&r)i=r,n="edit";else if(t.isSpecial("talkpage")&&r){const o=t.newTitle(r).getTalkPage();if(!o)return null;i=o.getPrefixedDBKey()}else if(t.isSpecial("mypage"))i=t.newTitle(this.ctx.wiki.userInfo.name,2).getPrefixedDBKey()+(r?`/${r}`:"");else if(t.isSpecial("mytalk"))i=t.newTitle(this.ctx.wiki.userInfo.name,3).getPrefixedDBKey()+(r?`/${r}`:"");else if(t.isSpecial("newsection")&&r)i=r,a="new",n="edit";else return null;return{title:new this.Title(i),section:a,action:n}}isWikiLink(e){return e.startsWith(this.wikiArticleBaseUrl)||e.startsWith(this.wikiIndexPhpUrl)||e.startsWith(`${this.wikiBaseUrl}/?`)}validateHrefAttr(e){return typeof e!="string"?!1:!Ve.REG_SKIPPED_HREF.test(e)}parseWikiLink(e){if(!e||typeof e=="string"&&!this.validateHrefAttr(e))return null;const t=gi(e);if(!this.isWikiLink(t.toString()))return null;const i=t.searchParams,a=t.hash.replace("#",""),n=i.get("action")||"view",r=i.get("title")||"",o=parseInt(i.get("curid")||"0",10),c=parseInt(i.get("oldid")||"0",10);let l=r||(()=>{try{return decodeURIComponent(t.pathname.substring(this.wikiArticlePath.length))}catch(y){return this.logger.error("parseLink",t,y),""}})();l.endsWith("index.php")&&(l="");let d,p,g;if(c)g=c;else if(o)p=o;else if(l)d=this.newTitle(l);else if(t.origin+t.pathname===this.ctx.wiki.landingPageUrl)d=this.newMainPageTitle();else return null;return{title:d,pageId:p,revId:g,url:t,params:i,hash:a,action:n}}};Ve.inject=["wiki"],Ve.REG_SKIPPED_HREF=/^(#|javascript:|vbscript:|file:)/i;let Yt=Ve;const ur=s=>typeof s=="function";async function hr(s){return ur(s)?await s():s}var dr=Object.create,ps=Object.defineProperty,fr=Object.getOwnPropertyDescriptor,ki=(s,e)=>(e=Symbol[s])?e:Symbol.for("Symbol."+s),xi=s=>{throw TypeError(s)},pr=(s,e,t)=>e in s?ps(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,mr=(s,e)=>ps(s,"name",{value:e,configurable:!0}),gr=s=>[,,,dr(s?.[ki("metadata")]??null)],yr=["class","method","getter","setter","accessor","field","value","get","set"],Si=s=>s!==void 0&&typeof s!="function"?xi("Function expected"):s,wr=(s,e,t,i,a)=>({kind:yr[s],name:e,metadata:i,addInitializer:n=>t._?xi("Already initialized"):a.push(Si(n||null))}),br=(s,e)=>pr(e,ki("metadata"),s[3]),vr=(s,e,t,i)=>{for(var a=0,n=s[e>>1],r=n&&n.length;a<r;a++)n[a].call(t);return i},_r=(s,e,t,i,a,n)=>{var r,o,c,l=e&7,d=!1,p=0,g=s[p]||(s[p]=[]),y=l&&(a=a.prototype,l<5&&(l>3||!d)&&fr(a,t));mr(a,t);for(var b=i.length-1;b>=0;b--)c=wr(l,t,o={},s[3],g),r=(0,i[b])(a,c),o._=1,Si(r)&&(a=r);return br(s,a),y&&ps(a,t,y),d?l^4?n:y:a},Ri,ms,Ai;Ri=[ve(["storage"])];class gt extends(Ai=Ee){constructor(e){super(e,"preferences",!0),this.ctx=e,this.db=void 0,this.customRegistries=[],this.categoryDefinitions=[],this._defaultPreferences={},this.db=e.storage.createDatabse("preferences",1/0)}get logger(){return this.ctx.logger("PREFERENCES")}async start(){this.defineCategory({name:"general",label:"General",description:"General settings"}),this.defineCategory({name:"edit",label:"Editing",description:"Settings related to editing content"})}async get(e,t){t??=()=>{const a=this.getDefaultValue(e);return this.logger.debug(e,`(fallback value: ${a})`),a};const i=await this.db.get(e,void 0);return i!==null?i:await hr(t)}getDefaultValue(e){return this._defaultPreferences[e]??=this.loadDefaultConfigs()[e]}set(e,t){const i=this.getDefaultValue(e);return t===i?this.db.delete(e):this.db.set(e,t)}async getAll(){const e=this.loadDefaultConfigs();for await(const[t,i]of this.db.entries())t!=="_touched"&&(e[t]=i.value);return e}async getExportable(){const e=await this.getAll(),t=this.loadDefaultConfigs(),i={};return Object.entries(t).forEach(([a,n])=>{const r=e[a];r!==n&&(i[a]=r)}),i}loadDefaultConfigs(){const e={};return this.getConfigRegistries().forEach(t=>{try{const i=t.schema({});Object.entries(i).forEach(([a,n])=>{e[a]=n})}catch{}}),Object.entries(e).forEach(([t,i])=>{this._defaultPreferences[t]=i}),e}registerCustomConfig(e,t,i){return this.customRegistries.push({name:e,schema:t,category:i}),this}getConfigRegistries(e){return Array.from(this.ctx.registry.entries()).map(([t])=>t===null?{name:"@root",schema:$e?.PreferencesSchema||null}:{name:t.name,schema:t?.PreferencesSchema||null}).filter(t=>t.schema!==null).map(t=>({...t,category:t.schema.meta.category||"general"})).concat(this.customRegistries).filter(t=>!e||t.category===e)}defineCategory(e){const t=this.categoryDefinitions.findIndex(i=>i.name===e.name);return t<0?this.categoryDefinitions.push(e):this.categoryDefinitions[t]=e,this.categoryDefinitions.sort((i,a)=>(i.index??0)-(a.index??0)),this}getConfigCategories(){return this.categoryDefinitions}}ms=gr(Ai);gt=_r(ms,0,"PreferencesService",Ri,gt);vr(ms,1,gt);var yt=(s=>(s.ANALYTICS_API_BASE="https://analytics.ipe.wiki/api",s.ANALYTICS_DASH_URL="https://analytics.ipe.wiki",s.GITHUB_URL="https://github.com/inpageedit/inpageedit-next",s.HOME_URL="https://www.ipe.wiki/",s.UPDATE_LOGS_URL="https://www.ipe.wiki/changelogs/",s))(yt||{});/**
 * ✏️ InPageEdit NEXT
 *
 * 🚀 Modular, Extensible Supercharged Plugin for MediaWiki
 *
 * @author dragon-fish <dragon-fish@qq.com>
 * @license MIT
 * @see https://github.com/inpageedit/inpageedit-next
 * @see https://www.ipe.wiki/
 */var le,Pi,Ti,Oi,Ci;const Ye=class Ye extends Y{constructor(t){super({name:"InPageEdit"});Ue(this,le);this.version="0.10.0",this.Endpoints=yt,this.schema=Ft,this.config=We(Ye.DEFAULT_CONFIG,t),this.logger=Xa({name:"IPE",color:"#33aaff",level:this.config.logLevel}),De(this,le,Pi).call(this),De(this,le,Oi).call(this),De(this,le,Ci).call(this)}async useScope(t){const{promise:i,resolve:a}=Zt();return this.inject(t,n=>{a(n)}),i}};le=new WeakSet,Pi=async function(){this.plugin(hn,this.config.apiConfigs),this.plugin(pt),this.plugin(En),this.plugin(Vn),this.plugin(gt),this.plugin(or),this.plugin(mt),this.plugin(Vt),this.plugin(Yt),De(this,le,Ti).call(this,["api","currentPage","resourceLoader","modal","preferences","storage","wikiPage","wikiTitle","wiki","getUrl","getSciprtUrl","getMainpageUrl"])},Ti=function(t){if(typeof t=="string"&&(t=[t]),!Array.isArray(t)||t.length===0)return this;for(const i of t){const a=this[Ye.internal][i];a?.type==="service"&&(a.builtin=!0)}return this},Oi=async function(){[ue(async()=>{const{PluginInArticleLinks:t}=await import("./index-2mNdeL-V.CZDMalPt.js");return{PluginInArticleLinks:t}},__vite__mapDeps([0,1,2,3])).then(({PluginInArticleLinks:t})=>t),ue(async()=>{const{PluginPreferencesUI:t}=await import("./index-DqJUIV2e.DCscgUMz.js");return{PluginPreferencesUI:t}},__vite__mapDeps([4,3])).then(({PluginPreferencesUI:t})=>t),ue(async()=>{const{PluginQuickEdit:t}=await import("./index-ByJfEsN8.DoN5JK2h.js");return{PluginQuickEdit:t}},__vite__mapDeps([5,6,1,7,8,9,10,3])).then(({PluginQuickEdit:t})=>t),ue(async()=>{const{PluginQuickDelete:t}=await import("./index-ByzgI28q.BSGWYbOs.js");return{PluginQuickDelete:t}},__vite__mapDeps([11,6,1,7,8,10,3])).then(({PluginQuickDelete:t})=>t),ue(async()=>{const{PluginQuickMove:t}=await import("./index-CAiGct8U.C6RwRzpC.js");return{PluginQuickMove:t}},__vite__mapDeps([12,13,9,8,3])).then(({PluginQuickMove:t})=>t),ue(async()=>{const{PluginQuickPreview:t}=await import("./index-BnAhw94L.DqWQjsd7.js");return{PluginQuickPreview:t}},__vite__mapDeps([14,1,6,3])).then(({PluginQuickPreview:t})=>t),ue(async()=>{const{PluginQuickDiff:t}=await import("./index-eOIVMf9E.CuB-Fn_B.js");return{PluginQuickDiff:t}},__vite__mapDeps([15,2,1,7,3])).then(({PluginQuickDiff:t})=>t),ue(async()=>{const{PluginQuickRedirect:t}=await import("./index-Cx-YiN1j.BDhhNH6R.js");return{PluginQuickRedirect:t}},__vite__mapDeps([16,13,8,9,3])).then(({PluginQuickRedirect:t})=>t),ue(async()=>{const{PluginToolbox:t}=await import("./index-BR6gK_ki.BPYyoMk-.js");return{PluginToolbox:t}},__vite__mapDeps([17,1,3])).then(({PluginToolbox:t})=>t)].forEach(async t=>{this.plugin(await t)})},Ci=async function(){this.inject(["resourceLoader"],t=>{this.config.autoloadStyles&&t.resourceLoader.loadStyle(import.meta.resolve("./style.css"))})},Ye.DEFAULT_CONFIG={apiConfigs:{},legacyPreferences:{},logLevel:Js.info,autoloadStyles:!0};let $e=Ye;function Er(s){return s.charAt(0).toLowerCase()+s.slice(1)}function kr(s){return Er(s).replace(/-/g,"_").replace(/.[A-Z]+/g,e=>e[0]+"_"+e.slice(1).toLowerCase())}var Ze;const bt=class bt{constructor(e,t=void 0,i){Ue(this,Ze);this.ctx=e,this.disposeHandlers=[],this.name=i||"",this.config=t||{};const{promise:a,resolve:n,reject:r}=Promise.withResolvers();queueMicrotask(()=>{this.name||(this.name=this.constructor.name);try{const o=this.start();o&&typeof o.then=="function"?o.then(()=>n()).catch(c=>{this.logger.error("start() returns a rejected promise",c),r(c)}):n()}catch(o){this.logger.error("start() threw synchronously",o),r(o)}a.then(()=>{this.logger.debug("started")}),a.catch(o=>{this.logger.error("start failed",o),this.ctx.scope.dispose()})}),this.ctx.once("dispose",()=>{this.disposeHandlers.forEach(o=>o(this.ctx)),this.stop(),this.logger.debug("disposed")})}start(){}stop(){}addDisposeHandler(e){this.disposeHandlers.push(e)}removeDisposeHandler(e){this.disposeHandlers=this.disposeHandlers.filter(t=>t!==e)}set name(e){q(this,Ze,kr(e).toUpperCase())}get name(){return P(this,Ze)}get logger(){return this.ctx.logger(this.name)}};Ze=new WeakMap,bt.inject=[],bt.reusable=!1;let Ns=bt;window.RLQ||=[];window.__IPE_MODULES__||=[];Sr("InPageEdit#autoload",()=>{const s=Li();s&&xr({baseURL:s,CoreClass:$e})});async function xr(s={baseURL:Li(),CoreClass:$e}){const{baseURL:e,CoreClass:t}=s;typeof window?.ipe?.stop=="function"&&await window.ipe.stop();const i=window.InPageEdit||{},a=new t({apiConfigs:{baseURL:e},legacyPreferences:i?.myPreferences||{}});if(window.InPageEdit=t,window.ipe=a,await a.start(),window.RLQ.push(()=>{mw.hook("InPageEdit.ready").fire(a)}),Array.isArray(window.__IPE_MODULES__)){const n=[];for(;window.__IPE_MODULES__.length;)try{const r=window.__IPE_MODULES__.shift();typeof r=="function"&&r?.(a),n.push(r)}catch{}window.__IPE_MODULES__={push:r=>{typeof r=="function"&&r(a),n.push(r)}},a.on("dispose",()=>{window.__IPE_MODULES__=n})}a.logger("AUTOLOAD").info(`
    ____      ____                   ______    ___ __ 
   /  _/___  / __ \\____ _____ ____  / ____/___/ (_) /_
   / // __ \\/ /_/ / __ \`/ __ \`/ _ \\/ __/ / __  / / __/
 _/ // / / / ____/ /_/ / /_/ /  __/ /___/ /_/ / / /_  
/___/_/ /_/_/    \\__,_/\\__, /\\___/_____/\\__,_/_/\\__/  
                      /____/                v`+a.version+`
- Wiki API Endpoint: ${e}
- Documentation:     ${yt.HOME_URL}
- Bug Reports:       ${yt.GITHUB_URL}`)}function Li(){const s=document.querySelector('meta[name="generator"][content^="MediaWiki"]')!==null,e=document.querySelector('link[rel="EditURI"]')?.href?.split("?")[0];return s&&e?e:void 0}function Sr(s,e){const t=Symbol.for(s);return window[t]?!1:(window[t]=!0,e(),!0)}var $s=(s,e,t)=>(i,a)=>{let n=-1;return r(0);async function r(o){if(o<=n)throw new Error("next() called multiple times");n=o;let c,l=!1,d;if(s[o]?(d=s[o][0][0],i.req.routeIndex=o):d=o===s.length&&a||void 0,d)try{c=await d(i,()=>r(o+1))}catch(p){if(p instanceof Error&&e)i.error=p,c=await e(p,i),l=!0;else throw p}else i.finalized===!1&&t&&(c=await t(i));return c&&(i.finalized===!1||l)&&(i.res=c),i}},Rr=Symbol(),Ar=async(s,e=Object.create(null))=>{const{all:t=!1,dot:i=!1}=e,n=(s instanceof Di?s.raw.headers:s.headers).get("Content-Type");return n?.startsWith("multipart/form-data")||n?.startsWith("application/x-www-form-urlencoded")?Pr(s,{all:t,dot:i}):{}};async function Pr(s,e){const t=await s.formData();return t?Tr(t,e):{}}function Tr(s,e){const t=Object.create(null);return s.forEach((i,a)=>{e.all||a.endsWith("[]")?Or(t,a,i):t[a]=i}),e.dot&&Object.entries(t).forEach(([i,a])=>{i.includes(".")&&(Cr(t,i,a),delete t[i])}),t}var Or=(s,e,t)=>{s[e]!==void 0?Array.isArray(s[e])?s[e].push(t):s[e]=[s[e],t]:e.endsWith("[]")?s[e]=[t]:s[e]=t},Cr=(s,e,t)=>{let i=s;const a=e.split(".");a.forEach((n,r)=>{r===a.length-1?i[n]=t:((!i[n]||typeof i[n]!="object"||Array.isArray(i[n])||i[n]instanceof File)&&(i[n]=Object.create(null)),i=i[n])})},Ii=s=>{const e=s.split("/");return e[0]===""&&e.shift(),e},Lr=s=>{const{groups:e,path:t}=Ir(s),i=Ii(t);return Mr(i,e)},Ir=s=>{const e=[];return s=s.replace(/\{[^}]+\}/g,(t,i)=>{const a=`@${i}`;return e.push([a,t]),a}),{groups:e,path:s}},Mr=(s,e)=>{for(let t=e.length-1;t>=0;t--){const[i]=e[t];for(let a=s.length-1;a>=0;a--)if(s[a].includes(i)){s[a]=s[a].replace(i,e[t][1]);break}}return s},lt={},Nr=(s,e)=>{if(s==="*")return"*";const t=s.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);if(t){const i=`${s}#${e}`;return lt[i]||(t[2]?lt[i]=e&&e[0]!==":"&&e[0]!=="*"?[i,t[1],new RegExp(`^${t[2]}(?=/${e})`)]:[s,t[1],new RegExp(`^${t[2]}$`)]:lt[i]=[s,t[1],!0]),lt[i]}return null},gs=(s,e)=>{try{return e(s)}catch{return s.replace(/(?:%[0-9A-Fa-f]{2})+/g,t=>{try{return e(t)}catch{return t}})}},$r=s=>gs(s,decodeURI),Mi=s=>{const e=s.url,t=e.indexOf("/",e.indexOf(":")+4);let i=t;for(;i<e.length;i++){const a=e.charCodeAt(i);if(a===37){const n=e.indexOf("?",i),r=e.slice(t,n===-1?void 0:n);return $r(r.includes("%25")?r.replace(/%25/g,"%2525"):r)}else if(a===63)break}return e.slice(t,i)},Ur=s=>{const e=Mi(s);return e.length>1&&e.at(-1)==="/"?e.slice(0,-1):e},Ae=(s,e,...t)=>(t.length&&(e=Ae(e,...t)),`${s?.[0]==="/"?"":"/"}${s}${e==="/"?"":`${s?.at(-1)==="/"?"":"/"}${e?.[0]==="/"?e.slice(1):e}`}`),Ni=s=>{if(s.charCodeAt(s.length-1)!==63||!s.includes(":"))return null;const e=s.split("/"),t=[];let i="";return e.forEach(a=>{if(a!==""&&!/\:/.test(a))i+="/"+a;else if(/\:/.test(a))if(/\?/.test(a)){t.length===0&&i===""?t.push("/"):t.push(i);const n=a.replace("?","");i+="/"+n,t.push(i)}else i+="/"+a}),t.filter((a,n,r)=>r.indexOf(a)===n)},Ct=s=>/[%+]/.test(s)?(s.indexOf("+")!==-1&&(s=s.replace(/\+/g," ")),s.indexOf("%")!==-1?gs(s,Ui):s):s,$i=(s,e,t)=>{let i;if(!t&&e&&!/[%+]/.test(e)){let r=s.indexOf(`?${e}`,8);for(r===-1&&(r=s.indexOf(`&${e}`,8));r!==-1;){const o=s.charCodeAt(r+e.length+1);if(o===61){const c=r+e.length+2,l=s.indexOf("&",c);return Ct(s.slice(c,l===-1?void 0:l))}else if(o==38||isNaN(o))return"";r=s.indexOf(`&${e}`,r+1)}if(i=/[%+]/.test(s),!i)return}const a={};i??=/[%+]/.test(s);let n=s.indexOf("?",8);for(;n!==-1;){const r=s.indexOf("&",n+1);let o=s.indexOf("=",n);o>r&&r!==-1&&(o=-1);let c=s.slice(n+1,o===-1?r===-1?void 0:r:o);if(i&&(c=Ct(c)),n=r,c==="")continue;let l;o===-1?l="":(l=s.slice(o+1,r===-1?void 0:r),i&&(l=Ct(l))),t?(a[c]&&Array.isArray(a[c])||(a[c]=[]),a[c].push(l)):a[c]??=l}return e?a[e]:a},Dr=$i,jr=(s,e)=>$i(s,e,!0),Ui=decodeURIComponent,Us=s=>gs(s,Ui),Di=class{raw;#t;#e;routeIndex=0;path;bodyCache={};constructor(s,e="/",t=[[]]){this.raw=s,this.path=e,this.#e=t,this.#t={}}param(s){return s?this.#s(s):this.#n()}#s(s){const e=this.#e[0][this.routeIndex][1][s],t=this.#i(e);return t&&/\%/.test(t)?Us(t):t}#n(){const s={},e=Object.keys(this.#e[0][this.routeIndex][1]);for(const t of e){const i=this.#i(this.#e[0][this.routeIndex][1][t]);i!==void 0&&(s[t]=/\%/.test(i)?Us(i):i)}return s}#i(s){return this.#e[1]?this.#e[1][s]:s}query(s){return Dr(this.url,s)}queries(s){return jr(this.url,s)}header(s){if(s)return this.raw.headers.get(s)??void 0;const e={};return this.raw.headers.forEach((t,i)=>{e[i]=t}),e}async parseBody(s){return this.bodyCache.parsedBody??=await Ar(this,s)}#a=s=>{const{bodyCache:e,raw:t}=this,i=e[s];if(i)return i;const a=Object.keys(e)[0];return a?e[a].then(n=>(a==="json"&&(n=JSON.stringify(n)),new Response(n)[s]())):e[s]=t[s]()};json(){return this.#a("text").then(s=>JSON.parse(s))}text(){return this.#a("text")}arrayBuffer(){return this.#a("arrayBuffer")}blob(){return this.#a("blob")}formData(){return this.#a("formData")}addValidatedData(s,e){this.#t[s]=e}valid(s){return this.#t[s]}get url(){return this.raw.url}get method(){return this.raw.method}get[Rr](){return this.#e}get matchedRoutes(){return this.#e[0].map(([[,s]])=>s)}get routePath(){return this.#e[0].map(([[,s]])=>s)[this.routeIndex].path}},Br={Stringify:1},ji=async(s,e,t,i,a)=>{typeof s=="object"&&!(s instanceof String)&&(s instanceof Promise||(s=s.toString()),s instanceof Promise&&(s=await s));const n=s.callbacks;return n?.length?(a?a[0]+=s:a=[s],Promise.all(n.map(o=>o({phase:e,buffer:a,context:i}))).then(o=>Promise.all(o.filter(Boolean).map(c=>ji(c,e,!1,i,a))).then(()=>a[0]))):Promise.resolve(s)},Fr="text/plain; charset=UTF-8",Lt=(s,e)=>({"Content-Type":s,...e}),Hr=class{#t;#e;env={};#s;finalized=!1;error;#n;#i;#a;#u;#l;#c;#o;#h;#d;constructor(s,e){this.#t=s,e&&(this.#i=e.executionCtx,this.env=e.env,this.#c=e.notFoundHandler,this.#d=e.path,this.#h=e.matchResult)}get req(){return this.#e??=new Di(this.#t,this.#d,this.#h),this.#e}get event(){if(this.#i&&"respondWith"in this.#i)return this.#i;throw Error("This context has no FetchEvent")}get executionCtx(){if(this.#i)return this.#i;throw Error("This context has no ExecutionContext")}get res(){return this.#a||=new Response(null,{headers:this.#o??=new Headers})}set res(s){if(this.#a&&s){s=new Response(s.body,s);for(const[e,t]of this.#a.headers.entries())if(e!=="content-type")if(e==="set-cookie"){const i=this.#a.headers.getSetCookie();s.headers.delete("set-cookie");for(const a of i)s.headers.append("set-cookie",a)}else s.headers.set(e,t)}this.#a=s,this.finalized=!0}render=(...s)=>(this.#l??=e=>this.html(e),this.#l(...s));setLayout=s=>this.#u=s;getLayout=()=>this.#u;setRenderer=s=>{this.#l=s};header=(s,e,t)=>{this.finalized&&(this.#a=new Response(this.#a.body,this.#a));const i=this.#a?this.#a.headers:this.#o??=new Headers;e===void 0?i.delete(s):t?.append?i.append(s,e):i.set(s,e)};status=s=>{this.#n=s};set=(s,e)=>{this.#s??=new Map,this.#s.set(s,e)};get=s=>this.#s?this.#s.get(s):void 0;get var(){return this.#s?Object.fromEntries(this.#s):{}}#r(s,e,t){const i=this.#a?new Headers(this.#a.headers):this.#o??new Headers;if(typeof e=="object"&&"headers"in e){const n=e.headers instanceof Headers?e.headers:new Headers(e.headers);for(const[r,o]of n)r.toLowerCase()==="set-cookie"?i.append(r,o):i.set(r,o)}if(t)for(const[n,r]of Object.entries(t))if(typeof r=="string")i.set(n,r);else{i.delete(n);for(const o of r)i.append(n,o)}const a=typeof e=="number"?e:e?.status??this.#n;return new Response(s,{status:a,headers:i})}newResponse=(...s)=>this.#r(...s);body=(s,e,t)=>this.#r(s,e,t);text=(s,e,t)=>!this.#o&&!this.#n&&!e&&!t&&!this.finalized?new Response(s):this.#r(s,e,Lt(Fr,t));json=(s,e,t)=>this.#r(JSON.stringify(s),e,Lt("application/json",t));html=(s,e,t)=>{const i=a=>this.#r(a,e,Lt("text/html; charset=UTF-8",t));return typeof s=="object"?ji(s,Br.Stringify,!1,{}).then(i):i(s)};redirect=(s,e)=>{const t=String(s);return this.header("Location",/[^\x00-\xFF]/.test(t)?encodeURI(t):t),this.newResponse(null,e??302)};notFound=()=>(this.#c??=()=>new Response,this.#c(this))},$="ALL",Wr="all",zr=["get","post","put","delete","options","patch"],Bi="Can not add a route since the matcher is already built.",Fi=class extends Error{},qr="__COMPOSED_HANDLER",Gr=s=>s.text("404 Not Found",404),Ds=(s,e)=>{if("getResponse"in s){const t=s.getResponse();return e.newResponse(t.body,t)}return console.error(s),e.text("Internal Server Error",500)},Hi=class{get;post;put;delete;options;patch;all;on;use;router;getPath;_basePath="/";#t="/";routes=[];constructor(e={}){[...zr,Wr].forEach(n=>{this[n]=(r,...o)=>(typeof r=="string"?this.#t=r:this.#n(n,this.#t,r),o.forEach(c=>{this.#n(n,this.#t,c)}),this)}),this.on=(n,r,...o)=>{for(const c of[r].flat()){this.#t=c;for(const l of[n].flat())o.map(d=>{this.#n(l.toUpperCase(),this.#t,d)})}return this},this.use=(n,...r)=>(typeof n=="string"?this.#t=n:(this.#t="*",r.unshift(n)),r.forEach(o=>{this.#n($,this.#t,o)}),this);const{strict:i,...a}=e;Object.assign(this,a),this.getPath=i??!0?e.getPath??Mi:Ur}#e(){const e=new Hi({router:this.router,getPath:this.getPath});return e.errorHandler=this.errorHandler,e.#s=this.#s,e.routes=this.routes,e}#s=Gr;errorHandler=Ds;route(e,t){const i=this.basePath(e);return t.routes.map(a=>{let n;t.errorHandler===Ds?n=a.handler:(n=async(r,o)=>(await $s([],t.errorHandler)(r,()=>a.handler(r,o))).res,n[qr]=a.handler),i.#n(a.method,a.path,n)}),this}basePath(e){const t=this.#e();return t._basePath=Ae(this._basePath,e),t}onError=e=>(this.errorHandler=e,this);notFound=e=>(this.#s=e,this);mount(e,t,i){let a,n;i&&(typeof i=="function"?n=i:(n=i.optionHandler,i.replaceRequest===!1?a=c=>c:a=i.replaceRequest));const r=n?c=>{const l=n(c);return Array.isArray(l)?l:[l]}:c=>{let l;try{l=c.executionCtx}catch{}return[c.env,l]};a||=(()=>{const c=Ae(this._basePath,e),l=c==="/"?0:c.length;return d=>{const p=new URL(d.url);return p.pathname=p.pathname.slice(l)||"/",new Request(p,d)}})();const o=async(c,l)=>{const d=await t(a(c.req.raw),...r(c));if(d)return d;await l()};return this.#n($,Ae(e,"*"),o),this}#n(e,t,i){e=e.toUpperCase(),t=Ae(this._basePath,t);const a={basePath:this._basePath,path:t,method:e,handler:i};this.router.add(e,t,[i,a]),this.routes.push(a)}#i(e,t){if(e instanceof Error)return this.errorHandler(e,t);throw e}#a(e,t,i,a){if(a==="HEAD")return(async()=>new Response(null,await this.#a(e,t,i,"GET")))();const n=this.getPath(e,{env:i}),r=this.router.match(a,n),o=new Hr(e,{path:n,matchResult:r,env:i,executionCtx:t,notFoundHandler:this.#s});if(r[0].length===1){let l;try{l=r[0][0][0][0](o,async()=>{o.res=await this.#s(o)})}catch(d){return this.#i(d,o)}return l instanceof Promise?l.then(d=>d||(o.finalized?o.res:this.#s(o))).catch(d=>this.#i(d,o)):l??this.#s(o)}const c=$s(r[0],this.errorHandler,this.#s);return(async()=>{try{const l=await c(o);if(!l.finalized)throw new Error("Context is not finalized. Did you forget to return a Response object or `await next()`?");return l.res}catch(l){return this.#i(l,o)}})()}fetch=(e,...t)=>this.#a(e,t[1],t[0],e.method);request=(e,t,i,a)=>e instanceof Request?this.fetch(t?new Request(e,t):e,i,a):(e=e.toString(),this.fetch(new Request(/^https?:\/\//.test(e)?e:`http://localhost${Ae("/",e)}`,t),i,a));fire=()=>{addEventListener("fetch",e=>{e.respondWith(this.#a(e.request,e,void 0,e.request.method))})}},Wi=[];function Kr(s,e){const t=this.buildAllMatchers(),i=(a,n)=>{const r=t[a]||t[$],o=r[2][n];if(o)return o;const c=n.match(r[0]);if(!c)return[[],Wi];const l=c.indexOf("",1);return[r[1][l],c]};return this.match=i,i(s,e)}var wt="[^/]+",Ge=".*",Ke="(?:|/.*)",Pe=Symbol(),Vr=new Set(".\\+*[^]$()");function Yr(s,e){return s.length===1?e.length===1?s<e?-1:1:-1:e.length===1||s===Ge||s===Ke?1:e===Ge||e===Ke?-1:s===wt?1:e===wt?-1:s.length===e.length?s<e?-1:1:e.length-s.length}var Qt=class{#t;#e;#s=Object.create(null);insert(e,t,i,a,n){if(e.length===0){if(this.#t!==void 0)throw Pe;if(n)return;this.#t=t;return}const[r,...o]=e,c=r==="*"?o.length===0?["","",Ge]:["","",wt]:r==="/*"?["","",Ke]:r.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);let l;if(c){const d=c[1];let p=c[2]||wt;if(d&&c[2]&&(p===".*"||(p=p.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:"),/\((?!\?:)/.test(p))))throw Pe;if(l=this.#s[p],!l){if(Object.keys(this.#s).some(g=>g!==Ge&&g!==Ke))throw Pe;if(n)return;l=this.#s[p]=new Qt,d!==""&&(l.#e=a.varIndex++)}!n&&d!==""&&i.push([d,l.#e])}else if(l=this.#s[r],!l){if(Object.keys(this.#s).some(d=>d.length>1&&d!==Ge&&d!==Ke))throw Pe;if(n)return;l=this.#s[r]=new Qt}l.insert(o,t,i,a,n)}buildRegExpStr(){const t=Object.keys(this.#s).sort(Yr).map(i=>{const a=this.#s[i];return(typeof a.#e=="number"?`(${i})@${a.#e}`:Vr.has(i)?`\\${i}`:i)+a.buildRegExpStr()});return typeof this.#t=="number"&&t.unshift(`#${this.#t}`),t.length===0?"":t.length===1?t[0]:"(?:"+t.join("|")+")"}},Qr=class{#t={varIndex:0};#e=new Qt;insert(s,e,t){const i=[],a=[];for(let r=0;;){let o=!1;if(s=s.replace(/\{[^}]+\}/g,c=>{const l=`@\\${r}`;return a[r]=[l,c],r++,o=!0,l}),!o)break}const n=s.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let r=a.length-1;r>=0;r--){const[o]=a[r];for(let c=n.length-1;c>=0;c--)if(n[c].indexOf(o)!==-1){n[c]=n[c].replace(o,a[r][1]);break}}return this.#e.insert(n,e,i,this.#t,t),i}buildRegExp(){let s=this.#e.buildRegExpStr();if(s==="")return[/^$/,[],[]];let e=0;const t=[],i=[];return s=s.replace(/#(\d+)|@(\d+)|\.\*\$/g,(a,n,r)=>n!==void 0?(t[++e]=Number(n),"$()"):(r!==void 0&&(i[Number(r)]=++e),"")),[new RegExp(`^${s}`),t,i]}},Xr=[/^$/,[],Object.create(null)],zi=Object.create(null);function qi(s){return zi[s]??=new RegExp(s==="*"?"":`^${s.replace(/\/\*$|([.\\+*[^\]$()])/g,(e,t)=>t?`\\${t}`:"(?:|/.*)")}$`)}function Jr(){zi=Object.create(null)}function Zr(s){const e=new Qr,t=[];if(s.length===0)return Xr;const i=s.map(l=>[!/\*|\/:/.test(l[0]),...l]).sort(([l,d],[p,g])=>l?1:p?-1:d.length-g.length),a=Object.create(null);for(let l=0,d=-1,p=i.length;l<p;l++){const[g,y,b]=i[l];g?a[y]=[b.map(([O])=>[O,Object.create(null)]),Wi]:d++;let k;try{k=e.insert(y,d,g)}catch(O){throw O===Pe?new Fi(y):O}g||(t[d]=b.map(([O,A])=>{const z=Object.create(null);for(A-=1;A>=0;A--){const[h,u]=k[A];z[h]=u}return[O,z]}))}const[n,r,o]=e.buildRegExp();for(let l=0,d=t.length;l<d;l++)for(let p=0,g=t[l].length;p<g;p++){const y=t[l][p]?.[1];if(!y)continue;const b=Object.keys(y);for(let k=0,O=b.length;k<O;k++)y[b[k]]=o[y[b[k]]]}const c=[];for(const l in r)c[l]=t[r[l]];return[n,c,a]}function Se(s,e){if(s){for(const t of Object.keys(s).sort((i,a)=>a.length-i.length))if(qi(t).test(e))return[...s[t]]}}var eo=class{name="RegExpRouter";#t;#e;constructor(){this.#t={[$]:Object.create(null)},this.#e={[$]:Object.create(null)}}add(s,e,t){const i=this.#t,a=this.#e;if(!i||!a)throw new Error(Bi);i[s]||[i,a].forEach(o=>{o[s]=Object.create(null),Object.keys(o[$]).forEach(c=>{o[s][c]=[...o[$][c]]})}),e==="/*"&&(e="*");const n=(e.match(/\/:/g)||[]).length;if(/\*$/.test(e)){const o=qi(e);s===$?Object.keys(i).forEach(c=>{i[c][e]||=Se(i[c],e)||Se(i[$],e)||[]}):i[s][e]||=Se(i[s],e)||Se(i[$],e)||[],Object.keys(i).forEach(c=>{(s===$||s===c)&&Object.keys(i[c]).forEach(l=>{o.test(l)&&i[c][l].push([t,n])})}),Object.keys(a).forEach(c=>{(s===$||s===c)&&Object.keys(a[c]).forEach(l=>o.test(l)&&a[c][l].push([t,n]))});return}const r=Ni(e)||[e];for(let o=0,c=r.length;o<c;o++){const l=r[o];Object.keys(a).forEach(d=>{(s===$||s===d)&&(a[d][l]||=[...Se(i[d],l)||Se(i[$],l)||[]],a[d][l].push([t,n-c+o+1]))})}}match=Kr;buildAllMatchers(){const s=Object.create(null);return Object.keys(this.#e).concat(Object.keys(this.#t)).forEach(e=>{s[e]||=this.#s(e)}),this.#t=this.#e=void 0,Jr(),s}#s(s){const e=[];let t=s===$;return[this.#t,this.#e].forEach(i=>{const a=i[s]?Object.keys(i[s]).map(n=>[n,i[s][n]]):[];a.length!==0?(t||=!0,e.push(...a)):s!==$&&e.push(...Object.keys(i[$]).map(n=>[n,i[$][n]]))}),t?Zr(e):null}},to=class{name="SmartRouter";#t=[];#e=[];constructor(s){this.#t=s.routers}add(s,e,t){if(!this.#e)throw new Error(Bi);this.#e.push([s,e,t])}match(s,e){if(!this.#e)throw new Error("Fatal error");const t=this.#t,i=this.#e,a=t.length;let n=0,r;for(;n<a;n++){const o=t[n];try{for(let c=0,l=i.length;c<l;c++)o.add(...i[c]);r=o.match(s,e)}catch(c){if(c instanceof Fi)continue;throw c}this.match=o.match.bind(o),this.#t=[o],this.#e=void 0;break}if(n===a)throw new Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,r}get activeRouter(){if(this.#e||this.#t.length!==1)throw new Error("No active router has been determined yet.");return this.#t[0]}},Be=Object.create(null),Gi=class{#t;#e;#s;#n=0;#i=Be;constructor(e,t,i){if(this.#e=i||Object.create(null),this.#t=[],e&&t){const a=Object.create(null);a[e]={handler:t,possibleKeys:[],score:0},this.#t=[a]}this.#s=[]}insert(e,t,i){this.#n=++this.#n;let a=this;const n=Lr(t),r=[];for(let o=0,c=n.length;o<c;o++){const l=n[o],d=n[o+1],p=Nr(l,d),g=Array.isArray(p)?p[0]:l;if(g in a.#e){a=a.#e[g],p&&r.push(p[1]);continue}a.#e[g]=new Gi,p&&(a.#s.push(p),r.push(p[1])),a=a.#e[g]}return a.#t.push({[e]:{handler:i,possibleKeys:r.filter((o,c,l)=>l.indexOf(o)===c),score:this.#n}}),a}#a(e,t,i,a){const n=[];for(let r=0,o=e.#t.length;r<o;r++){const c=e.#t[r],l=c[t]||c[$],d={};if(l!==void 0&&(l.params=Object.create(null),n.push(l),i!==Be||a&&a!==Be))for(let p=0,g=l.possibleKeys.length;p<g;p++){const y=l.possibleKeys[p],b=d[l.score];l.params[y]=a?.[y]&&!b?a[y]:i[y]??a?.[y],d[l.score]=!0}}return n}search(e,t){const i=[];this.#i=Be;let n=[this];const r=Ii(t),o=[];for(let c=0,l=r.length;c<l;c++){const d=r[c],p=c===l-1,g=[];for(let y=0,b=n.length;y<b;y++){const k=n[y],O=k.#e[d];O&&(O.#i=k.#i,p?(O.#e["*"]&&i.push(...this.#a(O.#e["*"],e,k.#i)),i.push(...this.#a(O,e,k.#i))):g.push(O));for(let A=0,z=k.#s.length;A<z;A++){const h=k.#s[A],u=k.#i===Be?{}:{...k.#i};if(h==="*"){const R=k.#e["*"];R&&(i.push(...this.#a(R,e,k.#i)),R.#i=u,g.push(R));continue}const[f,m,w]=h;if(!d&&!(w instanceof RegExp))continue;const v=k.#e[f],E=r.slice(c).join("/");if(w instanceof RegExp){const R=w.exec(E);if(R){if(u[m]=R[0],i.push(...this.#a(v,e,k.#i,u)),Object.keys(v.#e).length){v.#i=u;const ee=R[0].match(/\//)?.length??0;(o[ee]||=[]).push(v)}continue}}(w===!0||w.test(d))&&(u[m]=d,p?(i.push(...this.#a(v,e,u,k.#i)),v.#e["*"]&&i.push(...this.#a(v.#e["*"],e,u,k.#i))):(v.#i=u,g.push(v)))}}n=g.concat(o.shift()??[])}return i.length>1&&i.sort((c,l)=>c.score-l.score),[i.map(({handler:c,params:l})=>[c,l])]}},so=class{name="TrieRouter";#t;constructor(){this.#t=new Gi}add(s,e,t){const i=Ni(e);if(i){for(let a=0,n=i.length;a<n;a++)this.#t.insert(s,i[a],t);return}this.#t.insert(s,e,t)}match(s,e){return this.#t.search(s,e)}},io=class extends Hi{constructor(s={}){super(s),this.router=s.router??new to({routers:[new eo,new so]})}};const ao=new URL("https://fake.ipe.wiki/api.php"),no="InPageEdit Test Wiki",ro={mainpage:"Main_Page",base:"https://fake.ipe.wiki/",sitename:no,mainpageisdomainroot:!0,logo:"https://ipe.wiki/logo.png",generator:"MediaWiki 1.43.3",phpversion:"8.3.22",phpsapi:"fpm-fcgi",dbtype:"mysql",dbversion:"5.7.44",imagewhitelistenabled:!1,langconversion:!0,titleconversion:!0,linkprefixcharset:"",linkprefix:"",linktrail:"/^()(.*)$/sD",legaltitlechars:" %!\"$&'()*,\\-.\\/0-9:;=?@A-Z\\\\^_`a-z~\\x80-\\xFF+",invalidusernamechars:"@:>=",allunicodefixes:!1,fixarabicunicode:!0,fixmalayalamunicode:!0,case:"first-letter",lang:"zh",fallback:[{code:"zh-hans"},{code:"zh-hant"},{code:"zh-cn"},{code:"zh-tw"},{code:"zh-hk"},{code:"en"}],variants:[{code:"zh",name:"不转换"},{code:"zh-hans",name:"简体"},{code:"zh-hant",name:"繁體"},{code:"zh-cn",name:"大陆简体"},{code:"zh-hk",name:"香港繁體"},{code:"zh-tw",name:"臺灣正體"}],rtl:!1,fallback8bitEncoding:"windows-936",readonly:!1,writeapi:!0,maxarticlesize:2097152,timezone:"Asia/Shanghai",timeoffset:480,articlepath:"/wiki/$1",scriptpath:"",script:"/index.php",variantarticlepath:"/$2/$1",server:"https://fake.ipe.wiki",servername:"localhost",wikiid:"example",time:new Date().toISOString(),misermode:!1,uploadsenabled:!0,maxuploadsize:104857600,minuploadchunksize:1024,galleryoptions:{imagesPerRow:0,imageWidth:120,imageHeight:120,captionLength:!0,showBytes:!0,showDimensions:!0,mode:"traditional"},thumblimits:{0:120,1:150,2:180,3:200,4:250,5:300},imagelimits:{0:{width:320,height:240},1:{width:640,height:480},2:{width:800,height:600},3:{width:1024,height:768},4:{width:1280,height:1024},5:{width:2560,height:2048}},favicon:"https://ipe.wiki/favicon.ico",centralidlookupprovider:"local",allcentralidlookupproviders:["local"],interwikimagic:!0,magiclinks:{ISBN:!1,PMID:!1,RFC:!1},categorycollation:"pinyin-noprefix",citeresponsivereferences:!0},Ki={id:114514,name:"机智的小鱼君",groups:["interface-admin","sysop","widgeteditor","*","user","autoconfirmed"],rights:["editinterface","editsitecss","editsitejson","editsitejs","editusercss","edituserjson","edituserjs","hideuser","suppressrevision","viewsuppressed","suppressionlog","deleterevision","deletelogentry","abusefilter-hidden-log","abusefilter-hide-log","block","createaccount","delete","bigdelete","deletedhistory","deletedtext","undelete","import","importupload","move","move-subpages","move-rootuserpages","move-categorypages","patrol","autopatrol","protect","editprotected","rollback","upload","reupload","reupload-shared","unwatchedpages","autoconfirmed","editsemiprotected","apihighlimits","noratelimit","movefile","interwiki","editwidgets","read","createpage","createtalk","viewmyprivateinfo","editmyprivateinfo","editmyoptions","edit","minoredit","editmyusercss","editmyuserjson","editmyuserjs","editmyuserjsredirect","sendemail","applychangetags","changetags","editcontentmodel","viewmywatchlist","editmywatchlist","upload_by_url","skipcaptcha","unblock"],options:{minordefault:0,watchcreations:1,watchdefault:1,watchdeletion:0,watchmoves:0,watchuploads:1,language:"zh"}},oo={general:ro,specialpagealiases:[{realname:"BrokenRedirects",aliases:["受损重定向","受损重定向","損壞的重新導向","損壞的重定向頁","BrokenRedirects"]},{realname:"Deadendpages",aliases:["断链页面","斷鏈頁面","斷連頁面","断链页面","無連結頁面","斷鏈頁面","DeadendPages"]},{realname:"DoubleRedirects",aliases:["双重重定向","雙重重新導向","双重重定向","两次重定向","雙重的重新導向","雙重重定向頁面","DoubleRedirects"]},{realname:"Longpages",aliases:["长页面","長頁面","长页面","過長的頁面","長頁面","LongPages"]},{realname:"Ancientpages",aliases:["最早页面","最早頁面","最老页面","最舊頁面","最早頁面","最舊頁面","AncientPages"]},{realname:"Lonelypages",aliases:["孤立页面","孤立頁面","孤立页面","孤立頁面","LonelyPages","OrphanedPages"]},{realname:"Fewestrevisions",aliases:["最少修订页面","最少修訂頁面","版本最少页面","最少修订页面","最少修訂頁面","FewestRevisions"]},{realname:"Withoutinterwiki",aliases:["无跨wiki","无跨wiki链接页面","無跨wiki連結頁面","無跨維基連結頁面","沒有跨語言連結的頁面","WithoutInterwiki"]},{realname:"Protectedpages",aliases:["已保护页面","已保護頁面","已保护页面","受保護頁面","已保護頁面","ProtectedPages"]},{realname:"Protectedtitles",aliases:["已保护标题","已保護標題","已保护标题","受保護標題","已保護標題","ProtectedTitles"]},{realname:"Shortpages",aliases:["短页面","短頁面","短页面","過短的頁面","短頁面","ShortPages"]},{realname:"Uncategorizedcategories",aliases:["未归类分类","未歸類分類","未分类分类","未分類的分類","未歸類分類","UncategorizedCategories"]},{realname:"Uncategorizedimages",aliases:["未归类文件","未歸類文件","未歸類檔案","未分类文件","未分类图像","未分類的檔案","未分類的圖片","未歸類檔案","UncategorizedFiles","UncategorizedImages"]},{realname:"Uncategorizedpages",aliases:["未归类页面","未歸類頁面","未分类页面","未分類的頁面","未歸類頁面","UncategorizedPages"]},{realname:"Uncategorizedtemplates",aliases:["未归类模板","未歸類模板","未分类模板","未分類的模板","未歸類模板","UncategorizedTemplates"]},{realname:"Unusedcategories",aliases:["未使用分类","未使用分類","未使用分类","未使用的分類","未使用分類","UnusedCategories"]},{realname:"Unusedimages",aliases:["未使用文件","未使用檔案","未使用文件","未使用图像","未使用的檔案","未使用檔案","UnusedFiles","UnusedImages"]},{realname:"Unusedtemplates",aliases:["未使用模板","未使用模板","未使用的模板","未使用模板","UnusedTemplates"]},{realname:"Unwatchedpages",aliases:["未受监视页面","未監視的頁面","未被監視的頁面","未被監視的頁面","UnwatchedPages"]},{realname:"Wantedcategories",aliases:["需要的分类","需要的分类","待撰分类","需要的分類","待撰分類","WantedCategories"]},{realname:"Wantedfiles",aliases:["需要的文件","需要的檔案","需要的文件","需要的檔案","WantedFiles"]},{realname:"Wantedpages",aliases:["需要的页面","需要的页面","待撰页面","受损链接","需要的頁面","待撰頁面","WantedPages","BrokenLinks"]},{realname:"Wantedtemplates",aliases:["需要的模板","需要的模板","需要的模板","WantedTemplates"]},{realname:"Allpages",aliases:["所有页面","所有頁面","所有页面","所有頁面","AllPages"]},{realname:"Prefixindex",aliases:["前缀索引","前綴索引","字首索引","前缀索引","前綴索引","字首索引","PrefixIndex"]},{realname:"Categories",aliases:["页面分类","頁面分類","页面分类","分類","頁面分類","Categories"]},{realname:"Listredirects",aliases:["重定向页列表","重定向列表","重新導向清單","重定向页列表","重新導向清單","重定向頁面列表","重新導向頁面清單","ListRedirects"]},{realname:"PagesWithProp",aliases:["带属性的页面","基于属性的页面","擁有屬性的頁面","帶屬性頁面","PagesWithProp","Pageswithprop","PagesByProp","Pagesbyprop"]},{realname:"TrackingCategories",aliases:["追踪分类","追踪分类","追蹤分類","跟蹤分類","TrackingCategories"]},{realname:"Userlogin",aliases:["用户登录","用戶登入","使用者登入","用户登录","登录","使用者登入","UserLogin","Login"]},{realname:"Userlogout",aliases:["用户退出","用戶登出","使用者登出","用户退出","退出","使用者登出","UserLogout","Logout"]},{realname:"CreateAccount",aliases:["创建账户","創建賬戶","建立帳戶","建立帳號","建立帐号","创建账户","建立帳號","建立帳戶","建立帳號","CreateAccount"]},{realname:"LinkAccounts",aliases:["链接账号","連結帳號","LinkAccounts"]},{realname:"UnlinkAccounts",aliases:["取消关联账号","解除連結帳號","UnlinkAccounts"]},{realname:"ChangeCredentials",aliases:["更改凭据","變更憑證","ChangeCredentials"]},{realname:"RemoveCredentials",aliases:["移除凭据","移除憑證","RemoveCredentials"]},{realname:"AuthenticationPopupSuccess",aliases:["认证成功弹窗","認證成功彈窗","AuthenticationPopupSuccess"]},{realname:"Activeusers",aliases:["活跃用户","活躍使用者","ActiveUsers"]},{realname:"Block",aliases:["封禁","封禁IP","封禁用户","封","封鎖","封鎖IP","封鎖使用者","封禁","封禁IP","封禁使用者","封鎖使用者","Block","BlockIP","BlockUser"]},{realname:"Unblock",aliases:["解除封禁","解封","解除封鎖","解除封禁","解禁","解除封鎖","解除封禁","Unblock"]},{realname:"BlockList",aliases:["封禁列表","封禁列表","IP封禁列表","封鎖清單","IP封鎖清單","封禁列表","IP封禁列表","BlockList","ListBlocks","IPBlockList"]},{realname:"AutoblockList",aliases:["自动封禁列表","列出自动封禁","自動封鎖清單","列出自動封鎖","AutoblockList","ListAutoblocks"]},{realname:"ChangePassword",aliases:["修改密码","修改密碼","修改密码","重置密码","找回密码","變更密碼","修改密碼","密碼重設","ChangePassword","ResetPass","ResetPassword"]},{realname:"BotPasswords",aliases:["机器人密码","機器人密碼","BotPasswords"]},{realname:"PasswordReset",aliases:["重置密码","重設密碼","重设密码","重設密碼","PasswordReset"]},{realname:"DeletedContributions",aliases:["删除的贡献","已删除的用户贡献","已刪除的貢獻","已刪除的用戶貢獻","DeletedContributions"]},{realname:"Preferences",aliases:["参数设置","偏好設定","參數設置","参数设置","设置","偏好設定","Preferences"]},{realname:"ResetTokens",aliases:["重置密钥","重設金鑰","重置权标","重設密鑰","覆寫令牌","ResetTokens"]},{realname:"Contributions",aliases:["用户贡献","用戶貢獻","使用者貢獻","使用者贡献","用户贡献","贡献","使用者貢獻","用戶貢獻","Contributions","Contribs"]},{realname:"Listgrouprights",aliases:["群组权限","群組權限","用户组权限","群組權限清單","使用者群組權限","群組權限列表","ListGroupRights","UserGroupRights"]},{realname:"Listgrants",aliases:["列出授权","列出授權","ListGrants"]},{realname:"Listusers",aliases:["用户列表","用戶列表","使用者清單","用户列表","使用者清單","使用者列表","ListUsers","UserList","Users"]},{realname:"Listadmins",aliases:["管理员列表","管理員列表","管理员列表","管理員清單","管理員列表","ListAdmins"]},{realname:"Listbots",aliases:["机器人列表","機器人清單","機械人清單","机器人列表","機器人清單","機械人列表","ListBots"]},{realname:"Userrights",aliases:["用户权限","用戶權限","使用者權限","用户权限","使用者權限","使用者權限","UserRights","MakeSysop","MakeBot"]},{realname:"EditWatchlist",aliases:["编辑监视列表","編輯監視清單","編輯監視列表","EditWatchlist"]},{realname:"PasswordPolicies",aliases:["密码策略","密碼原則","PasswordPolicies"]},{realname:"Newimages",aliases:["新建文件","新建檔案","新建文件","新建图像","新增檔案","新增圖片","新增檔案","NewFiles","NewImages"]},{realname:"Log",aliases:["日志","日誌","日志","日誌","Log","Logs"]},{realname:"Watchlist",aliases:["监视列表","監視列表","監視清单","监视列表","監視清單","監視清單","Watchlist"]},{realname:"Newpages",aliases:["最新页面","最新頁面","新建页面","新增頁面","新頁面","NewPages"]},{realname:"Recentchanges",aliases:["最近更改","近期變動","最近更改","最近變更","最近更改","近期變動","RecentChanges"]},{realname:"Recentchangeslinked",aliases:["链出更改","鏈出更改","連出更改","最近链出更改","相关更改","已連結的最近變更","相關變更","連出更改","RecentChangesLinked","RelatedChanges"]},{realname:"Tags",aliases:["标签","標籤","标签","標籤","Tags"]},{realname:"Listfiles",aliases:["文件列表","檔案列表","档案列表","文件列表","图像列表","檔案清單","圖片清單","檔案列表","圖像列表","檔案清單","ListFiles","FileList","ImageList"]},{realname:"Filepath",aliases:["文件路径","文件路徑","檔案路徑","档案路径","文件路径","檔案路徑","FilePath"]},{realname:"MediaStatistics",aliases:["媒体统计","媒體統計","MediaStatistics"]},{realname:"MIMEsearch",aliases:["MIME搜索","MIME搜尋","MIME搜寻","MIME搜索","MIME搜尋","MIME搜尋","MIMESearch"]},{realname:"FileDuplicateSearch",aliases:["搜索重复文件","重複檔案搜尋","搜尋重複檔案","搜尋重復檔案","FileDuplicateSearch"]},{realname:"Upload",aliases:["上传文件","上傳檔案","上載檔案","上载档案","上传文件","上傳","上載檔案","Upload"]},{realname:"UploadStash",aliases:["上传藏匿","上傳儲藏庫","UploadStash"]},{realname:"ListDuplicatedFiles",aliases:["重复文件列表","重複檔案清單","重複檔案列表","ListDuplicatedFiles","ListFileDuplicates"]},{realname:"ApiSandbox",aliases:["API沙盒","API沙盒","ApiSandbox"]},{realname:"Statistics",aliases:["统计","统计信息","統計","統計資訊","统计信息","統計資訊","Statistics","Stats"]},{realname:"Allmessages",aliases:["所有消息","所有訊息","所有讯息","所有信息","所有訊息","所有訊息","AllMessages"]},{realname:"Version",aliases:["版本","版本","版本信息","版本","版本資訊","Version"]},{realname:"Lockdb",aliases:["锁定数据库","鎖定資料庫","鎖定數據庫","鎖定資料庫","LockDB"]},{realname:"Unlockdb",aliases:["解除数据库锁定","解除鎖定資料庫","解除資料庫鎖定","解除資料庫鎖定","UnlockDB"]},{realname:"NamespaceInfo",aliases:["命名空间信息","命名空間資訊","NamespaceInfo"]},{realname:"LinkSearch",aliases:["链接搜索","鏈接搜索","連結搜尋","连结搜寻","搜索网页链接","連結搜尋","搜尋網頁連結","搜尋網頁連結","LinkSearch"]},{realname:"Randompage",aliases:["随机页面","隨機頁面","随机","随机页面","隨機頁面","Random","RandomPage"]},{realname:"RandomInCategory",aliases:["分类内随机","隨機分類頁面","於分類中隨機","RandomInCategory"]},{realname:"Randomredirect",aliases:["随机重定向","随机重定向页","隨機重新導向","隨機重定向頁面","隨機重新導向頁面","RandomRedirect"]},{realname:"Randomrootpage",aliases:["随机根页面","隨機根頁面","RandomRootpage"]},{realname:"GoToInterwiki",aliases:["去往跨wiki页面","前往跨wiki頁面","GoToInterwiki"]},{realname:"Mostlinkedcategories",aliases:["最多链接分类","最多連結分類","最多链接分类","被連結最多的分類","最多連結分類","MostLinkedCategories","MostUsedCategories"]},{realname:"Mostimages",aliases:["最多链接文件","最多鏈接文件","最多連結檔案","最多链接文件","被連結最多的檔案","最多連結檔案","MostLinkedFiles","MostFiles","MostImages"]},{realname:"Mostinterwikis",aliases:["最多跨wiki链接页面","最多跨wiki連結的頁面","最多_Interwiki_連結的頁面","最多跨wiki連結","MostInterwikis"]},{realname:"Mostlinked",aliases:["最多链接页面","最多連結頁面","最多链接页面","被連結最多的頁面","最多連結頁面","MostLinkedPages","MostLinked"]},{realname:"Mostlinkedtemplates",aliases:["最多链接模板","最多連結模板","最多嵌入页面","最多链接模板","最多使用模板","被引用最多的頁面","被連結最多的模板","被使用最多的模板","MostTranscludedPages","MostLinkedTemplates","MostUsedTemplates"]},{realname:"Mostcategories",aliases:["最多分类页面","最多分類頁面","最多分类页面","最多分類的頁面","最多分類頁面","MostCategories"]},{realname:"Mostrevisions",aliases:["最多修订页面","最多修訂頁面","最多修订页面","最多修訂的頁面","最多修訂頁面","MostRevisions"]},{realname:"ComparePages",aliases:["对比页面","頁面比較","頁面比較","ComparePages"]},{realname:"Import",aliases:["导入页面","導入頁面","匯入頁面","汇入页面","导入页面","导入","匯入","匯入頁面","Import"]},{realname:"Undelete",aliases:["恢复被删页面","恢復被刪頁面","恢复被删页面","取消刪除","Undelete"]},{realname:"Whatlinkshere",aliases:["链入页面","鏈入頁面","連入頁面","链入页面","連入頁面","連入頁面","WhatLinksHere"]},{realname:"MergeHistory",aliases:["合并历史","合併歷史","合并历史","合併歷史","MergeHistory"]},{realname:"ExpandTemplates",aliases:["展开模板","展開模板","ExpandTemplates"]},{realname:"ChangeContentModel",aliases:["更改内容模型","變更內容模型","ChangeContentModel"]},{realname:"Booksources",aliases:["网络书源","網絡書源","網路書源","网络书源","書籍來源","網路書源","BookSources"]},{realname:"ApiHelp",aliases:["API帮助","API說明","API使用說明","ApiHelp"]},{realname:"Blankpage",aliases:["空白页面","空白頁面","空白页面","空白頁面","BlankPage"]},{realname:"DeletePage",aliases:["删除页面","刪除頁面","刪除","DeletePage","Delete"]},{realname:"Diff",aliases:["差异","差異","编辑差异","編輯差異","Diff"]},{realname:"EditPage",aliases:["编辑页面","编辑","編輯頁面","編輯","EditPage","Edit"]},{realname:"EditTags",aliases:["编辑标签","編輯標籤","EditTags"]},{realname:"Emailuser",aliases:["电邮联系","電郵聯絡","电邮联系","寄信給使用者","寄信","電郵使用者","EmailUser","Email"]},{realname:"Movepage",aliases:["移动页面","移動頁面","移动页面","移動頁面","MovePage"]},{realname:"Mycontributions",aliases:["我的贡献","我的貢獻","我的贡献","我的貢獻","MyContributions","MyContribs"]},{realname:"MyLanguage",aliases:["我的语言","我的語言","我的语言","我的語言","MyLanguage"]},{realname:"Mylog",aliases:["我的日志","我的日誌","MyLog"]},{realname:"Mypage",aliases:["我的用户页","我的用戶頁","我的使用者頁面","我的用户页","我的使用者頁面","我的用戶頁","MyPage"]},{realname:"Mytalk",aliases:["我的讨论页","我的討論頁","我的讨论页","我的对话页","我的對話","我的討論頁","MyTalk"]},{realname:"PageHistory",aliases:["页面历史","頁面歷史","歷史","PageHistory","History"]},{realname:"PageInfo",aliases:["页面信息","頁面資訊","資訊","PageInfo","Info"]},{realname:"ProtectPage",aliases:["保护页面","保护","保護頁面","保護","ProtectPage","Protect"]},{realname:"Purge",aliases:["刷新","更新快取","Purge"]},{realname:"Myuploads",aliases:["我上传的文件","我的文件","我的上傳","我的上載","我的檔案","MyUploads","MyFiles"]},{realname:"AllMyUploads",aliases:["我上传的所有文件","我的所有文件","所有我的上傳","所有我的檔案","所有本人上載","所有本人檔案","AllMyUploads","AllMyFiles"]},{realname:"NewSection",aliases:["新章节","新章節","NewSection","Newsection"]},{realname:"PermanentLink",aliases:["固定链接","永久链接","固定連結","靜態連結","永久連結","PermanentLink","PermaLink"]},{realname:"Redirect",aliases:["重定向","重新導向","重定向","重新導向","重定向","Redirect"]},{realname:"Renameuser",aliases:["重命名用户","重新命名用户","重新命名用戶","重新命名使用者","重命名用户","重新命名使用者","RenameUser"]},{realname:"Revisiondelete",aliases:["版本删除","删除修订","恢复修订","修訂刪除","刪除或恢復版本","刪除或恢復版本","RevisionDelete"]},{realname:"RunJobs",aliases:["运行工作","執行作業","運行工作","RunJobs"]},{realname:"Specialpages",aliases:["特殊页面","特殊頁面","特殊页面","特殊頁面","SpecialPages"]},{realname:"PageData",aliases:["页面数据","頁面資料","PageData"]},{realname:"Contribute",aliases:["做出贡献","做出貢獻","Contribute"]},{realname:"TalkPage",aliases:["讨论页","討論頁","TalkPage"]},{realname:"Search",aliases:["搜索","搜尋","搜索","搜尋","Search"]},{realname:"ChangeEmail",aliases:["修改邮箱地址","變更信箱","修改郵箱","ChangeEmail"]},{realname:"AbuseLog",aliases:["滥用日志","过滤日志","濫用日誌","AbuseLog"]},{realname:"AbuseFilter",aliases:["滥用过滤器","防滥用过滤器","濫用過濾器","AbuseFilter"]},{realname:"BlockedExternalDomains",aliases:["已封禁的外部域名","已封鎖的外部網域","BlockedExternalDomains"]},{realname:"UploadAvatar",aliases:["上传头像","上傳頭像","UploadAvatar"]},{realname:"ViewAvatar",aliases:["查看头像","檢視頭像","ViewAvatar"]},{realname:"CategoryTree",aliases:["分类树","分類樹","CategoryTree"]},{realname:"CheckUser",aliases:["用户查核","使用者查核","用戶查核","CheckUser"]},{realname:"CheckUserLog",aliases:["用户查核日志","使用者查核日誌","用戶查核日誌","CheckUserLog"]},{realname:"Investigate",aliases:["Investigate"]},{realname:"InvestigateBlock",aliases:["InvestigateBlock"]},{realname:"CiteThisPage",aliases:["引用此页面","引用","引用","CiteThisPage","Cite"]},{realname:"DeleteBatch",aliases:["批量删除","批次刪除","DeleteBatch"]},{realname:"TopicSubscriptions",aliases:["话题订阅","TopicSubscriptions"]},{realname:"FindComment",aliases:["查找留言","FindComment"]},{realname:"GoToComment",aliases:["转到留言","GoToComment"]},{realname:"DiscussionToolsDebug",aliases:["讨论工具调试","DiscussionToolsDebug"]},{realname:"DisambiguationPages",aliases:["消歧义页面","消歧義頁面","DisambiguationPages"]},{realname:"DisambiguationPageLinks",aliases:["链接到消歧义页的页面","消歧義頁面連結","DisambiguationPageLinks"]},{realname:"Notifications",aliases:["通知","通知","Notifications"]},{realname:"DisplayNotificationsConfiguration",aliases:["显示通知配置","顯示通知設定","DisplayNotificationsConfiguration"]},{realname:"NotificationsMarkRead",aliases:["标记通知为已读","標記通知為已讀","NotificationsMarkRead"]},{realname:"Gadgets",aliases:["小工具","小工具","Gadgets"]},{realname:"GadgetUsage",aliases:["小工具使用统计","小工具使用統計","GadgetUsage"]},{realname:"MostGloballyLinkedFiles",aliases:["全域最多链接文件","全域最多連結檔案","全域最多連接檔案","MostGloballyLinkedFiles"]},{realname:"GloballyWantedFiles",aliases:["全域需要的文件","全域需要的檔案","GloballyWantedFiles"]},{realname:"GloballyUnusedFiles",aliases:["全域未使用文件","全域未使用的檔案","GloballyUnusedFiles"]},{realname:"GlobalUsage",aliases:["全域使用情况","全域使用狀況","GlobalUsage"]},{realname:"Interwiki",aliases:["跨wiki","跨维基","跨Wiki","跨維基","Interwiki"]},{realname:"LintErrors",aliases:["Lint错误","Lint錯誤","LintErrors"]},{realname:"MassEditRegex",aliases:["批量正则编辑","大量編輯_Regex","MassEditRegex"]},{realname:"MathShowImage",aliases:["MathShowImage"]},{realname:"MathStatus",aliases:["数学状态","數學狀態","MathStatus"]},{realname:"MoeAuth",aliases:["MoeAuth","萌の入","萌娘登录","MoeAuth","Moelogin"]},{realname:"Boilerplates",aliases:["样板","范本","格式模板","预加载格式模板（boilerplates）","範本","樣板","格式模板","預加載格式模板（boilerplates）","Boilerplates"]},{realname:"Nuke",aliases:["大量删除","大量刪除","Nuke"]},{realname:"ReplaceText",aliases:["替换文字","替换文本","取代文字","替換文字","替換文本","ReplaceText"]},{realname:"TemplateSandbox",aliases:["模板沙盒","模板沙盒","TemplateSandbox"]},{realname:"Thanks",aliases:["感谢","感謝","Thanks"]},{realname:"OrphanedTimedText",aliases:["孤立定时文本","OrphanedTimedText"]},{realname:"TranscodeStatistics",aliases:["定时媒体处理器","Transcode_statistics","Transcode_Statistics","TimedMediaHandler"]},{realname:"CollabPad",aliases:["CollabPad","Collab_Pad"]},{realname:"Moderation",aliases:["Moderation"]},{realname:"LookupUser",aliases:["查阅用户","搜尋使用者","LookupUser"]}],namespacealiases:[{id:-2,alias:"媒体"},{id:-2,alias:"媒体文件"},{id:-2,alias:"媒体档案"},{id:-2,alias:"媒體"},{id:-2,alias:"媒體文件"},{id:-2,alias:"媒體檔案"},{id:-1,alias:"特殊"},{id:1,alias:"对话"},{id:1,alias:"對話"},{id:1,alias:"討論"},{id:1,alias:"讨论"},{id:2,alias:"使用者"},{id:2,alias:"用戶"},{id:2,alias:"用户"},{id:3,alias:"使用者对话"},{id:3,alias:"使用者對話"},{id:3,alias:"使用者討論"},{id:3,alias:"使用者讨论"},{id:3,alias:"用戶對話"},{id:3,alias:"用戶討論"},{id:3,alias:"用户对话"},{id:3,alias:"用户讨论"},{id:4,alias:"专案"},{id:4,alias:"專案"},{id:5,alias:"专案讨论"},{id:5,alias:"專案討論"},{id:5,alias:"萌娘百科对话"},{id:5,alias:"萌娘百科對話"},{id:5,alias:"萌娘百科討論"},{id:5,alias:"萌娘百科讨论"},{id:6,alias:"Image"},{id:6,alias:"图像"},{id:6,alias:"图片"},{id:6,alias:"圖像"},{id:6,alias:"圖片"},{id:6,alias:"文件"},{id:6,alias:"档案"},{id:6,alias:"檔案"},{id:7,alias:"Image talk"},{id:7,alias:"图像对话"},{id:7,alias:"图像讨论"},{id:7,alias:"图片讨论"},{id:7,alias:"圖像對話"},{id:7,alias:"圖像討論"},{id:7,alias:"圖片討論"},{id:7,alias:"文件对话"},{id:7,alias:"文件對話"},{id:7,alias:"文件討論"},{id:7,alias:"文件讨论"},{id:7,alias:"档案对话"},{id:7,alias:"档案讨论"},{id:7,alias:"檔案對話"},{id:7,alias:"檔案討論"},{id:9,alias:"MediaWiki討論"},{id:9,alias:"MediaWiki讨论"},{id:10,alias:"样板"},{id:10,alias:"模板"},{id:10,alias:"樣板"},{id:11,alias:"样板对话"},{id:11,alias:"样板讨论"},{id:11,alias:"模板对话"},{id:11,alias:"模板對話"},{id:11,alias:"模板討論"},{id:11,alias:"模板讨论"},{id:11,alias:"樣板對話"},{id:11,alias:"樣板討論"},{id:12,alias:"使用說明"},{id:12,alias:"使用说明"},{id:12,alias:"帮助"},{id:12,alias:"幫助"},{id:12,alias:"說明"},{id:12,alias:"说明"},{id:13,alias:"使用說明討論"},{id:13,alias:"使用说明讨论"},{id:13,alias:"帮助对话"},{id:13,alias:"帮助讨论"},{id:13,alias:"幫助對話"},{id:13,alias:"幫助討論"},{id:13,alias:"說明討論"},{id:13,alias:"说明讨论"},{id:14,alias:"分类"},{id:14,alias:"分類"},{id:15,alias:"分类对话"},{id:15,alias:"分类讨论"},{id:15,alias:"分類對話"},{id:15,alias:"分類討論"},{id:274,alias:"小元件"},{id:274,alias:"小組件"},{id:274,alias:"小组件"},{id:274,alias:"小部件"},{id:274,alias:"微件"},{id:275,alias:"小元件討論"},{id:275,alias:"小元件讨论"},{id:275,alias:"小組件討論"},{id:275,alias:"小组件讨论"},{id:275,alias:"小部件討論"},{id:275,alias:"小部件讨论"},{id:275,alias:"微件討論"},{id:275,alias:"微件讨论"},{id:711,alias:"TimedText talk"},{id:828,alias:"模块"},{id:828,alias:"模塊"},{id:828,alias:"模組"},{id:828,alias:"模组"},{id:829,alias:"模块对话"},{id:829,alias:"模块讨论"},{id:829,alias:"模塊對話"},{id:829,alias:"模塊討論"},{id:829,alias:"模組對話"},{id:829,alias:"模組討論"},{id:829,alias:"模组对话"},{id:829,alias:"模组讨论"}],namespaces:{0:{id:0,case:"first-letter",name:"",subpages:!0,canonical:"",content:!0,nonincludable:!1},1:{id:1,case:"first-letter",name:"Talk",subpages:!0,canonical:"Talk",content:!1,nonincludable:!1},2:{id:2,case:"first-letter",name:"User",subpages:!0,canonical:"User",content:!1,nonincludable:!1},3:{id:3,case:"first-letter",name:"User talk",subpages:!0,canonical:"User talk",content:!1,nonincludable:!1},4:{id:4,case:"first-letter",name:"萌娘百科",subpages:!0,canonical:"Project",content:!1,nonincludable:!1},5:{id:5,case:"first-letter",name:"萌娘百科 talk",subpages:!0,canonical:"Project talk",content:!1,nonincludable:!1},6:{id:6,case:"first-letter",name:"File",subpages:!1,canonical:"File",content:!1,nonincludable:!1},7:{id:7,case:"first-letter",name:"File talk",subpages:!0,canonical:"File talk",content:!1,nonincludable:!1},8:{id:8,case:"first-letter",name:"MediaWiki",subpages:!0,canonical:"MediaWiki",content:!1,nonincludable:!1,namespaceprotection:"editinterface"},9:{id:9,case:"first-letter",name:"MediaWiki talk",subpages:!0,canonical:"MediaWiki talk",content:!1,nonincludable:!1},10:{id:10,case:"first-letter",name:"Template",subpages:!0,canonical:"Template",content:!1,nonincludable:!1},11:{id:11,case:"first-letter",name:"Template talk",subpages:!0,canonical:"Template talk",content:!1,nonincludable:!1},12:{id:12,case:"first-letter",name:"Help",subpages:!0,canonical:"Help",content:!1,nonincludable:!1},13:{id:13,case:"first-letter",name:"Help talk",subpages:!0,canonical:"Help talk",content:!1,nonincludable:!1},14:{id:14,case:"first-letter",name:"Category",subpages:!1,canonical:"Category",content:!1,nonincludable:!1},15:{id:15,case:"first-letter",name:"Category talk",subpages:!0,canonical:"Category talk",content:!1,nonincludable:!1},274:{id:274,case:"first-letter",name:"Widget",subpages:!1,canonical:"Widget",content:!1,nonincludable:!1,namespaceprotection:"editwidgets"},275:{id:275,case:"first-letter",name:"Widget talk",subpages:!0,canonical:"Widget talk",content:!1,nonincludable:!1},710:{id:710,case:"first-letter",name:"TimedText",subpages:!1,canonical:"TimedText",content:!1,nonincludable:!1},711:{id:711,case:"first-letter",name:"TimedText talk",subpages:!1,canonical:"TimedText talk",content:!1,nonincludable:!1},828:{id:828,case:"first-letter",name:"Module",subpages:!0,canonical:"Module",content:!1,nonincludable:!1},829:{id:829,case:"first-letter",name:"Module talk",subpages:!0,canonical:"Module talk",content:!1,nonincludable:!1},"-2":{id:-2,case:"first-letter",name:"Media",subpages:!1,canonical:"Media",content:!1,nonincludable:!1},"-1":{id:-1,case:"first-letter",name:"Special",subpages:!1,canonical:"Special",content:!1,nonincludable:!1}},magicwords:[{name:"expr",aliases:["计算式","表达式","表達式","expr"],"case-sensitive":!1},{name:"if",aliases:["非空式","若","如果","if"],"case-sensitive":!1},{name:"ifeq",aliases:["相同式","匹配式","若相等","如果相等","ifeq"],"case-sensitive":!1},{name:"iferror",aliases:["错误式","如果错误","如果錯誤","iferror"],"case-sensitive":!1},{name:"switch",aliases:["多选式","多条件式","双射式","开关","转换","轉換","switch"],"case-sensitive":!1},{name:"default",aliases:["#默认","#默認","#default"],"case-sensitive":!1},{name:"ifexist",aliases:["存在式","若有","如有","ifexist"],"case-sensitive":!1},{name:"len",aliases:["长度","長度","len"],"case-sensitive":!1},{name:"pos",aliases:["位置","终端","pos"],"case-sensitive":!1},{name:"rpos",aliases:["最近位置","反终端","rpos"],"case-sensitive":!1},{name:"sub",aliases:["截取","PF子","sub"],"case-sensitive":!1},{name:"count",aliases:["计数","計算","count"],"case-sensitive":!1},{name:"replace",aliases:["替换","取代","replace"],"case-sensitive":!1},{name:"explode",aliases:["爆炸","炸开","粉碎","explode"],"case-sensitive":!1},{name:"widget",aliases:["widget","微件","小部件","小组件","小元件","小組件"],"case-sensitive":!1},{name:"!",aliases:["!"],"case-sensitive":!0},{name:"anchorencode",aliases:["ANCHORENCODE","锚编码"],"case-sensitive":!1},{name:"articlepath",aliases:["ARTICLEPATH","条目路径"],"case-sensitive":!1},{name:"basepagename",aliases:["BASEPAGENAME","基础页面名称"],"case-sensitive":!0},{name:"basepagenamee",aliases:["BASEPAGENAMEE","基础页面名称等同"],"case-sensitive":!0},{name:"bidi",aliases:["BIDI:"],"case-sensitive":!1},{name:"canonicalurl",aliases:["CANONICALURL:","规范URL:"],"case-sensitive":!1},{name:"canonicalurle",aliases:["CANONICALURLE:","规范URL等同:"],"case-sensitive":!1},{name:"cascadingsources",aliases:["CASCADINGSOURCES","级联来源"],"case-sensitive":!0},{name:"contentlanguage",aliases:["CONTENTLANGUAGE","CONTENTLANG","内容语言","內容語言"],"case-sensitive":!0},{name:"currentday",aliases:["CURRENTDAY","今天"],"case-sensitive":!0},{name:"currentday2",aliases:["CURRENTDAY2","今天2"],"case-sensitive":!0},{name:"currentdayname",aliases:["CURRENTDAYNAME","星期","今天名","今天名称"],"case-sensitive":!0},{name:"currentdow",aliases:["CURRENTDOW","当前DOW"],"case-sensitive":!0},{name:"currenthour",aliases:["CURRENTHOUR","当前小时"],"case-sensitive":!0},{name:"currentmonth",aliases:["CURRENTMONTH","CURRENTMONTH2","本月","本月2"],"case-sensitive":!0},{name:"currentmonth1",aliases:["CURRENTMONTH1","本月1"],"case-sensitive":!0},{name:"currentmonthabbrev",aliases:["CURRENTMONTHABBREV","本月简称","本月縮寫"],"case-sensitive":!0},{name:"currentmonthname",aliases:["CURRENTMONTHNAME","本月名","本月名称"],"case-sensitive":!0},{name:"currentmonthnamegen",aliases:["CURRENTMONTHNAMEGEN","本月名属格","本月名称属格"],"case-sensitive":!0},{name:"currenttime",aliases:["CURRENTTIME","当前时间","此时","目前時間"],"case-sensitive":!0},{name:"currenttimestamp",aliases:["CURRENTTIMESTAMP","当前时间戳"],"case-sensitive":!0},{name:"currentversion",aliases:["CURRENTVERSION","当前版本","目前版本"],"case-sensitive":!0},{name:"currentweek",aliases:["CURRENTWEEK","本周"],"case-sensitive":!0},{name:"currentyear",aliases:["CURRENTYEAR","今年"],"case-sensitive":!0},{name:"defaultsort",aliases:["DEFAULTSORT:","DEFAULTSORTKEY:","DEFAULTCATEGORYSORT:","默认排序:","默认排序关键字:","默认分类排序:"],"case-sensitive":!0},{name:"defaultsort_noerror",aliases:["noerror","不报错"],"case-sensitive":!1},{name:"defaultsort_noreplace",aliases:["noreplace","不替换"],"case-sensitive":!1},{name:"directionmark",aliases:["DIRECTIONMARK","DIRMARK","方向标记"],"case-sensitive":!0},{name:"displaytitle",aliases:["DISPLAYTITLE","显示标题","顯示標題"],"case-sensitive":!0},{name:"displaytitle_noerror",aliases:["noerror","无错误"],"case-sensitive":!1},{name:"displaytitle_noreplace",aliases:["noreplace","无代替"],"case-sensitive":!1},{name:"expectunusedcategory",aliases:["__EXPECTUNUSEDCATEGORY__"],"case-sensitive":!0},{name:"filepath",aliases:["FILEPATH:","文件路径:"],"case-sensitive":!1},{name:"forcetoc",aliases:["__FORCETOC__","__强显目录__","__強制目錄__"],"case-sensitive":!1},{name:"formatdate",aliases:["formatdate","dateformat","格式化日期","日期格式化"],"case-sensitive":!1},{name:"formatnum",aliases:["FORMATNUM","格式化数字"],"case-sensitive":!1},{name:"fullpagename",aliases:["FULLPAGENAME","页面全称","完整页面名称"],"case-sensitive":!0},{name:"fullpagenamee",aliases:["FULLPAGENAMEE","完整页面名称等同"],"case-sensitive":!0},{name:"fullurl",aliases:["FULLURL:","完整URL:"],"case-sensitive":!1},{name:"fullurle",aliases:["FULLURLE:","完整URL等同:"],"case-sensitive":!1},{name:"gender",aliases:["GENDER:","性别:","性別:","性:"],"case-sensitive":!1},{name:"grammar",aliases:["GRAMMAR:","语法:"],"case-sensitive":!1},{name:"hiddencat",aliases:["__HIDDENCAT__","__隐藏分类__","__隱藏分類__"],"case-sensitive":!0},{name:"img_alt",aliases:["alt=$1","替代=$1","替代文本=$1","替代文字"],"case-sensitive":!0},{name:"img_baseline",aliases:["baseline","基线"],"case-sensitive":!0},{name:"img_border",aliases:["border","边框","邊框"],"case-sensitive":!0},{name:"img_bottom",aliases:["bottom","底部","垂直置底"],"case-sensitive":!0},{name:"img_center",aliases:["center","centre","居中","置中"],"case-sensitive":!0},{name:"img_class",aliases:["class=$1","类=$1","類別=$1"],"case-sensitive":!0},{name:"img_framed",aliases:["frame","framed","enframed","有框"],"case-sensitive":!0},{name:"img_frameless",aliases:["frameless","无框","無框"],"case-sensitive":!0},{name:"img_lang",aliases:["lang=$1","语言=$1","語言=$1"],"case-sensitive":!0},{name:"img_left",aliases:["left","左"],"case-sensitive":!0},{name:"img_link",aliases:["link=$1","链接=$1","連結=$1"],"case-sensitive":!0},{name:"img_manualthumb",aliases:["thumbnail=$1","thumb=$1","缩略图=$1","縮圖=$1"],"case-sensitive":!0},{name:"img_middle",aliases:["middle","中间","垂直置中"],"case-sensitive":!0},{name:"img_none",aliases:["none","无","無"],"case-sensitive":!0},{name:"img_page",aliases:["page=$1","page $1","页数=$1","$1页","頁=$1","$1頁"],"case-sensitive":!0},{name:"img_right",aliases:["right","右"],"case-sensitive":!0},{name:"img_sub",aliases:["sub","子","下標"],"case-sensitive":!0},{name:"img_super",aliases:["super","sup","超","上標"],"case-sensitive":!0},{name:"img_text_bottom",aliases:["text-bottom","文字底部","文字置底"],"case-sensitive":!0},{name:"img_text_top",aliases:["text-top","文字顶部","文字置頂"],"case-sensitive":!0},{name:"img_thumbnail",aliases:["thumb","thumbnail","缩略图","縮圖"],"case-sensitive":!0},{name:"img_top",aliases:["top","顶部","垂直置頂"],"case-sensitive":!0},{name:"img_upright",aliases:["upright","upright=$1","upright $1","右上","右上=$1","右上$1"],"case-sensitive":!0},{name:"img_width",aliases:["$1px","$1像素"],"case-sensitive":!0},{name:"index",aliases:["__INDEX__","__索引__"],"case-sensitive":!0},{name:"int",aliases:["INT:","界面:"],"case-sensitive":!1},{name:"language",aliases:["#LANGUAGE","#语言","#語言"],"case-sensitive":!1},{name:"lc",aliases:["LC:","小写:"],"case-sensitive":!1},{name:"lcfirst",aliases:["LCFIRST:","小写首字:"],"case-sensitive":!1},{name:"localday",aliases:["LOCALDAY","本地日"],"case-sensitive":!0},{name:"localday2",aliases:["LOCALDAY2","本地日2"],"case-sensitive":!0},{name:"localdayname",aliases:["LOCALDAYNAME","本地日名"],"case-sensitive":!0},{name:"localdow",aliases:["LOCALDOW","本地DOW"],"case-sensitive":!0},{name:"localhour",aliases:["LOCALHOUR","本地小时"],"case-sensitive":!0},{name:"localmonth",aliases:["LOCALMONTH","LOCALMONTH2","本地月","本地月2"],"case-sensitive":!0},{name:"localmonth1",aliases:["LOCALMONTH1","本地月1"],"case-sensitive":!0},{name:"localmonthabbrev",aliases:["LOCALMONTHABBREV","本地月缩写"],"case-sensitive":!0},{name:"localmonthname",aliases:["LOCALMONTHNAME","本地月份名"],"case-sensitive":!0},{name:"localmonthnamegen",aliases:["LOCALMONTHNAMEGEN","本地月历"],"case-sensitive":!0},{name:"localtime",aliases:["LOCALTIME","本地时间"],"case-sensitive":!0},{name:"localtimestamp",aliases:["LOCALTIMESTAMP","本地时间戳"],"case-sensitive":!0},{name:"localurl",aliases:["LOCALURL:","本地URL:"],"case-sensitive":!1},{name:"localurle",aliases:["LOCALURLE:","本地URLE:"],"case-sensitive":!1},{name:"localweek",aliases:["LOCALWEEK","本地周"],"case-sensitive":!0},{name:"localyear",aliases:["LOCALYEAR","本地年"],"case-sensitive":!0},{name:"msg",aliases:["MSG:","訊息:"],"case-sensitive":!1},{name:"msgnw",aliases:["MSGNW:"],"case-sensitive":!1},{name:"namespace",aliases:["NAMESPACE","名字空间","命名空間"],"case-sensitive":!0},{name:"namespacee",aliases:["NAMESPACEE","名字空间等同"],"case-sensitive":!0},{name:"namespacenumber",aliases:["NAMESPACENUMBER","名字空间编号","命名空間數"],"case-sensitive":!0},{name:"newsectionlink",aliases:["__NEWSECTIONLINK__","__新段落链接__"],"case-sensitive":!0},{name:"nocommafysuffix",aliases:["NOSEP"],"case-sensitive":!1},{name:"nocontentconvert",aliases:["__NOCONTENTCONVERT__","__NOCC__","__不转换内容__","__不轉換內容__"],"case-sensitive":!1},{name:"noeditsection",aliases:["__NOEDITSECTION__","__无编辑段落__","__无段落编辑__","__無段落編輯__"],"case-sensitive":!1},{name:"nogallery",aliases:["__NOGALLERY__","__无图库__","__無圖庫__"],"case-sensitive":!1},{name:"noindex",aliases:["__NOINDEX__","__无索引__"],"case-sensitive":!0},{name:"nonewsectionlink",aliases:["__NONEWSECTIONLINK__","__无新段落链接__"],"case-sensitive":!0},{name:"notitleconvert",aliases:["__NOTITLECONVERT__","__NOTC__","__不转换标题__","__不轉換標題__"],"case-sensitive":!1},{name:"notoc",aliases:["__NOTOC__","__无目录__","__無目錄__"],"case-sensitive":!1},{name:"ns",aliases:["NS:","名称空间:","命名空間:","名字空间:"],"case-sensitive":!1},{name:"nse",aliases:["NSE:","名称空间E:","命名空間E:","名字空间E:"],"case-sensitive":!1},{name:"numberingroup",aliases:["NUMBERINGROUP","NUMINGROUP","组中用户数"],"case-sensitive":!0},{name:"numberofactiveusers",aliases:["NUMBEROFACTIVEUSERS","活跃用户数","活躍使用者人數"],"case-sensitive":!0},{name:"numberofadmins",aliases:["NUMBEROFADMINS","管理员数","管理員數"],"case-sensitive":!0},{name:"numberofarticles",aliases:["NUMBEROFARTICLES","条目数","文章數"],"case-sensitive":!0},{name:"numberofedits",aliases:["NUMBEROFEDITS","编辑数"],"case-sensitive":!0},{name:"numberoffiles",aliases:["NUMBEROFFILES","文件数","檔案數"],"case-sensitive":!0},{name:"numberofpages",aliases:["NUMBEROFPAGES","页面数","頁面數"],"case-sensitive":!0},{name:"numberofusers",aliases:["NUMBEROFUSERS","用户数","使用者人數量"],"case-sensitive":!0},{name:"padleft",aliases:["PADLEFT","左填充"],"case-sensitive":!1},{name:"padright",aliases:["PADRIGHT","右填充"],"case-sensitive":!1},{name:"pageid",aliases:["PAGEID","页面ID","頁面ID"],"case-sensitive":!1},{name:"pagelanguage",aliases:["PAGELANGUAGE"],"case-sensitive":!0},{name:"pagename",aliases:["PAGENAME","页名","页面名","页面名称","頁面名稱"],"case-sensitive":!0},{name:"pagenamee",aliases:["PAGENAMEE","页面名等同","页面名称等同"],"case-sensitive":!0},{name:"pagesincategory",aliases:["PAGESINCATEGORY","PAGESINCAT","分类中页面数"],"case-sensitive":!0},{name:"pagesincategory_all",aliases:["all","所有"],"case-sensitive":!1},{name:"pagesincategory_files",aliases:["files","文件","檔案"],"case-sensitive":!1},{name:"pagesincategory_pages",aliases:["pages","页面","頁面"],"case-sensitive":!1},{name:"pagesincategory_subcats",aliases:["subcats","子分类"],"case-sensitive":!1},{name:"pagesinnamespace",aliases:["PAGESINNAMESPACE:","PAGESINNS:","名字空间中页面数:"],"case-sensitive":!0},{name:"pagesize",aliases:["PAGESIZE","页面大小"],"case-sensitive":!0},{name:"plural",aliases:["PLURAL:","复数:"],"case-sensitive":!1},{name:"protectionexpiry",aliases:["PROTECTIONEXPIRY"],"case-sensitive":!0},{name:"protectionlevel",aliases:["PROTECTIONLEVEL","保护级别"],"case-sensitive":!0},{name:"raw",aliases:["RAW:","原始:"],"case-sensitive":!1},{name:"rawsuffix",aliases:["R"],"case-sensitive":!0},{name:"redirect",aliases:["#REDIRECT","#重定向","#重新導向"],"case-sensitive":!1},{name:"revisionday",aliases:["REVISIONDAY","修订日"],"case-sensitive":!0},{name:"revisionday2",aliases:["REVISIONDAY2","修订日2"],"case-sensitive":!0},{name:"revisionid",aliases:["REVISIONID","修订ID"],"case-sensitive":!0},{name:"revisionmonth",aliases:["REVISIONMONTH","修订月"],"case-sensitive":!0},{name:"revisionmonth1",aliases:["REVISIONMONTH1","修订月1"],"case-sensitive":!0},{name:"revisionsize",aliases:["REVISIONSIZE","修订大小"],"case-sensitive":!0},{name:"revisiontimestamp",aliases:["REVISIONTIMESTAMP","修订时间戳"],"case-sensitive":!0},{name:"revisionuser",aliases:["REVISIONUSER","修订用户","修訂使用者"],"case-sensitive":!0},{name:"revisionyear",aliases:["REVISIONYEAR","修订年"],"case-sensitive":!0},{name:"rootpagename",aliases:["ROOTPAGENAME","根页面名称","根頁面名稱"],"case-sensitive":!0},{name:"rootpagenamee",aliases:["ROOTPAGENAMEE","根页面名称等同","根頁面名稱E"],"case-sensitive":!0},{name:"safesubst",aliases:["SAFESUBST:","安全替代:","安全替換:"],"case-sensitive":!1},{name:"scriptpath",aliases:["SCRIPTPATH","脚本路径"],"case-sensitive":!1},{name:"server",aliases:["SERVER","服务器","伺服器"],"case-sensitive":!1},{name:"servername",aliases:["SERVERNAME","服务器名","伺服器名稱"],"case-sensitive":!1},{name:"sitename",aliases:["SITENAME","站点名称","網站名稱"],"case-sensitive":!0},{name:"special",aliases:["special","特殊"],"case-sensitive":!1},{name:"speciale",aliases:["speciale","特殊等同"],"case-sensitive":!1},{name:"staticredirect",aliases:["__STATICREDIRECT__","__静态重定向__","__靜態重新導向__"],"case-sensitive":!0},{name:"stylepath",aliases:["STYLEPATH","样式路径"],"case-sensitive":!1},{name:"subjectpagename",aliases:["SUBJECTPAGENAME","ARTICLEPAGENAME","主名字空间页面名称","条目页面名称"],"case-sensitive":!0},{name:"subjectpagenamee",aliases:["SUBJECTPAGENAMEE","ARTICLEPAGENAMEE","主名字空间页面名称等同","条目页面名称等同"],"case-sensitive":!0},{name:"subjectspace",aliases:["SUBJECTSPACE","ARTICLESPACE","主名字空间","条目名字空间"],"case-sensitive":!0},{name:"subjectspacee",aliases:["SUBJECTSPACEE","ARTICLESPACEE","主名字空间等同","条目名字空间等同"],"case-sensitive":!0},{name:"subpagename",aliases:["SUBPAGENAME","子页面名称"],"case-sensitive":!0},{name:"subpagenamee",aliases:["SUBPAGENAMEE","子页面名称等同"],"case-sensitive":!0},{name:"subst",aliases:["SUBST:","替代:","替換:"],"case-sensitive":!1},{name:"tag",aliases:["tag","标记"],"case-sensitive":!1},{name:"talkpagename",aliases:["TALKPAGENAME","讨论页面名称","对话页面名称"],"case-sensitive":!0},{name:"talkpagenamee",aliases:["TALKPAGENAMEE","讨论页面名称等同","对话页面名称等同"],"case-sensitive":!0},{name:"talkspace",aliases:["TALKSPACE","讨论空间","讨论名字空间","對話空間"],"case-sensitive":!0},{name:"talkspacee",aliases:["TALKSPACEE","讨论空间等同","讨论名字空间等同"],"case-sensitive":!0},{name:"toc",aliases:["__TOC__","__目录__","__目錄__"],"case-sensitive":!1},{name:"uc",aliases:["UC:","大写:"],"case-sensitive":!1},{name:"ucfirst",aliases:["UCFIRST:","大写首字:"],"case-sensitive":!1},{name:"urlencode",aliases:["URLENCODE:","URL编码:"],"case-sensitive":!1},{name:"url_path",aliases:["PATH","路径"],"case-sensitive":!1},{name:"url_query",aliases:["QUERY","查询","查詢"],"case-sensitive":!1},{name:"url_wiki",aliases:["WIKI"],"case-sensitive":!1},{name:"categorytree",aliases:["分类树","分類樹","categorytree"],"case-sensitive":!1},{name:"archivedtalk",aliases:["__已存档讨论__","__ARCHIVEDTALK__"],"case-sensitive":!1},{name:"notalk",aliases:["__禁用讨论__","__NOTALK__"],"case-sensitive":!1},{name:"disambiguation",aliases:["__消除歧义__","__DISAMBIG__"],"case-sensitive":!0},{name:"ifexpr",aliases:["若表达式","若表達式","ifexpr"],"case-sensitive":!1},{name:"time",aliases:["时间","時間","time"],"case-sensitive":!1},{name:"timel",aliases:["时间l","時間L","timel"],"case-sensitive":!1},{name:"titleparts",aliases:["标题组成部分","titleparts"],"case-sensitive":!1},{name:"urldecode",aliases:["url解码","URI解碼","urldecode"],"case-sensitive":!1},{name:"invoke",aliases:["调用","調動","invoke"],"case-sensitive":!1},{name:"img",aliases:["img"],"case-sensitive":!1},{name:"timef",aliases:["timef"],"case-sensitive":!0},{name:"timefl",aliases:["timefl"],"case-sensitive":!0},{name:"timef-time",aliases:["time"],"case-sensitive":!0},{name:"timef-date",aliases:["date"],"case-sensitive":!0},{name:"timef-both",aliases:["both"],"case-sensitive":!0},{name:"timef-pretty",aliases:["pretty"],"case-sensitive":!0},{name:"rel2abs",aliases:["rel2abs"],"case-sensitive":!1},{name:"choose",aliases:["choose"],"case-sensitive":!1},{name:"related",aliases:["related"],"case-sensitive":!1},{name:"timedmedia_thumbtime",aliases:["thumbtime=$1"],"case-sensitive":!1},{name:"timedmedia_starttime",aliases:["start=$1"],"case-sensitive":!1},{name:"timedmedia_endtime",aliases:["end=$1"],"case-sensitive":!1},{name:"timedmedia_disablecontrols",aliases:["disablecontrols=$1"],"case-sensitive":!1},{name:"timedmedia_loop",aliases:["loop"],"case-sensitive":!1},{name:"timedmedia_muted",aliases:["muted"],"case-sensitive":!1},{name:"=",aliases:["="],"case-sensitive":!0},{name:"bcp47",aliases:["#bcp47"],"case-sensitive":!0},{name:"dir",aliases:["#dir"],"case-sensitive":!0},{name:"expectunusedtemplate",aliases:["__EXPECTUNUSEDTEMPLATE__"],"case-sensitive":!0},{name:"formal",aliases:["#FORMAL:"],"case-sensitive":!0},{name:"language_option_bcp47",aliases:["bcp47"],"case-sensitive":!0},{name:"userlanguage",aliases:["USERLANGUAGE"],"case-sensitive":!0}],userinfo:Ki},lo={pages:[{pageid:1,ns:0,title:"Example",contentmodel:"wikitext",pagelanguage:"zh",pagelanguagehtmlcode:"zh",pagelanguagedir:"ltr",touched:"2025-10-05T08:00:00Z",lastrevid:233,length:10296,protection:[],restrictiontypes:["edit","move"],fullurl:"http://localhost:8000/Example",editurl:"http://localhost:8000/index.php?title=Example&action=edit",canonicalurl:"http://localhost:8000/Example",varianttitles:{zh:"Example","zh-hans":"Example","zh-hant":"Example","zh-cn":"Example","zh-hk":"Example","zh-tw":"Example"},actions:{edit:!0,move:!0,delete:!1},templates:[{ns:10,title:"Template:Example"}],images:[{ns:6,title:"File:Example.jpg"}],revisions:[{revid:233,parentid:232,user:"机智的小鱼君",userid:316917,timestamp:"2025-10-05T08:00:00Z",contentformat:"text/x-wiki",contentmodel:"wikitext",content:`{{Example|你好，世界}}

[[File:Example.jpg|thumb]]

快来编辑这个条目吧！`}]}]},Re=()=>`${crypto.randomUUID()}+\\`,co={csrf:Re(),login:Re(),patrol:Re(),rollback:Re(),userrights:Re(),watch:Re()},ys=s=>s,Vi=new io;Vi.all("/api.php",async s=>{const e=s.req.query(),t=await s.req.parseBody(),i={...e,...t};switch(console.info("[mockFetch]",s.req.method,s.req.path,i),i.action){case"query":return fo(i);case"parse":return po();case"edit":return mo(i);default:return s.json(ys({error:{code:"not_implemented",info:"Not implemented"}}),404)}});const js={};let uo=1e3,ho=2e3;const fo=(s,e)=>{const t=ys({query:{}});return(s.meta?.includes("siteinfo")||s.meta?.includes("userinfo"))&&(t.query={...oo}),s.prop?.includes("info")&&(t.query={...lo}),s.prop?.includes("token")&&(t.query={tokens:co}),Response.json(t)},po=s=>Response.json(ys({error:{code:"unknown_error",info:"Unknown error"}})),mo=(s,e)=>{const{title:t,text:i,summary:a}=s;let n=js[t];n||(n={pageid:uo++,title:t,revisions:[]},js[t]=n);const r=ho++,o={revid:r,userid:Ki.id,content:i,summary:a||"",timestamp:new Date().toISOString()};return n.revisions.push(o),Response.json({edit:{result:"Success",pageid:n.pageid,title:n.title,newrevid:r,oldrevid:n.revisions.length>1?n.revisions[n.revisions.length-2].revid:0}})},go=async(s,e)=>{const t=new Request(s,e);return await Vi.fetch(t)};class yo{constructor(e={}){this.values=e}get(e){return e?this.values[e]:this.values}set(e,t){this.values[e]=t}exists(e){return e in this.values}}const vt=class vt{constructor(e){this.name=e,this._handlers=[],this._lastFiredContext=void 0}static create(e){if(this._hookHandlers.has(e))return this._hookHandlers.get(e);const t=new vt(e);return this._hookHandlers.set(e,t),t}add(...e){return console.info("hook:",this.name,"add",e),this._handlers.push(...e),this._lastFiredContext&&e.forEach(t=>t(...this._lastFiredContext)),this}deprecate(e){return console.info("hook:",this.name,"deprecate",e),this}fire(...e){return console.info("hook:",this.name,"fire",e),this._handlers.forEach(t=>t(...e)),this._lastFiredContext=e,this}remove(...e){console.info("hook:",this.name,"remove",e);for(const t of e)this._handlers=this._handlers.filter(i=>i!==t);return this}};vt._hookHandlers=new Map;let Xt=vt;const wo={wgBreakFrames:!0,wgSeparatorTransformTable:["",""],wgDigitTransformTable:["",""],wgDefaultDateFormat:"zh",wgMonthNames:["","1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],wgRequestId:"bd22385b2a95f9b27df2af4b",wgCanonicalNamespace:"",wgCanonicalSpecialPageName:!1,wgNamespaceNumber:0,wgPageName:"Example",wgTitle:"Example",wgCurRevisionId:23344,wgRevisionId:0,wgArticleId:4552,wgIsArticle:!1,wgIsRedirect:!1,wgAction:"history",wgUserName:"机智的小鱼君",wgUserGroups:["checkuser","interface-admin","staff","suppress","sysop","widgeteditor","*","user","autoconfirmed"],wgCategories:[],wgPageViewLanguage:"zh",wgPageContentLanguage:"zh",wgPageContentModel:"wikitext",wgRelevantPageName:"Example",wgRelevantArticleId:4552,wgUserId:316917,wgUserIsTemp:!1,wgUserEditCount:899,wgUserRegistration:149416648e4,wgUserFirstRegistration:149416648e4,wgUserVariant:"zh",wgIsProbablyEditable:!0,wgRelevantPageIsProbablyEditable:!0,wgRestrictionEdit:[],wgRestrictionMove:[],wgCiteReferencePreviewsActive:!0,wgMediaViewerOnClick:!0,wgMediaViewerEnabledByDefault:!0,wgPopupsFlags:0,wgVisualEditor:{pageLanguageCode:"zh",pageLanguageDir:"ltr",pageVariantFallbacks:["zh-hans","zh-hant","zh-cn","zh-tw","zh-hk","zh-sg","zh-mo","zh-my"]},"thanks-confirmation-required":!0,wgRelatedArticlesCompat:[],"ext.avatar.current_user.url":"https://storage.moegirl.org.cn/moegirl-dev/avatars/316917/latest.png","ext.avatar.current_user.thumb_url":"https://storage.moegirl.org.cn/moegirl-dev/avatars/316917/latest.png!avatar.thumb",wgCheckUserClientHintsHeadersJsApi:["architecture","bitness","brands","fullVersionList","mobile","model","platform","platformVersion"],wgCheckUserTemporaryAccountMaxAge:86400,wgMoeAuthConfig:{endpoint:"https://app.moegirl.org.cn/moe-auth/",specialHijackMap:{ChangeCredentials:["更改凭据","變更憑證","ChangeCredentials"],ChangePassword:["修改密码","修改密碼","修改密码","重置密码","找回密码","變更密碼","修改密碼","密碼重設","ChangePassword","ResetPass","ResetPassword"],CreateAccount:["创建账户","創建賬戶","建立帳戶","建立帳號","建立帐号","创建账户","建立帳號","建立帳戶","建立帳號","CreateAccount"],Userlogin:["用户登录","用戶登入","使用者登入","用户登录","登录","使用者登入","UserLogin","Login"]}},wgEditSubmitButtonLabelPublish:!1,wgEchoSeenTime:{alert:"1970-01-01T00:00:01Z",notice:"1970-01-01T00:00:01Z"},wgBackendResponseTime:550,wgPageParseReport:{limitreport:{cputime:"0.003",walltime:"0.003",ppvisitednodes:{value:9,limit:1e6},postexpandincludesize:{value:15,limit:2097152},templateargumentsize:{value:0,limit:2097152},expansiondepth:{value:2,limit:100},expensivefunctioncount:{value:0,limit:50},"unstrip-depth":{value:0,limit:20},"unstrip-size":{value:0,limit:5e6},timingprofile:["100.00%    0.000      1 -total"]},cachereport:{timestamp:"20251023070258",ttl:2592e3,transientcontent:!1}},debug:0,skin:"moeskin",stylepath:"/skins",wgArticlePath:"/$1",wgScriptPath:"",wgScript:"/index.php",wgSearchType:"CirrusSearch",wgVariantArticlePath:"/$2/$1",wgServer:"http://localhost:8000",wgServerName:"localhost",wgUserLanguage:"zh",wgContentLanguage:"zh",wgVersion:"1.43.3",wgFormattedNamespaces:{0:"",1:"Talk",2:"User",3:"User talk",4:"萌娘百科",5:"萌娘百科 talk",6:"File",7:"File talk",8:"MediaWiki",9:"MediaWiki talk",10:"Template",11:"Template talk",12:"Help",13:"Help talk",14:"Category",15:"Category talk",274:"Widget",275:"Widget talk",710:"TimedText",711:"TimedText talk",828:"Module",829:"Module talk","-2":"Media","-1":"Special"},wgNamespaceIds:{media:-2,special:-1,"":0,talk:1,user:2,user_talk:3,萌娘百科:4,萌娘百科_talk:5,file:6,file_talk:7,mediawiki:8,mediawiki_talk:9,template:10,template_talk:11,help:12,help_talk:13,category:14,category_talk:15,widget:274,widget_talk:275,timedtext:710,timedtext_talk:711,module:828,module_talk:829,模块:828,模组:828,模块对话:829,模块讨论:829,模组对话:829,模组讨论:829,微件:274,小部件:274,小组件:274,小元件:274,微件讨论:275,小部件讨论:275,小组件讨论:275,小元件讨论:275,媒体:-2,媒体文件:-2,媒体档案:-2,特殊:-1,讨论:1,对话:1,用户:2,用户讨论:3,用户对话:3,使用者讨论:3,使用者对话:3,专案:4,image:6,文件:6,档案:6,图像:6,图片:6,image_talk:7,文件讨论:7,文件对话:7,档案讨论:7,档案对话:7,图像讨论:7,图像对话:7,图片讨论:7,模板:10,样板:10,模板讨论:11,模板对话:11,样板讨论:11,样板对话:11,帮助:12,说明:12,使用说明:12,帮助讨论:13,帮助对话:13,说明讨论:13,使用说明讨论:13,分类:14,分类讨论:15,分类对话:15,模組:828,模塊:828,模組對話:829,模組討論:829,模塊對話:829,模塊討論:829,小組件:274,微件討論:275,小元件討論:275,小部件討論:275,小組件討論:275,媒體:-2,媒體檔案:-2,媒體文件:-2,討論:1,對話:1,使用者:2,用戶:2,使用者討論:3,使用者對話:3,用戶討論:3,用戶對話:3,專案:4,檔案:6,圖像:6,圖片:6,檔案討論:7,檔案對話:7,文件討論:7,文件對話:7,圖像討論:7,圖像對話:7,圖片討論:7,樣板:10,模板討論:11,模板對話:11,樣板討論:11,樣板對話:11,說明:12,幫助:12,使用說明:12,說明討論:13,幫助討論:13,幫助對話:13,使用說明討論:13,分類:14,分類討論:15,分類對話:15,萌娘百科讨论:5,萌娘百科对话:5,专案讨论:5,萌娘百科討論:5,萌娘百科對話:5,專案討論:5,mediawiki讨论:9,"timedtext talk":711,mediawiki討論:9,project:4,project_talk:5},wgContentNamespaces:[0],wgSiteName:"萌娘百科",wgDBname:"enmoegirl",wgWikiID:"enmoegirl",wgCaseSensitiveNamespaces:[],wgCommentCodePointLimit:500,wgExtensionAssetsPath:"/extensions",wgUrlProtocols:"bitcoin\\:|ftp\\:\\/\\/|ftps\\:\\/\\/|geo\\:|git\\:\\/\\/|gopher\\:\\/\\/|http\\:\\/\\/|https\\:\\/\\/|irc\\:\\/\\/|ircs\\:\\/\\/|magnet\\:|mailto\\:|matrix\\:|mms\\:\\/\\/|news\\:|nntp\\:\\/\\/|redis\\:\\/\\/|sftp\\:\\/\\/|sip\\:|sips\\:|sms\\:|ssh\\:\\/\\/|svn\\:\\/\\/|tel\\:|telnet\\:\\/\\/|urn\\:|worldwind\\:\\/\\/|xmpp\\:|\\/\\/",wgActionPaths:{},wgTranslateNumerals:!0,wgExtraSignatureNamespaces:[],wgLegalTitleChars:" %!\"$&'()*,\\-./0-9:;=?@A-Z\\\\\\^_`a-z~+\\u0080-\\uFFFF",wgIllegalFileChars:":/\\\\",wgCiteVisualEditorOtherGroup:!1,wgCiteResponsiveReferences:!0,wgCiteBookReferencing:!1,wgCodeMirrorLineNumberingNamespaces:null,wgMathEntitySelectorUrl:"https://www.wikidata.org/w/api.php",wgMediaViewer:!0,wgPopupsVirtualPageViews:!1,wgPopupsGateway:"mwApiPlain",wgPopupsRestGatewayEndpoint:"/api/rest_v1/page/summary/",wgPopupsStatsvSamplingRate:0,wgPopupsTextExtractsIntroOnly:!0,wgRelatedArticlesCardLimit:5,wgVisualEditorConfig:{usePageImages:!0,usePageDescriptions:!1,isBeta:!1,disableForAnons:!1,preloadModules:["site","user"],namespaces:[0,2,6,14],contentModels:{wikitext:"article"},pluginModules:["ext.abuseFilter.visualEditor","ext.cite.visualEditor","ext.CodeMirror.visualEditor.init","ext.disambiguator.visualEditor","ext.math.visualEditor","ext.spamBlacklist.visualEditor","ext.geshi.visualEditor","ext.templateDataGenerator.editPage","ext.TemplateSandbox.visualeditor","ext.titleblacklist.visualEditor"],thumbLimits:[120,150,180,200,250,300],galleryOptions:{imagesPerRow:0,imageWidth:120,imageHeight:120,captionLength:!0,showBytes:!0,showDimensions:!0,mode:"traditional"},tabPosition:"before",tabMessages:{editsource:"visualeditor-ca-editsource",createsource:"visualeditor-ca-createsource",editlocaldescriptionsource:"visualeditor-ca-editlocaldescriptionsource",createlocaldescriptionsource:"visualeditor-ca-createlocaldescriptionsource",editsection:"editsection",editsectionhint:"editsectionhint",editsectionsource:"visualeditor-ca-editsource-section",editsectionsourcehint:"visualeditor-ca-editsource-section-hint"},singleEditTab:!1,enableVisualSectionEditing:"mobile",showBetaWelcome:!0,allowExternalLinkPaste:!1,enableHelpCompletion:!0,enableTocWidget:!1,enableWikitext:!0,useChangeTagging:!0,editCheckTagging:!1,editCheck:!1,editCheckABTest:!1,editCheckReliabilityAvailable:!0,namespacesWithSubpages:[1,2,3,4,5,7,8,9,10,11,12,13,15,0,828,829,275],specialBooksources:"Special:网络书源",rebaserUrl:!1,feedbackApiUrl:!1,feedbackTitle:!1,sourceFeedbackTitle:!1,transclusionDialogNewSidebar:!0,cirrusSearchLookup:!0,defaultSortPrefix:"DEFAULTSORT"},wgCirrusSearchFeedbackLink:!1,wgPopupsConflictsWithNavPopupGadget:!1,wgCiteReferencePreviewsVisible:!0},bo=()=>new yo(wo),vo=()=>{window.mw=window.mw||{},window.mw.config=bo(),window.mw.hook=e=>Xt.create(e),window.mw.hook("InPageEdit.ready").add=(...e)=>{e.forEach(t=>{t(s)})};const s=new $e({autoloadStyles:!1,apiConfigs:{baseURL:ao.toString(),fetch:go}});return s.on("quick-edit/edit-notice",({editNotices:e})=>{const t=document.createElement("div");t.innerHTML="This is a simulated interface. Feel free to click the Save button -- it won't break anything.",t.style.cssText="background: #f0f0f0; border-radius: 0.5em; margin-bottom: 1em; color: #333; border-left: 6px solid #007bff; padding: 0.5em; padding-left: 1.5em; font-size: 14px;",e.unshift(t)}),s.start().then(()=>{s.logger("AUTOLOAD").info(`
    ____      ____                   ______    ___ __ 
   /  _/___  / __ \\____ _____ ____  / ____/___/ (_) /_
   / // __ \\/ /_/ / __ \`/ __ \`/ _ \\/ __/ / __  / / __/
 _/ // / / / ____/ /_/ / /_/ /  __/ /___/ /_/ / / /_  
/___/_/ /_/_/    \\__,_/\\__, /\\___/_____/\\__,_/_/\\__/  
                      /____/                v`+s.version)}),s},Po=Object.freeze(Object.defineProperty({__proto__:null,useMockInPageEdit:vo},Symbol.toStringTag,{value:"Module"}));export{W as A,Ft as Q,Ns as U,xo as V,ko as _,Ee as h,ve as l,Po as m,ya as q,Ei as y};
